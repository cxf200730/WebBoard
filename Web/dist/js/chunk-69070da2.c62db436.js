(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-69070da2"],{"16a8":function(e,t,s){"use strict";s("a717")},"6f91":function(e,t,s){"use strict";(function(e){var i=s("5530"),a=(s("99af"),s("2f62"));t["a"]={created:function(){},mounted:function(){this.getXb=document.getElementById("card").clientWidth,this.stageConfig.width=this.$refs.wrapper.$el.offsetWidth,this.$store.commit("initXb",this.getXb);window.addEventListener("touchmove",(function(){}),{passive:!1})},data:function(){return{linesIndex:0,lineIndex:0,stageConfig:{width:1300,height:450},painting:!1,stroke:"#000000",strokeWidth:1,getXb:1}},computed:Object(i["a"])(Object(i["a"])({},Object(a["c"])(["lines"])),Object(a["b"])(["isGameStarted","isGameHolder"])),methods:{mousedownHandler:function(e){if(this.isGameHolder&&this.isGameHolder){this.painting=!0;var t={stroke:this.stroke,strokeWidth:this.strokeWidth,points:[e.evt.layerX/this.getXb,e.evt.layerY]};this.$store.dispatch("sendDrawNewLine",t),this.$store.commit("drawNewLine",t)}},mousemoveHandler:function(e){if(this.painting){var t=this.lines[this.lines.length-1];t.points=t.points.concat([e.evt.layerX/this.getXb,e.evt.layerY]),console.log("11"+t.points[t.points.length-2]),this.$store.dispatch("sendUpdateNewLine",t),this.$store.commit("updateNewLine1",t)}},mouseupHandler:function(){this.painting=!1},touchstartHandler:function(t){if(this.isGameHolder&&this.isGameHolder){this.painting=!0;var s=t.evt.changedTouches[0].clientX-e("#card").offset().left,i=t.evt.changedTouches[0].clientY-e("#card").offset().top+e(document).scrollTop(),a={stroke:this.stroke,strokeWidth:this.strokeWidth,points:[s/this.getXb,i]};this.$store.dispatch("sendDrawNewLine",a),this.$store.commit("drawNewLine",a)}},touchmoveHandler:function(t){if(this.painting){this.nowX=document.getElementById("card").clientWidth;var s=this.lines[this.lines.length-1],i=t.evt.changedTouches[0].clientX-e("#card").offset().left,a=t.evt.changedTouches[0].clientY-e("#card").offset().top+e(document).scrollTop();s.points=s.points.concat([i/this.getXb,a]),this.$store.dispatch("sendUpdateNewLine",s),this.$store.commit("updateNewLine1",s)}},touchendHandler:function(){this.painting=!1}}}}).call(this,s("1157"))},"821a":function(e,t,s){"use strict";s("b997")},8544:function(e,t,s){"use strict";s("cfc9")},a717:function(e,t,s){},b997:function(e,t,s){},cb6e:function(e,t,s){},cfc9:function(e,t,s){},daca:function(e,t,s){"use strict";s.r(t);var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-container",[s("el-header",{attrs:{height:"30"}},[s("app-header")],1),s("el-container",[s("el-aside",{staticClass:"left-panel",attrs:{width:"230px"}},[s("app-side-panel"),s("div",[e._l(e.messages,(function(t,i){return s("div",{key:i},[e._v(" "+e._s(t)+" ")])})),s("el-input",{nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.sendMessage.apply(null,arguments)}},model:{value:e.message,callback:function(t){e.message=t},expression:"message"}}),s("el-button",{on:{click:e.sendMessage}},[e._v("发送")])],2)],1),s("el-main",[s("app-stage")],1)],1)],1)},a=[],n=s("5530"),o=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"app-header"},[e.connected?s("el-tag",{attrs:{type:"success"}},[e._v("服务已连接")]):s("el-tag",{attrs:{type:"danger"}},[e._v("服务未连接")]),e.isGameStarted?s("el-tag",{attrs:{type:"success"}},[e._v("上课中")]):s("el-tag",{attrs:{type:"info"}},[e._v("还未上课")])],1)},c=[],r=s("2f62"),l={computed:Object(n["a"])(Object(n["a"])({},Object(r["c"])(["connected"])),Object(r["b"])(["isGameStarted"]))},d=l,u=(s("8544"),s("2877")),h=Object(u["a"])(d,o,c,!1,null,"355547a3",null),p=h.exports,m=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-card",{ref:"wrapper",attrs:{"body-style":{padding:0},id:"card"}},[s("v-stage",{attrs:{id:"stage",config:e.stageConfig},on:{mousedown:e.mousedownHandler,mouseup:e.mouseupHandler,mousemove:e.mousemoveHandler,touchstart:e.touchstartHandler,touchmove:e.touchmoveHandler,touchend:e.touchendHandler}},[s("v-layer",e._l(e.lines,(function(e,t){return s("v-line",{key:t,attrs:{config:e}})})),1)],1)],1)],1)},g=[],f=s("6f91"),b=f["a"],v=(s("821a"),Object(u["a"])(b,m,g,!1,null,"3d266235",null)),w=v.exports,_=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-card",[s("div",{staticClass:"panel-area"},[s("ul",{staticClass:"participants"},e._l(e.teacherphones,(function(t){return s("li",{key:t},[s("span",[e._v(e._s(t)+" "+e._s(t===e.teacherphone?"（我）":""))]),t===e.holder?s("el-tag",{attrs:{size:"mini"}},[e._v("老师")]):e._e()],1)})),0)]),s("div",{staticClass:"panel-area button-area"},[e.isGameStarted?e._e():s("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-edit"},on:{click:e.startGameHandler}},[e._v("开始上课")]),e.isGameStarted&&e.teacherphone===e.holder?s("el-button",{attrs:{type:"warning",size:"small",icon:"el-icon-delete"},on:{click:e.stopGameHandler}},[e._v("结束上课")]):e._e(),e.isGameStarted&&e.teacherphone!==e.holder?s("el-button",{staticStyle:{"margin-top":"20px"},attrs:{type:"success",size:"small",icon:"el-icon-magic-stick"},on:{click:e.answerGameHandler}},[e._v("回答问题")]):e._e(),s("el-button",{staticStyle:{"margin-top":"5px","margin-left":"0"},attrs:{type:"danger",size:"small",icon:"el-icon-switch-button"},on:{click:e.exitHandler}},[e._v("退出课堂")])],1),s("el-dialog",{attrs:{title:"请设置答案",visible:e.resultDialogVisible,width:"30%"},on:{"update:visible":function(t){e.resultDialogVisible=t}}},[s("el-input",{attrs:{placeholder:"请输入您的答案"},model:{value:e.expectImageName,callback:function(t){e.expectImageName=t},expression:"expectImageName"}}),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.resultDialogVisible=!1}}},[e._v("取 消")]),s("el-button",{attrs:{type:"primary"},on:{click:e.saveDialogHandler}},[e._v("确 定")])],1)],1),s("el-dialog",{attrs:{title:"请填写答案",visible:e.answerDialogVisible,width:"30%"},on:{"update:visible":function(t){e.answerDialogVisible=t}}},[s("el-input",{attrs:{placeholder:"请输入您的答案"},model:{value:e.inputImageName,callback:function(t){e.inputImageName=t},expression:"inputImageName"}}),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.answerDialogVisible=!1}}},[e._v("取 消")]),s("el-button",{attrs:{type:"primary"},on:{click:e.saveAnswerDialogHandler}},[e._v("确 定")])],1)],1)],1)},k=[],y=(s("ac1f"),s("5319"),{data:function(){return{resultDialogVisible:!1,expectImageName:"",answerDialogVisible:!1,inputImageName:""}},computed:Object(n["a"])(Object(n["a"])({},Object(r["c"])(["teacherphone","teacherphones","holder"])),Object(r["b"])(["isGameStarted"])),methods:{startGameHandler:function(){this.resultDialogVisible=!0,this.expectImageName=""},stopGameHandler:function(){var e=this;this.$confirm("确定要终止游戏吗?","温馨提示").then((function(){e.$store.dispatch("sendStopGame")}))["catch"]((function(e){console.log(e)}))},answerGameHandler:function(){this.answerDialogVisible=!0,this.inputImageName=""},saveDialogHandler:function(){this.expectImageName?(this.$store.dispatch("sendStartGame",this.expectImageName),this.resultDialogVisible=!1):this.$message.error("答案不能为空哦!")},saveAnswerDialogHandler:function(){this.inputImageName?(this.$store.dispatch("sendAnswerGame",this.inputImageName),this.answerDialogVisible=!1):this.$message.error("答案不能为空")},exitHandler:function(){var e=this;this.$confirm("是否退出游戏","温馨提示").then((function(){e.$store.dispatch("sendUserLeave"),e.$router.replace("/login")}))["catch"]((function(e){console.log(e)}))}}}),H=y,$=(s("f295"),Object(u["a"])(H,_,k,!1,null,"004bccc6",null)),x=$.exports,G={components:{AppHeader:p,AppStage:w,AppSidePanel:x},created:function(){this.$store.dispatch("sendUserEnter")},computed:Object(n["a"])(Object(n["a"])({},Object(r["c"])(["teacherphone","messages","holder"])),Object(r["b"])(["isGameStarted"])),data:function(){return{message:""}},methods:{sendMessage:function(){var e=this;this.$store.dispatch("sendMessage",this.teacherphone+" : "+this.message).then((function(t){console.log(t),e.messages.push(t),e.message=""}))["catch"]((function(e){}))}}},N=G,O=(s("16a8"),Object(u["a"])(N,i,a,!1,null,"a96cc8d2",null));t["default"]=O.exports},f295:function(e,t,s){"use strict";s("cb6e")}}]);
//# sourceMappingURL=chunk-69070da2.c62db436.js.map