{"remainingRequest":"/Users/chengxiaofeng/Desktop/项目/手写板项目/web/node_modules/babel-loader/lib/index.js!/Users/chengxiaofeng/Desktop/项目/手写板项目/web/src/views/common.js","dependencies":[{"path":"/Users/chengxiaofeng/Desktop/项目/手写板项目/web/src/views/common.js","mtime":1628507676000},{"path":"/Users/chengxiaofeng/Desktop/项目/手写板项目/web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/chengxiaofeng/Desktop/项目/手写板项目/web/node_modules/babel-loader/lib/index.js","mtime":315532800000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIi9Vc2Vycy9jaGVuZ3hpYW9mZW5nL0Rlc2t0b3AvXHU5ODc5XHU3NkVFL1x1NjI0Qlx1NTE5OVx1Njc3Rlx1OTg3OVx1NzZFRS93ZWIvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2FzeW5jVG9HZW5lcmF0b3IiOwppbXBvcnQgInJlZ2VuZXJhdG9yLXJ1bnRpbWUvcnVudGltZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmRhdGUudG8tc3RyaW5nLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuaW5kZXgtb2YuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5yZWdleHAuZXhlYy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5tYXRjaC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmNvbmNhdC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LnNwbGljZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmZvci1lYWNoLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5mb3ItZWFjaC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5Lm1hcC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmpvaW4uanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5maW5kLWluZGV4LmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZnVuY3Rpb24ubmFtZS5qcyI7CgovKiBlc2xpbnQtZGlzYWJsZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdXNlLWJlZm9yZS1kZWZpbmUgKi8KaW1wb3J0IFZDb25zb2xlIGZyb20gJ3Zjb25zb2xlJzsKaW1wb3J0ICcuL2Fzc2V0cy9ib290c3RyYXAubWluJzsKaW1wb3J0ICcuL2Fzc2V0cy9ib290c3RyYXAubWluLmNzcyc7CmltcG9ydCB7IFplZ29FeHByZXNzRW5naW5lIH0gZnJvbSAnemVnby1leHByZXNzLWVuZ2luZS13ZWJydGMnOwppbXBvcnQgeyBnZXRDZ2kgfSBmcm9tICcuL2NvbnRlbnQnOwppbXBvcnQgeyBnZXRCcm93c2VyIH0gZnJvbSAnLi9hc3NldHMvdXRpbHMnOwpuZXcgVkNvbnNvbGUoKTsKdmFyIHVzZXJOYW1lID0gJ3NhbXBsZVVzZXInICsgbmV3IERhdGUoKS5nZXRUaW1lKCk7CnZhciB0b2tlblVybCA9ICdodHRwczovL3dzbGl2ZXJvb20tYWxwaGEuemVnby5pbTo4MjgyL3Rva2VuJzsKdmFyIHVzZXJJRCA9ICdzYW1wbGUnICsgbmV3IERhdGUoKS5nZXRUaW1lKCk7CnZhciBwdWJsaXNoU3RyZWFtSWQgPSAnd2VicnRjJyArIG5ldyBEYXRlKCkuZ2V0VGltZSgpOwp2YXIgemc7CnZhciBhcHBJRCA9IDE3MzkyNzI3MDY7IC8vIOivt+S7juWumOe9keaOp+WItuWPsOiOt+WPluWvueW6lOeahGFwcElECgp2YXIgc2VydmVyID0gJ3dzczovL3dlYmxpdmVyb29tLXRlc3QuemVnby5pbS93cyc7IC8vIOivt+S7juWumOe9keaOp+WItuWPsOiOt+WPluWvueW6lOeahHNlcnZlcuWcsOWdgO+8jOWQpuWImeWPr+iDveeZu+W9leWksei0pQoKdmFyIGNnaVRva2VuID0gJyc7IC8vY29uc3QgYXBwU2lnbiA9ICcnOwoKdmFyIHByZXZpZXdWaWRlbzsKdmFyIHVzZUxvY2FsU3RyZWFtTGlzdCA9IFtdOwp2YXIgaXNQcmV2aWV3ZWQgPSBmYWxzZTsKdmFyIHN1cHBvcnRTY3JlZW5TaGFyaW5nID0gZmFsc2U7CnZhciBsb2dpblJvb20gPSBmYWxzZTsKdmFyIGxvY2FsU3RyZWFtOwp2YXIgcHVibGlzaFR5cGU7CnZhciBsMzsKdmFyIHJvb21MaXN0ID0gW107IC8vIOa1i+ivleeUqOS7o+egge+8jOW8gOWPkeiAheivt+W/veeVpQovLyBUZXN0IGNvZGUsIGRldmVsb3BlcnMgcGxlYXNlIGlnbm9yZQoKdmFyIF9nZXRDZ2kgPSBnZXRDZ2koYXBwSUQsIHNlcnZlciwgY2dpVG9rZW4pOwoKYXBwSUQgPSBfZ2V0Q2dpLmFwcElEOwpzZXJ2ZXIgPSBfZ2V0Q2dpLnNlcnZlcjsKY2dpVG9rZW4gPSBfZ2V0Q2dpLmNnaVRva2VuOwp1c2VySUQgPSBfZ2V0Q2dpLnVzZXJJRDsKbDMgPSBfZ2V0Q2dpLmwzOwppZiAodXNlcklEID09ICIiKSB1c2VySUQgPSAnc2FtcGxlJyArIG5ldyBEYXRlKCkuZ2V0VGltZSgpOwoKaWYgKGNnaVRva2VuICYmIHRva2VuVXJsID09ICdodHRwczovL3dzbGl2ZXJvb20tYWxwaGEuemVnby5pbTo4MjgyL3Rva2VuJykgewogICQuZ2V0KGNnaVRva2VuLCBmdW5jdGlvbiAocnNwKSB7CiAgICBjZ2lUb2tlbiA9IHJzcC5kYXRhOwogICAgY29uc29sZS5sb2coY2dpVG9rZW4pOwogIH0pOwp9IC8vIOa1i+ivleeUqOS7o+eggSBlbmQKLy8gVGVzdCBjb2RlIGVuZAoKCnZhciBicm93c2VyID0gewogIHZlcnNpb25zOiBmdW5jdGlvbiAoKSB7CiAgICB2YXIgdSA9IG5hdmlnYXRvci51c2VyQWdlbnQsCiAgICAgICAgYXBwID0gbmF2aWdhdG9yLmFwcFZlcnNpb247CiAgICByZXR1cm4gewogICAgICB0cmlkZW50OiB1LmluZGV4T2YoJ1RyaWRlbnQnKSA+IC0xLAogICAgICAvL0lF5YaF5qC4CiAgICAgIHByZXN0bzogdS5pbmRleE9mKCdQcmVzdG8nKSA+IC0xLAogICAgICAvL29wZXJh5YaF5qC4CiAgICAgIHdlYktpdDogdS5pbmRleE9mKCdBcHBsZVdlYktpdCcpID4gLTEsCiAgICAgIC8v6Iu55p6c44CB6LC35q2M5YaF5qC4CiAgICAgIGdlY2tvOiB1LmluZGV4T2YoJ0dlY2tvJykgPiAtMSAmJiB1LmluZGV4T2YoJ0tIVE1MJykgPT0gLTEsCiAgICAgIC8v54Gr54uQ5YaF5qC4CiAgICAgIG1vYmlsZTogISF1Lm1hdGNoKC9BcHBsZVdlYktpdC4qTW9iaWxlLiovKSwKICAgICAgLy/mmK/lkKbkuLrnp7vliqjnu4jnq68KICAgICAgaW9zOiAhIXUubWF0Y2goL1woaVteO10rOyggVTspPyBDUFUuK01hYyBPUyBYLyksCiAgICAgIC8vaW9z57uI56uvCiAgICAgIGFuZHJvaWQ6IHUuaW5kZXhPZignQW5kcm9pZCcpID4gLTEgfHwgdS5pbmRleE9mKCdBZHInKSA+IC0xLAogICAgICAvL2FuZHJvaWTnu4jnq68KICAgICAgaVBob25lOiB1LmluZGV4T2YoJ2lQaG9uZScpID4gLTEsCiAgICAgIC8v5piv5ZCm5Li6aVBob25l5oiW6ICFUVFIROa1j+iniOWZqAogICAgICBpUGFkOiB1LmluZGV4T2YoJ2lQYWQnKSA+IC0xLAogICAgICAvL+aYr+WQpmlQYWQKICAgICAgd2ViQXBwOiB1LmluZGV4T2YoJ1NhZmFyaScpID09IC0xLAogICAgICAvL+aYr+WQpndlYuW6lOeUqOeoi+W6j++8jOayoeacieWktOmDqOS4juW6lemDqAogICAgICB3ZWl4aW46IHUuaW5kZXhPZignTWljcm9NZXNzZW5nZXInKSA+IC0xLAogICAgICAvL+aYr+WQpuW+ruS/oSDvvIgyMDE1LTAxLTIy5paw5aKe77yJCiAgICAgIHFxOiB1Lm1hdGNoKC9cc1FRL2kpID09ICIgcXEiIC8v5piv5ZCmUVEKCiAgICB9OwogIH0oKSwKICBsYW5ndWFnZTogKG5hdmlnYXRvci5icm93c2VyTGFuZ3VhZ2UgfHwgbmF2aWdhdG9yLmxhbmd1YWdlKS50b0xvd2VyQ2FzZSgpCn07IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBwcmVmZXItY29uc3QKCnpnID0gbmV3IFplZ29FeHByZXNzRW5naW5lKGFwcElELCBzZXJ2ZXIpOwp3aW5kb3cuemcgPSB6ZzsKd2luZG93LnVzZUxvY2FsU3RyZWFtTGlzdCA9IHVzZUxvY2FsU3RyZWFtTGlzdDsKCmZ1bmN0aW9uIGNoZWNrQW5SdW4oX3gpIHsKICByZXR1cm4gX2NoZWNrQW5SdW4uYXBwbHkodGhpcywgYXJndW1lbnRzKTsKfQoKZnVuY3Rpb24gX2NoZWNrQW5SdW4oKSB7CiAgX2NoZWNrQW5SdW4gPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU1KGNoZWNrU2NyZWVuKSB7CiAgICB2YXIgcmVzdWx0OwogICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU1JChfY29udGV4dDUpIHsKICAgICAgd2hpbGUgKDEpIHsKICAgICAgICBzd2l0Y2ggKF9jb250ZXh0NS5wcmV2ID0gX2NvbnRleHQ1Lm5leHQpIHsKICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgY29uc29sZS5sb2coJ3NkayB2ZXJzaW9uIGlzJywgemcuZ2V0VmVyc2lvbigpKTsKICAgICAgICAgICAgX2NvbnRleHQ1LnByZXYgPSAxOwogICAgICAgICAgICBfY29udGV4dDUubmV4dCA9IDQ7CiAgICAgICAgICAgIHJldHVybiB6Zy5jaGVja1N5c3RlbVJlcXVpcmVtZW50cygpOwoKICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgcmVzdWx0ID0gX2NvbnRleHQ1LnNlbnQ7CiAgICAgICAgICAgIGNvbnNvbGUud2FybignY2hlY2tTeXN0ZW1SZXF1aXJlbWVudHMgJywgcmVzdWx0KTsKICAgICAgICAgICAgIXJlc3VsdC52aWRlb0NvZGVjLkgyNjQgJiYgJCgnI3ZpZGVvQ29kZVR5cGUgb3B0aW9uOmVxKDEpJykuYXR0cignZGlzYWJsZWQnLCAnZGlzYWJsZWQnKTsKICAgICAgICAgICAgIXJlc3VsdC52aWRlb0NvZGVjLlZQOCAmJiAkKCcjdmlkZW9Db2RlVHlwZSBvcHRpb246ZXEoMiknKS5hdHRyKCdkaXNhYmxlZCcsICdkaXNhYmxlZCcpOwoKICAgICAgICAgICAgaWYgKHJlc3VsdC53ZWJSVEMpIHsKICAgICAgICAgICAgICBfY29udGV4dDUubmV4dCA9IDEzOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CgogICAgICAgICAgICBhbGVydCgnYnJvd3NlciBpcyBub3Qgc3VwcG9ydCB3ZWJydGMhIScpOwogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ1LmFicnVwdCgicmV0dXJuIiwgZmFsc2UpOwoKICAgICAgICAgIGNhc2UgMTM6CiAgICAgICAgICAgIGlmICghKCFyZXN1bHQudmlkZW9Db2RlYy5IMjY0ICYmICFyZXN1bHQudmlkZW9Db2RlYy5WUDgpKSB7CiAgICAgICAgICAgICAgX2NvbnRleHQ1Lm5leHQgPSAxODsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgYWxlcnQoJ2Jyb3dzZXIgaXMgbm90IHN1cHBvcnQgSDI2NCBhbmQgVlA4Jyk7CiAgICAgICAgICAgIHJldHVybiBfY29udGV4dDUuYWJydXB0KCJyZXR1cm4iLCBmYWxzZSk7CgogICAgICAgICAgY2FzZSAxODoKICAgICAgICAgICAgaWYgKHJlc3VsdC52aWRlb0NvZGVjLkgyNjQpIHsKICAgICAgICAgICAgICBzdXBwb3J0U2NyZWVuU2hhcmluZyA9IHJlc3VsdC5zY3JlZW5TaGFyaW5nOwogICAgICAgICAgICAgIGlmIChjaGVja1NjcmVlbiAmJiAhc3VwcG9ydFNjcmVlblNoYXJpbmcpIGFsZXJ0KCdicm93c2VyIGlzIG5vdCBzdXBwb3J0IHNjcmVlblNoYXJpbmcnKTsKICAgICAgICAgICAgICBwcmV2aWV3VmlkZW8gPSAkKCcjcHJldmlld1ZpZGVvJylbMF07CiAgICAgICAgICAgICAgc3RhcnQoKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBhbGVydCgn5LiN5pSv5oyBSDI2NO+8jOivt+WJjeW+gOa3t+a1gei9rOeggea1i+ivlScpOwogICAgICAgICAgICB9CgogICAgICAgICAgY2FzZSAxOToKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NS5hYnJ1cHQoInJldHVybiIsIHRydWUpOwoKICAgICAgICAgIGNhc2UgMjI6CiAgICAgICAgICAgIF9jb250ZXh0NS5wcmV2ID0gMjI7CiAgICAgICAgICAgIF9jb250ZXh0NS50MCA9IF9jb250ZXh0NVsiY2F0Y2giXSgxKTsKICAgICAgICAgICAgY29uc29sZS5lcnJvcignY2hlY2tTeXN0ZW1SZXF1aXJlbWVudHMnLCBfY29udGV4dDUudDApOwogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ1LmFicnVwdCgicmV0dXJuIiwgZmFsc2UpOwoKICAgICAgICAgIGNhc2UgMjY6CiAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ1LnN0b3AoKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sIF9jYWxsZWU1LCBudWxsLCBbWzEsIDIyXV0pOwogIH0pKTsKICByZXR1cm4gX2NoZWNrQW5SdW4uYXBwbHkodGhpcywgYXJndW1lbnRzKTsKfQoKZnVuY3Rpb24gc3RhcnQoKSB7CiAgcmV0dXJuIF9zdGFydC5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwp9CgpmdW5jdGlvbiBfc3RhcnQoKSB7CiAgX3N0YXJ0ID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlOCgpIHsKICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlOCQoX2NvbnRleHQ4KSB7CiAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgc3dpdGNoIChfY29udGV4dDgucHJldiA9IF9jb250ZXh0OC5uZXh0KSB7CiAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgIGluaXRTREsoKTsKICAgICAgICAgICAgemcuc2V0TG9nQ29uZmlnKHsKICAgICAgICAgICAgICBsb2dMZXZlbDogJ2RlYnVnJywKICAgICAgICAgICAgICByZW1vdGVMb2dMZXZlbDogJ2luZm8nLAogICAgICAgICAgICAgIGxvZ1VSTDogJycKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIHpnLnNldERlYnVnVmVyYm9zZShmYWxzZSk7CiAgICAgICAgICAgIHpnLnNldFNvdW5kTGV2ZWxEZWxlZ2F0ZSh0cnVlLCAzMDAwKTsKICAgICAgICAgICAgJCgnI2NyZWF0ZVJvb20nKS5jbGljayggLyojX19QVVJFX18qL19hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTYoKSB7CiAgICAgICAgICAgICAgdmFyIGxvZ2luU3VjOwogICAgICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlNiQoX2NvbnRleHQ2KSB7CiAgICAgICAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0Ni5wcmV2ID0gX2NvbnRleHQ2Lm5leHQpIHsKICAgICAgICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICAgICAgICBsb2dpblN1YyA9IGZhbHNlOwogICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQ2LnByZXYgPSAxOwogICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQ2Lm5leHQgPSA0OwogICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGVudGVyUm9vbSgpOwoKICAgICAgICAgICAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICAgICAgICAgICAgICBsb2dpblN1YyA9IF9jb250ZXh0Ni5zZW50OwogICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQ2LnQwID0gbG9naW5TdWM7CgogICAgICAgICAgICAgICAgICAgICAgaWYgKCFfY29udGV4dDYudDApIHsKICAgICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQ2Lm5leHQgPSA5OwogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDYubmV4dCA9IDk7CiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcHVibGlzaCgpOwoKICAgICAgICAgICAgICAgICAgICBjYXNlIDk6CiAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDYubmV4dCA9IDE0OwogICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgICAgICAgIGNhc2UgMTE6CiAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDYucHJldiA9IDExOwogICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQ2LnQxID0gX2NvbnRleHQ2WyJjYXRjaCJdKDEpOwogICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihfY29udGV4dDYudDEpOwoKICAgICAgICAgICAgICAgICAgICBjYXNlIDE0OgogICAgICAgICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ2LnN0b3AoKTsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0sIF9jYWxsZWU2LCBudWxsLCBbWzEsIDExXV0pOwogICAgICAgICAgICB9KSkpOwogICAgICAgICAgICAkKCcjb3BlblJvb20nKS5jbGljayggLyojX19QVVJFX18qL19hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTcoKSB7CiAgICAgICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU3JChfY29udGV4dDcpIHsKICAgICAgICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ3LnByZXYgPSBfY29udGV4dDcubmV4dCkgewogICAgICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0Ny5uZXh0ID0gMjsKICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBlbnRlclJvb20oKTsKCiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ3LnN0b3AoKTsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0sIF9jYWxsZWU3KTsKICAgICAgICAgICAgfSkpKTsKICAgICAgICAgICAgJCgnI2xlYXZlUm9vbScpLmNsaWNrKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICBsb2dvdXQoKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICQoJyNzdG9wUGxheVNvdW5kJykuY2xpY2soZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgIHpnLnNldFNvdW5kTGV2ZWxEZWxlZ2F0ZShmYWxzZSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICAkKCcjcmVzdW1lUGxheVNvdW5kJykuY2xpY2soZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgIHpnLnNldFNvdW5kTGV2ZWxEZWxlZ2F0ZShmYWxzZSk7CiAgICAgICAgICAgICAgemcuc2V0U291bmRMZXZlbERlbGVnYXRlKHRydWUpOwogICAgICAgICAgICB9KTsKCiAgICAgICAgICBjYXNlIDk6CiAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ4LnN0b3AoKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sIF9jYWxsZWU4KTsKICB9KSk7CiAgcmV0dXJuIF9zdGFydC5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwp9CgpmdW5jdGlvbiBlbnVtRGV2aWNlcygpIHsKICByZXR1cm4gX2VudW1EZXZpY2VzLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7Cn0KCmZ1bmN0aW9uIF9lbnVtRGV2aWNlcygpIHsKICBfZW51bURldmljZXMgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU5KCkgewogICAgdmFyIGF1ZGlvSW5wdXRMaXN0LCB2aWRlb0lucHV0TGlzdCwgZGV2aWNlSW5mbzsKICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlOSQoX2NvbnRleHQ5KSB7CiAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgc3dpdGNoIChfY29udGV4dDkucHJldiA9IF9jb250ZXh0OS5uZXh0KSB7CiAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgIGF1ZGlvSW5wdXRMaXN0ID0gW10sIHZpZGVvSW5wdXRMaXN0ID0gW107CiAgICAgICAgICAgIF9jb250ZXh0OS5uZXh0ID0gMzsKICAgICAgICAgICAgcmV0dXJuIHpnLmVudW1EZXZpY2VzKCk7CgogICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICBkZXZpY2VJbmZvID0gX2NvbnRleHQ5LnNlbnQ7CiAgICAgICAgICAgIGRldmljZUluZm8gJiYgZGV2aWNlSW5mby5taWNyb3Bob25lcy5tYXAoZnVuY3Rpb24gKGl0ZW0sIGluZGV4KSB7CiAgICAgICAgICAgICAgaWYgKCFpdGVtLmRldmljZU5hbWUpIHsKICAgICAgICAgICAgICAgIGl0ZW0uZGV2aWNlTmFtZSA9ICdtaWNyb3Bob25lJyArIGluZGV4OwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgYXVkaW9JbnB1dExpc3QucHVzaCgnIDxvcHRpb24gdmFsdWU9IicgKyBpdGVtLmRldmljZUlEICsgJyI+JyArIGl0ZW0uZGV2aWNlTmFtZSArICc8L29wdGlvbj4nKTsKICAgICAgICAgICAgICBjb25zb2xlLmxvZygnbWljcm9waG9uZTogJyArIGl0ZW0uZGV2aWNlTmFtZSk7CiAgICAgICAgICAgICAgcmV0dXJuIGl0ZW07CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBkZXZpY2VJbmZvICYmIGRldmljZUluZm8uY2FtZXJhcy5tYXAoZnVuY3Rpb24gKGl0ZW0sIGluZGV4KSB7CiAgICAgICAgICAgICAgaWYgKCFpdGVtLmRldmljZU5hbWUpIHsKICAgICAgICAgICAgICAgIGl0ZW0uZGV2aWNlTmFtZSA9ICdjYW1lcmEnICsgaW5kZXg7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICB2aWRlb0lucHV0TGlzdC5wdXNoKCcgPG9wdGlvbiB2YWx1ZT0iJyArIGl0ZW0uZGV2aWNlSUQgKyAnIj4nICsgaXRlbS5kZXZpY2VOYW1lICsgJzwvb3B0aW9uPicpOwogICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdjYW1lcmE6ICcgKyBpdGVtLmRldmljZU5hbWUpOwogICAgICAgICAgICAgIHJldHVybiBpdGVtOwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgYXVkaW9JbnB1dExpc3QucHVzaCgnPG9wdGlvbiB2YWx1ZT0iMCI+56aB5q2iPC9vcHRpb24+Jyk7CiAgICAgICAgICAgIHZpZGVvSW5wdXRMaXN0LnB1c2goJzxvcHRpb24gdmFsdWU9IjAiPuemgeatojwvb3B0aW9uPicpOwogICAgICAgICAgICAkKCcjYXVkaW9MaXN0JykuaHRtbChhdWRpb0lucHV0TGlzdC5qb2luKCcnKSk7CiAgICAgICAgICAgICQoJyN2aWRlb0xpc3QnKS5odG1sKHZpZGVvSW5wdXRMaXN0LmpvaW4oJycpKTsKCiAgICAgICAgICBjYXNlIDEwOgogICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0OS5zdG9wKCk7CiAgICAgICAgfQogICAgICB9CiAgICB9LCBfY2FsbGVlOSk7CiAgfSkpOwogIHJldHVybiBfZW51bURldmljZXMuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKfQoKZnVuY3Rpb24gaW5pdFNESygpIHsKICBlbnVtRGV2aWNlcygpOwogIHpnLm9uKCdyb29tU3RhdGVVcGRhdGUnLCBmdW5jdGlvbiAocm9vbUlELCBzdGF0ZSwgZXJyb3JDb2RlLCBleHRlbmRlZERhdGEpIHsKICAgIGNvbnNvbGUud2Fybigncm9vbVN0YXRlVXBkYXRlOiAnLCByb29tSUQsIHN0YXRlLCBlcnJvckNvZGUsIGV4dGVuZGVkRGF0YSk7CiAgfSk7CiAgemcub24oJ3Jvb21Vc2VyVXBkYXRlJywgZnVuY3Rpb24gKHJvb21JRCwgdXBkYXRlVHlwZSwgdXNlckxpc3QpIHsKICAgIGNvbnNvbGUud2Fybigicm9vbVVzZXJVcGRhdGU6IHJvb20gIi5jb25jYXQocm9vbUlELCAiLCB1c2VyICIpLmNvbmNhdCh1cGRhdGVUeXBlID09PSAnQUREJyA/ICdhZGRlZCcgOiAnbGVmdCcsICIgIiksIEpTT04uc3RyaW5naWZ5KHVzZXJMaXN0KSk7CiAgfSk7CiAgemcub24oJ3B1Ymxpc2hlclN0YXRlVXBkYXRlJywgZnVuY3Rpb24gKHJlc3VsdCkgewogICAgY29uc29sZS5sb2coJ3B1Ymxpc2hlclN0YXRlVXBkYXRlOiAnLCByZXN1bHQuc3RyZWFtSUQsIHJlc3VsdC5zdGF0ZSk7CgogICAgaWYgKHJlc3VsdC5zdGF0ZSA9PSAnUFVCTElTSElORycpIHsKICAgICAgY29uc29sZS5pbmZvKCcgcHVibGlzaCAgc3VjY2VzcyAnICsgcmVzdWx0LnN0cmVhbUlEKTsKICAgIH0gZWxzZSBpZiAocmVzdWx0LnN0YXRlID09ICdQVUJMSVNIX1JFUVVFU1RJTkcnKSB7CiAgICAgIGNvbnNvbGUuaW5mbygnIHB1Ymxpc2ggIHJldHJ5Jyk7CiAgICB9IGVsc2UgewogICAgICBpZiAocmVzdWx0LmVycm9yQ29kZSA9PSAwKSB7CiAgICAgICAgY29uc29sZS53YXJuKCdwdWJsaXNoIHN0b3AgJyArIHJlc3VsdC5lcnJvckNvZGUpOwogICAgICB9IGVsc2UgewogICAgICAgIGNvbnNvbGUuZXJyb3IoJ3B1Ymxpc2ggZXJyb3IgJyArIHJlc3VsdC5lcnJvckNvZGUpOwogICAgICB9IC8vIGNvbnN0IF9tc2cgPSBzdGF0ZUluZm8uZXJyb3IubXNnOwogICAgICAvLyBpZiAoc3RhdGVJbmZvLmVycm9yLm1zZy5pbmRleE9mICgnc2VydmVyIHNlc3Npb24gY2xvc2VkLCByZWFzb246ICcpID4gLTEpIHsKICAgICAgLy8gICAgICAgICBjb25zdCBjb2RlID0gc3RhdGVJbmZvLmVycm9yLm1zZy5yZXBsYWNlICgnc2VydmVyIHNlc3Npb24gY2xvc2VkLCByZWFzb246ICcsICcnKTsKICAgICAgLy8gICAgICAgICBpZiAoY29kZSA9PT0gJzIxJykgewogICAgICAvLyAgICAgICAgICAgICAgICAgX21zZyA9ICfpn7PpopHnvJbop6PnoIHkuI3mlK/mjIEob3B1cyknOwogICAgICAvLyAgICAgICAgIH0gZWxzZSBpZiAoY29kZSA9PT0gJzIyJykgewogICAgICAvLyAgICAgICAgICAgICAgICAgX21zZyA9ICfop4bpopHnvJbop6PnoIHkuI3mlK/mjIEoSDI2NCknCiAgICAgIC8vICAgICAgICAgfSBlbHNlIGlmIChjb2RlID09PSAnMjAnKSB7CiAgICAgIC8vICAgICAgICAgICAgICAgICBfbXNnID0gJ3NkcCDop6Pph4rplJnor68nOwogICAgICAvLyAgICAgICAgIH0KICAgICAgLy8gfQogICAgICAvLyBhbGVydCgn5o6o5rWB5aSx6LSlLHJlYXNvbiA9ICcgKyBfbXNnKTsKCiAgICB9CiAgfSk7CiAgemcub24oJ3BsYXllclN0YXRlVXBkYXRlJywgZnVuY3Rpb24gKHJlc3VsdCkgewogICAgY29uc29sZS5sb2coJ3BsYXllclN0YXRlVXBkYXRlJywgcmVzdWx0LnN0cmVhbUlELCByZXN1bHQuc3RhdGUpOwoKICAgIGlmIChyZXN1bHQuc3RhdGUgPT0gJ1BMQVlJTkcnKSB7CiAgICAgIGNvbnNvbGUuaW5mbygnIHBsYXkgIHN1Y2Nlc3MgJyArIHJlc3VsdC5zdHJlYW1JRCk7CgogICAgICB2YXIgX2Jyb3dzZXIgPSBnZXRCcm93c2VyKCk7CgogICAgICBjb25zb2xlLndhcm4oJ2Jyb3dzZXInLCBfYnJvd3Nlcik7CgogICAgICBpZiAoX2Jyb3dzZXIgPT09ICdTYWZhcmknKSB7CiAgICAgICAgdmFyIHZpZGVvcyA9ICQoJy5yZW1vdGVWaWRlbyB2aWRlbycpOwoKICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHZpZGVvcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgdmlkZW9zW2ldLnNyY09iamVjdCA9IHZpZGVvc1tpXS5zcmNPYmplY3Q7CiAgICAgICAgfQogICAgICB9CiAgICB9IGVsc2UgaWYgKHJlc3VsdC5zdGF0ZSA9PSAnUExBWV9SRVFVRVNUSU5HJykgewogICAgICBjb25zb2xlLmluZm8oJyBwbGF5ICByZXRyeScpOwogICAgfSBlbHNlIHsKICAgICAgaWYgKHJlc3VsdC5lcnJvckNvZGUgPT0gMCkgewogICAgICAgIGNvbnNvbGUud2FybigncGxheSBzdG9wICcgKyByZXN1bHQuZXJyb3JDb2RlKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBjb25zb2xlLmVycm9yKCdwbGF5IGVycm9yICcgKyByZXN1bHQuZXJyb3JDb2RlKTsKICAgICAgfSAvLyBjb25zdCBfbXNnID0gc3RhdGVJbmZvLmVycm9yLm1zZzsKICAgICAgLy8gaWYgKHN0YXRlSW5mby5lcnJvci5tc2cuaW5kZXhPZiAoJ3NlcnZlciBzZXNzaW9uIGNsb3NlZCwgcmVhc29uOiAnKSA+IC0xKSB7CiAgICAgIC8vICAgICAgICAgY29uc3QgY29kZSA9IHN0YXRlSW5mby5lcnJvci5tc2cucmVwbGFjZSAoJ3NlcnZlciBzZXNzaW9uIGNsb3NlZCwgcmVhc29uOiAnLCAnJyk7CiAgICAgIC8vICAgICAgICAgaWYgKGNvZGUgPT09ICcyMScpIHsKICAgICAgLy8gICAgICAgICAgICAgICAgIF9tc2cgPSAn6Z+z6aKR57yW6Kej56CB5LiN5pSv5oyBKG9wdXMpJzsKICAgICAgLy8gICAgICAgICB9IGVsc2UgaWYgKGNvZGUgPT09ICcyMicpIHsKICAgICAgLy8gICAgICAgICAgICAgICAgIF9tc2cgPSAn6KeG6aKR57yW6Kej56CB5LiN5pSv5oyBKEgyNjQpJwogICAgICAvLyAgICAgICAgIH0gZWxzZSBpZiAoY29kZSA9PT0gJzIwJykgewogICAgICAvLyAgICAgICAgICAgICAgICAgX21zZyA9ICdzZHAg6Kej6YeK6ZSZ6K+vJzsKICAgICAgLy8gICAgICAgICB9CiAgICAgIC8vIH0KICAgICAgLy8gYWxlcnQoJ+aLiea1geWksei0pSxyZWFzb24gPSAnICsgX21zZyk7CgogICAgfQogIH0pOwogIHpnLm9uKCdzdHJlYW1FeHRyYUluZm9VcGRhdGUnLCBmdW5jdGlvbiAocm9vbUlELCBzdHJlYW1MaXN0KSB7CiAgICBjb25zb2xlLndhcm4oInN0cmVhbUV4dHJhSW5mb1VwZGF0ZTogcm9vbSAiLmNvbmNhdChyb29tSUQsICIsICAiKSwgSlNPTi5zdHJpbmdpZnkoc3RyZWFtTGlzdCkpOwogIH0pOwogIHpnLm9uKCdyb29tU3RyZWFtVXBkYXRlJywgLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHsKICAgIHZhciBfcmVmID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlKHJvb21JRCwgdXBkYXRlVHlwZSwgc3RyZWFtTGlzdCwgZXh0ZW5kZWREYXRhKSB7CiAgICAgIHZhciBfbG9vcCwgaSwgaywgajsKCiAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkgewogICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBjb25zb2xlLndhcm4oJ3Jvb21TdHJlYW1VcGRhdGUgMSByb29tSUQgJywgcm9vbUlELCBzdHJlYW1MaXN0LCBleHRlbmRlZERhdGEpOyAvLyBsZXQgcXVldWUgPSBbXQoKICAgICAgICAgICAgICBpZiAoISh1cGRhdGVUeXBlID09ICdBREQnKSkgewogICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDY7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIF9sb29wID0gZnVuY3Rpb24gX2xvb3AoaSkgewogICAgICAgICAgICAgICAgY29uc29sZS5pbmZvKHN0cmVhbUxpc3RbaV0uc3RyZWFtSUQgKyAnIHdhcyBhZGRlZCcpOwogICAgICAgICAgICAgICAgdmFyIHJlbW90ZVN0cmVhbSA9IHZvaWQgMDsKICAgICAgICAgICAgICAgIHZhciBwbGF5T3B0aW9uID0ge307CiAgICAgICAgICAgICAgICBpZiAoJCgiI3ZpZGVvQ29kZWMiKS52YWwoKSkgcGxheU9wdGlvbi52aWRlb0NvZGVjID0gJCgiI3ZpZGVvQ29kZWMiKS52YWwoKTsKICAgICAgICAgICAgICAgIGlmIChsMyA9PSB0cnVlKSBwbGF5T3B0aW9uLnJlc291cmNlTW9kZSA9IDI7CiAgICAgICAgICAgICAgICB6Zy5zdGFydFBsYXlpbmdTdHJlYW0oc3RyZWFtTGlzdFtpXS5zdHJlYW1JRCwgcGxheU9wdGlvbikudGhlbihmdW5jdGlvbiAoc3RyZWFtKSB7CiAgICAgICAgICAgICAgICAgIHJlbW90ZVN0cmVhbSA9IHN0cmVhbTsKICAgICAgICAgICAgICAgICAgdXNlTG9jYWxTdHJlYW1MaXN0LnB1c2goc3RyZWFtTGlzdFtpXSk7CiAgICAgICAgICAgICAgICAgIHZhciB2aWRlb1RlbXAgPSAkKCI8dmlkZW8gaWQ9Ii5jb25jYXQoc3RyZWFtTGlzdFtpXS5zdHJlYW1JRCwgIiBhdXRvcGxheSBtdXRlZCBwbGF5c2lubGluZSBjb250cm9scz48L3ZpZGVvPiIpKTsgLy9xdWV1ZS5wdXNoKHZpZGVvVGVtcCkKCiAgICAgICAgICAgICAgICAgICQoJy5yZW1vdGVWaWRlbycpLmFwcGVuZCh2aWRlb1RlbXApOwogICAgICAgICAgICAgICAgICB2YXIgdmlkZW8gPSAkKCcucmVtb3RlVmlkZW8gdmlkZW86bGFzdCcpWzBdOwogICAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oJ3ZpZGVvJywgdmlkZW8sIHJlbW90ZVN0cmVhbSk7CiAgICAgICAgICAgICAgICAgIHZpZGVvLnNyY09iamVjdCA9IHJlbW90ZVN0cmVhbTsKICAgICAgICAgICAgICAgICAgdmlkZW8ubXV0ZWQgPSBmYWxzZTsgLy8gdmlkZW9UZW1wID0gbnVsbDsKICAgICAgICAgICAgICAgIH0pWyJjYXRjaCJdKGZ1bmN0aW9uIChlcnIpIHsKICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignZXJyJywgZXJyKTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIH07CgogICAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBzdHJlYW1MaXN0Lmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAgICBfbG9vcChpKTsKICAgICAgICAgICAgICB9IC8vIGNvbnN0IGluSXBob25lID0gYnJvd3Nlci52ZXJzaW9ucy5tb2JpbGUgJiYgYnJvd3Nlci52ZXJzaW9ucy5pb3MKICAgICAgICAgICAgICAvLyBjb25zdCBpblNhZmFyaSA9IGJyb3dzZXIudmVyc2lvbnMud2ViQXBwCiAgICAgICAgICAgICAgLy8gY29uc3QgaW5XeCA9IGJyb3dzZXIudmVyc2lvbnMud2VpeGluCiAgICAgICAgICAgICAgLy8gaWYoc3RyZWFtTGlzdC5sZW5ndGggPiAxICYmIChpbklwaG9uZSB8fCBpblNhZmFyaSB8fCBpbld4KSkgewogICAgICAgICAgICAgIC8vICAgICBjb25zdCBhYyA9IHpjLnplZ29XZWJSVEMuYWM7CiAgICAgICAgICAgICAgLy8gICAgIGFjLnJlc3VtZSgpOwogICAgICAgICAgICAgIC8vICAgICBjb25zdCBnYWluID0gYWMuY3JlYXRlR2FpbigpOwogICAgICAgICAgICAgIC8vICAgICB3aGlsZShxdWV1ZS5sZW5ndGgpIHsKICAgICAgICAgICAgICAvLyAgICAgICAgIGxldCB0ZW1wID0gcXVldWUuc2hpZnQoKQogICAgICAgICAgICAgIC8vICAgICAgICAgaWYodGVtcC5zcmNPYmplY3QpIHsKICAgICAgICAgICAgICAvLyAgICAgICAgICAgICBxdWV1ZS5wdXNoKGFjLmNyZWF0ZU1lZGlhU3RyZWFtU291cmNlKHRlbXAuc3JjT2JqZWN0KSkKICAgICAgICAgICAgICAvLyAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgdGVtcC5jb25uZWN0KGdhaW4pCiAgICAgICAgICAgICAgLy8gICAgICAgICB9CiAgICAgICAgICAgICAgLy8gICAgIH0KICAgICAgICAgICAgICAvLyAgICAgZ2Fpbi5jb25uZWN0KGFjLmRlc3RpbmF0aW9uKTsKICAgICAgICAgICAgICAvLyB9CgoKICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMjM7CiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlIDY6CiAgICAgICAgICAgICAgaWYgKCEodXBkYXRlVHlwZSA9PSAnREVMRVRFJykpIHsKICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAyMzsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgayA9IDA7CgogICAgICAgICAgICBjYXNlIDg6CiAgICAgICAgICAgICAgaWYgKCEoayA8IHVzZUxvY2FsU3RyZWFtTGlzdC5sZW5ndGgpKSB7CiAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMjM7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGogPSAwOwoKICAgICAgICAgICAgY2FzZSAxMDoKICAgICAgICAgICAgICBpZiAoIShqIDwgc3RyZWFtTGlzdC5sZW5ndGgpKSB7CiAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMjA7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGlmICghKHVzZUxvY2FsU3RyZWFtTGlzdFtrXS5zdHJlYW1JRCA9PT0gc3RyZWFtTGlzdFtqXS5zdHJlYW1JRCkpIHsKICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAxNzsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIHpnLnN0b3BQbGF5aW5nU3RyZWFtKHVzZUxvY2FsU3RyZWFtTGlzdFtrXS5zdHJlYW1JRCk7CiAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgY29uc29sZS5pbmZvKHVzZUxvY2FsU3RyZWFtTGlzdFtrXS5zdHJlYW1JRCArICd3YXMgZGV2YXJlZCcpOwogICAgICAgICAgICAgICQoJy5yZW1vdGVWaWRlbyB2aWRlbzplcSgnICsgayArICcpJykucmVtb3ZlKCk7CiAgICAgICAgICAgICAgdXNlTG9jYWxTdHJlYW1MaXN0LnNwbGljZShrLS0sIDEpOwogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5hYnJ1cHQoImJyZWFrIiwgMjApOwoKICAgICAgICAgICAgY2FzZSAxNzoKICAgICAgICAgICAgICBqKys7CiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDEwOwogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSAyMDoKICAgICAgICAgICAgICBrKys7CiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDg7CiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlIDIzOgogICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LCBfY2FsbGVlKTsKICAgIH0pKTsKCiAgICByZXR1cm4gZnVuY3Rpb24gKF94MiwgX3gzLCBfeDQsIF94NSkgewogICAgICByZXR1cm4gX3JlZi5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgfTsKICB9KCkpOwogIHpnLm9uKCdwbGF5UXVhbGl0eVVwZGF0ZScsIC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgICB2YXIgX3JlZjIgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUyKHN0cmVhbUlELCBzdHJlYW1RdWFsaXR5KSB7CiAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMiQoX2NvbnRleHQyKSB7CiAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQyLnByZXYgPSBfY29udGV4dDIubmV4dCkgewogICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgY29uc29sZS5sb2coInBsYXkjIi5jb25jYXQoc3RyZWFtSUQsICIgdmlkZW9GUFM6ICIpLmNvbmNhdChzdHJlYW1RdWFsaXR5LnZpZGVvLnZpZGVvRlBTLCAiIHZpZGVvQml0cmF0ZTogIikuY29uY2F0KHN0cmVhbVF1YWxpdHkudmlkZW8udmlkZW9CaXRyYXRlLCAiIGF1ZGlvQml0cmF0ZTogIikuY29uY2F0KHN0cmVhbVF1YWxpdHkuYXVkaW8uYXVkaW9CaXRyYXRlLCAiIGF1ZGlvRlBTOiAiKS5jb25jYXQoc3RyZWFtUXVhbGl0eS5hdWRpby5hdWRpb0ZQUykpOwogICAgICAgICAgICAgIGNvbnNvbGUubG9nKCJwbGF5IyIuY29uY2F0KHN0cmVhbUlEKSwgc3RyZWFtUXVhbGl0eSk7CgogICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5zdG9wKCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LCBfY2FsbGVlMik7CiAgICB9KSk7CgogICAgcmV0dXJuIGZ1bmN0aW9uIChfeDYsIF94NykgewogICAgICByZXR1cm4gX3JlZjIuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgIH07CiAgfSgpKTsKICB6Zy5vbigncHVibGlzaFF1YWxpdHlVcGRhdGUnLCAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkgewogICAgdmFyIF9yZWYzID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMyhzdHJlYW1JRCwgc3RyZWFtUXVhbGl0eSkgewogICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTMkKF9jb250ZXh0MykgewogICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0My5wcmV2ID0gX2NvbnRleHQzLm5leHQpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIGNvbnNvbGUubG9nKCJwdWJsaXNoIyIuY29uY2F0KHN0cmVhbUlELCAiIHZpZGVvRlBTOiAiKS5jb25jYXQoc3RyZWFtUXVhbGl0eS52aWRlby52aWRlb0ZQUywgIiB2aWRlb0JpdHJhdGU6ICIpLmNvbmNhdChzdHJlYW1RdWFsaXR5LnZpZGVvLnZpZGVvQml0cmF0ZSwgIiBhdWRpb0JpdHJhdGU6ICIpLmNvbmNhdChzdHJlYW1RdWFsaXR5LmF1ZGlvLmF1ZGlvQml0cmF0ZSwgIiBhdWRpb0ZQUzogIikuY29uY2F0KHN0cmVhbVF1YWxpdHkuYXVkaW8uYXVkaW9GUFMpKTsKICAgICAgICAgICAgICBjb25zb2xlLmxvZygicHVibGlzaCMiLmNvbmNhdChzdHJlYW1JRCksIHN0cmVhbVF1YWxpdHkpOwoKICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDMuc3RvcCgpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwgX2NhbGxlZTMpOwogICAgfSkpOwoKICAgIHJldHVybiBmdW5jdGlvbiAoX3g4LCBfeDkpIHsKICAgICAgcmV0dXJuIF9yZWYzLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICB9OwogIH0oKSk7CiAgemcub24oJ3JlbW90ZUNhbWVyYVN0YXR1c1VwZGF0ZScsIGZ1bmN0aW9uIChzdHJlYW1JRCwgc3RhdHVzKSB7CiAgICBjb25zb2xlLndhcm4oInJlbW90ZUNhbWVyYVN0YXR1c1VwZGF0ZSAiLmNvbmNhdChzdHJlYW1JRCwgIiBjYW1lcmEgc3RhdHVzICIpLmNvbmNhdChzdGF0dXMgPT0gJ09QRU4nID8gJ29wZW4nIDogJ2Nsb3NlJykpOwogIH0pOwogIHpnLm9uKCdyZW1vdGVNaWNTdGF0dXNVcGRhdGUnLCBmdW5jdGlvbiAoc3RyZWFtSUQsIHN0YXR1cykgewogICAgY29uc29sZS53YXJuKCJyZW1vdGVNaWNTdGF0dXNVcGRhdGUgIi5jb25jYXQoc3RyZWFtSUQsICIgbWljcm8gc3RhdHVzICIpLmNvbmNhdChzdGF0dXMgPT0gJ09QRU4nID8gJ29wZW4nIDogJ2Nsb3NlJykpOwogIH0pOwogIHpnLm9uKCdzb3VuZExldmVsVXBkYXRlJywgZnVuY3Rpb24gKHN0cmVhbUxpc3QpIHsKICAgIHN0cmVhbUxpc3QuZm9yRWFjaChmdW5jdGlvbiAoc3RyZWFtKSB7CiAgICAgIHN0cmVhbS50eXBlID09ICdwdXNoJyAmJiAkKCcjc291bmRMZXZlbCcpLmh0bWwoTWF0aC5yb3VuZChzdHJlYW0uc291bmRMZXZlbCkgKyAnJyk7CiAgICAgIGNvbnNvbGUud2FybigiIi5jb25jYXQoc3RyZWFtLnR5cGUsICIgIikuY29uY2F0KHN0cmVhbS5zdHJlYW1JRCwgIiwgc291bmRMZXZlbDogIikuY29uY2F0KHN0cmVhbS5zb3VuZExldmVsKSk7CiAgICB9KTsKICB9KTsKICB6Zy5vbignZGV2aWNlRXJyb3InLCBmdW5jdGlvbiAoZXJyb3JDb2RlLCBkZXZpY2VOYW1lKSB7CiAgICBjb25zb2xlLndhcm4oImRldmljZUVycm9yIiwgZXJyb3JDb2RlLCBkZXZpY2VOYW1lKTsKICB9KTsKICB6Zy5vbigndmlkZW9EZXZpY2VTdGF0ZUNoYW5nZWQnLCBmdW5jdGlvbiAodXBkYXRlVHlwZSwgZGV2aWNlKSB7CiAgICBjb25zb2xlLndhcm4oInZpZGVvRGV2aWNlU3RhdGVDaGFuZ2VkIiwgZGV2aWNlLCB1cGRhdGVUeXBlKTsKICB9KTsKICB6Zy5vbignYXVkaW9EZXZpY2VTdGF0ZUNoYW5nZWQnLCBmdW5jdGlvbiAodXBkYXRlVHlwZSwgZGV2aWNlVHlwZSwgZGV2aWNlKSB7CiAgICBjb25zb2xlLndhcm4oImF1ZGlvRGV2aWNlU3RhdGVDaGFuZ2VkIiwgZGV2aWNlLCB1cGRhdGVUeXBlLCBkZXZpY2VUeXBlKTsKICB9KTsKICB6Zy5vbigncm9vbU9ubGluZVVzZXJDb3VudFVwZGF0ZScsIGZ1bmN0aW9uIChyb29tSUQsIGNvdW50KSB7CiAgICBjb25zb2xlLndhcm4oInJvb21PbmxpbmVVc2VyQ291bnRVcGRhdGUgIi5jb25jYXQocm9vbUlELCAiICIpLmNvbmNhdChjb3VudCkpOwogIH0pOwp9CgpmdW5jdGlvbiBsb2dpbihfeDEwKSB7CiAgcmV0dXJuIF9sb2dpbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwp9CgpmdW5jdGlvbiBfbG9naW4oKSB7CiAgX2xvZ2luID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMTAocm9vbUlkKSB7CiAgICB2YXIgdG9rZW47CiAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTEwJChfY29udGV4dDEwKSB7CiAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgc3dpdGNoIChfY29udGV4dDEwLnByZXYgPSBfY29udGV4dDEwLm5leHQpIHsKICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgLy8g6I635Y+WdG9rZW7pnIDopoHlrqLmiLfoh6rlt7Hlrp7njrDvvIx0b2tlbuaYr+WvueeZu+W9leaIv+mXtOeahOWUr+S4gOmqjOivgQogICAgICAgICAgICAvLyBPYnRhaW5pbmcgYSB0b2tlbiBuZWVkcyB0byBiZSBpbXBsZW1lbnRlZCBieSB0aGUgY3VzdG9tZXIuIFRoZSB0b2tlbiBpcyB0aGUgb25seSB2ZXJpZmljYXRpb24gZm9yIHRoZSBsb2dpbiByb29tLgogICAgICAgICAgICB0b2tlbiA9ICcnOyAvL+a1i+ivleeUqO+8jOW8gOWPkeiAheivt+W/veeVpQogICAgICAgICAgICAvL1Rlc3QgY29kZSwgZGV2ZWxvcGVycyBwbGVhc2UgaWdub3JlCgogICAgICAgICAgICBpZiAoIWNnaVRva2VuKSB7CiAgICAgICAgICAgICAgX2NvbnRleHQxMC5uZXh0ID0gNzsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgX2NvbnRleHQxMC5uZXh0ID0gNDsKICAgICAgICAgICAgcmV0dXJuICQuZ2V0KHRva2VuVXJsLCB7CiAgICAgICAgICAgICAgYXBwX2lkOiBhcHBJRCwKICAgICAgICAgICAgICBpZF9uYW1lOiB1c2VySUQsCiAgICAgICAgICAgICAgY2dpX3Rva2VuOiBjZ2lUb2tlbgogICAgICAgICAgICB9KTsKCiAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICAgIHRva2VuID0gX2NvbnRleHQxMC5zZW50OwogICAgICAgICAgICBfY29udGV4dDEwLm5leHQgPSAxMDsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSA3OgogICAgICAgICAgICBfY29udGV4dDEwLm5leHQgPSA5OwogICAgICAgICAgICByZXR1cm4gJC5nZXQoJ2h0dHBzOi8vd3NsaXZlcm9vbS1hbHBoYS56ZWdvLmltOjgyODIvdG9rZW4nLCB7CiAgICAgICAgICAgICAgYXBwX2lkOiBhcHBJRCwKICAgICAgICAgICAgICBpZF9uYW1lOiB1c2VySUQKICAgICAgICAgICAgfSk7CgogICAgICAgICAgY2FzZSA5OgogICAgICAgICAgICB0b2tlbiA9IF9jb250ZXh0MTAuc2VudDsKCiAgICAgICAgICBjYXNlIDEwOgogICAgICAgICAgICBfY29udGV4dDEwLm5leHQgPSAxMjsKICAgICAgICAgICAgcmV0dXJuIHpnLmxvZ2luUm9vbShyb29tSWQsIHRva2VuLCB7CiAgICAgICAgICAgICAgdXNlcklEOiB1c2VySUQsCiAgICAgICAgICAgICAgdXNlck5hbWU6IHVzZXJOYW1lCiAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICB1c2VyVXBkYXRlOiB0cnVlCiAgICAgICAgICAgIH0pOwoKICAgICAgICAgIGNhc2UgMTI6CiAgICAgICAgICAgIHJvb21MaXN0LnB1c2gocm9vbUlkKTsKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTAuYWJydXB0KCJyZXR1cm4iLCB0cnVlKTsKCiAgICAgICAgICBjYXNlIDE0OgogICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTAuc3RvcCgpOwogICAgICAgIH0KICAgICAgfQogICAgfSwgX2NhbGxlZTEwKTsKICB9KSk7CiAgcmV0dXJuIF9sb2dpbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwp9CgpmdW5jdGlvbiBlbnRlclJvb20oKSB7CiAgcmV0dXJuIF9lbnRlclJvb20uYXBwbHkodGhpcywgYXJndW1lbnRzKTsKfQoKZnVuY3Rpb24gX2VudGVyUm9vbSgpIHsKICBfZW50ZXJSb29tID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMTEoKSB7CiAgICB2YXIgcm9vbUlkOwogICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUxMSQoX2NvbnRleHQxMSkgewogICAgICB3aGlsZSAoMSkgewogICAgICAgIHN3aXRjaCAoX2NvbnRleHQxMS5wcmV2ID0gX2NvbnRleHQxMS5uZXh0KSB7CiAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgIHJvb21JZCA9ICQoJyNyb29tSWQnKS52YWwoKTsKCiAgICAgICAgICAgIGlmIChyb29tSWQpIHsKICAgICAgICAgICAgICBfY29udGV4dDExLm5leHQgPSA0OwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CgogICAgICAgICAgICBhbGVydCgncm9vbUlkIGlzIGVtcHR5Jyk7CiAgICAgICAgICAgIHJldHVybiBfY29udGV4dDExLmFicnVwdCgicmV0dXJuIiwgZmFsc2UpOwoKICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgX2NvbnRleHQxMS5uZXh0ID0gNjsKICAgICAgICAgICAgcmV0dXJuIGxvZ2luKHJvb21JZCk7CgogICAgICAgICAgY2FzZSA2OgogICAgICAgICAgICBsb2dpblJvb20gPSB0cnVlOyAvLyBjb25zb2xlLndhcm4oJ3JlbW90ZVZpZGVvJykKICAgICAgICAgICAgLy8gJCgnLnJlbW90ZVZpZGVvJykuaHRtbCgnJyk7CgogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxMS5hYnJ1cHQoInJldHVybiIsIHRydWUpOwoKICAgICAgICAgIGNhc2UgODoKICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgIHJldHVybiBfY29udGV4dDExLnN0b3AoKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sIF9jYWxsZWUxMSk7CiAgfSkpOwogIHJldHVybiBfZW50ZXJSb29tLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7Cn0KCmZ1bmN0aW9uIGxvZ291dCgpIHsKICByZXR1cm4gX2xvZ291dC5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwp9CgpmdW5jdGlvbiBfbG9nb3V0KCkgewogIF9sb2dvdXQgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUxMigpIHsKICAgIHZhciByb29tSWQsIGk7CiAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTEyJChfY29udGV4dDEyKSB7CiAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgc3dpdGNoIChfY29udGV4dDEyLnByZXYgPSBfY29udGV4dDEyLm5leHQpIHsKICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgY29uc29sZS5pbmZvKCdsZWF2ZSByb29tICBhbmQgY2xvc2Ugc3RyZWFtJyk7CiAgICAgICAgICAgIHJvb21JZCA9ICQoJyNyb29tSWQnKS52YWwoKTsgLy8g5YGc5q2i5ouJ5rWBCiAgICAgICAgICAgIC8vIHN0b3AgcGxheWluZwoKICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IHVzZUxvY2FsU3RyZWFtTGlzdC5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgIHVzZUxvY2FsU3RyZWFtTGlzdFtpXS5zdHJlYW1JRCAmJiB6Zy5zdG9wUGxheWluZ1N0cmVhbSh1c2VMb2NhbFN0cmVhbUxpc3RbaV0uc3RyZWFtSUQpOwogICAgICAgICAgICB9IC8vIOa4heepuumhtemdogogICAgICAgICAgICAvLyBDbGVhciBwYWdlCgoKICAgICAgICAgICAgdXNlTG9jYWxTdHJlYW1MaXN0ID0gW107IC8vIHdpbmRvdy51c2VMb2NhbFN0cmVhbUxpc3QgPSBbXTsKCiAgICAgICAgICAgIHJvb21MaXN0LnNwbGljZShyb29tTGlzdC5maW5kSW5kZXgoZnVuY3Rpb24gKHJvb20pIHsKICAgICAgICAgICAgICByZXR1cm4gcm9vbSA9PSByb29tSWQ7CiAgICAgICAgICAgIH0pLCAxKTsKCiAgICAgICAgICAgIGlmIChwcmV2aWV3VmlkZW8uc3JjT2JqZWN0ICYmIGlzUHJldmlld2VkICYmICghcm9vbUlkIHx8IHJvb21MaXN0Lmxlbmd0aCA9PSAwKSkgewogICAgICAgICAgICAgIHByZXZpZXdWaWRlby5zcmNPYmplY3QgPSBudWxsOwogICAgICAgICAgICAgIHpnLnN0b3BQdWJsaXNoaW5nU3RyZWFtKHB1Ymxpc2hTdHJlYW1JZCk7CiAgICAgICAgICAgICAgemcuZGVzdHJveVN0cmVhbShsb2NhbFN0cmVhbSk7CiAgICAgICAgICAgICAgaXNQcmV2aWV3ZWQgPSBmYWxzZTsKICAgICAgICAgICAgICAhJCgnLnNvdW5kJykuaGFzQ2xhc3MoJ2Qtbm9uZScpICYmICQoJy5zb3VuZCcpLmFkZENsYXNzKCdkLW5vbmUnKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKCFyb29tSWQgfHwgcm9vbUxpc3QubGVuZ3RoID09IDApIHsKICAgICAgICAgICAgICAkKCcucmVtb3RlVmlkZW8nKS5odG1sKCcnKTsKICAgICAgICAgICAgICAkKCcjbWVtYmVyTGlzdCcpLmh0bWwoJycpOwogICAgICAgICAgICB9IC8v6YCA5Ye655m75b2VCiAgICAgICAgICAgIC8vbG9nb3V0CgoKICAgICAgICAgICAgemcubG9nb3V0Um9vbShyb29tSWQpOwogICAgICAgICAgICBsb2dpblJvb20gPSBmYWxzZTsKCiAgICAgICAgICBjYXNlIDk6CiAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxMi5zdG9wKCk7CiAgICAgICAgfQogICAgICB9CiAgICB9LCBfY2FsbGVlMTIpOwogIH0pKTsKICByZXR1cm4gX2xvZ291dC5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwp9CgpmdW5jdGlvbiBwdWJsaXNoKF94MTEsIF94MTIpIHsKICByZXR1cm4gX3B1Ymxpc2guYXBwbHkodGhpcywgYXJndW1lbnRzKTsKfQoKZnVuY3Rpb24gX3B1Ymxpc2goKSB7CiAgX3B1Ymxpc2ggPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUxMyhjb25zdHJhaW50cywgaXNOZXcpIHsKICAgIHZhciB2aWRlbywgX2NvbnN0cmFpbnRzLCBwbGF5VHlwZTsKCiAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTEzJChfY29udGV4dDEzKSB7CiAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgc3dpdGNoIChfY29udGV4dDEzLnByZXYgPSBfY29udGV4dDEzLm5leHQpIHsKICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgY29uc29sZS53YXJuKCdjcmVhdGVTdHJlYW0nLCAkKCcjYXVkaW9MaXN0JykudmFsKCksICQoJyN2aWRlb0xpc3QnKS52YWwoKSk7CiAgICAgICAgICAgIGNvbnNvbGUud2FybignY29uc3RyYWludHMnLCBjb25zdHJhaW50cyk7CiAgICAgICAgICAgIHZpZGVvID0gY29uc3RyYWludHMgJiYgY29uc3RyYWludHMuY2FtZXJhICYmIHR5cGVvZiBjb25zdHJhaW50cy5jYW1lcmEudmlkZW8gPT09ICdib29sZWFuJyA/IGNvbnN0cmFpbnRzLmNhbWVyYS52aWRlbyA6IHVuZGVmaW5lZDsKICAgICAgICAgICAgX2NvbnN0cmFpbnRzID0gewogICAgICAgICAgICAgIGNhbWVyYTogewogICAgICAgICAgICAgICAgYXVkaW9JbnB1dDogJCgnI2F1ZGlvTGlzdCcpLnZhbCgpLAogICAgICAgICAgICAgICAgdmlkZW9JbnB1dDogJCgnI3ZpZGVvTGlzdCcpLnZhbCgpLAogICAgICAgICAgICAgICAgdmlkZW86IHZpZGVvICE9PSB1bmRlZmluZWQgPyB2aWRlbyA6ICQoJyN2aWRlb0xpc3QnKS52YWwoKSA9PT0gJzAnID8gZmFsc2UgOiB0cnVlLAogICAgICAgICAgICAgICAgYXVkaW86ICQoJyNhdWRpb0xpc3QnKS52YWwoKSA9PT0gJzAnID8gZmFsc2UgOiB0cnVlIC8vIGNoYW5uZWxDb3VudDogY29uc3RyYWludHMgJiYgY29uc3RyYWludHMuY2FtZXJhICYmIGNvbnN0cmFpbnRzLmNhbWVyYS5jaGFubmVsQ291bnQsCgogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfTsKICAgICAgICAgICAgY29uc3RyYWludHMgJiYgY29uc3RyYWludHMuY2FtZXJhICYmIE9iamVjdC5hc3NpZ24oX2NvbnN0cmFpbnRzLmNhbWVyYSwgY29uc3RyYWludHMuY2FtZXJhKTsKICAgICAgICAgICAgIV9jb25zdHJhaW50cy5jYW1lcmEudmlkZW8gJiYgKHByZXZpZXdWaWRlby5jb250cm9scyA9IHRydWUpOwogICAgICAgICAgICBwbGF5VHlwZSA9IF9jb25zdHJhaW50cy5jYW1lcmEuYXVkaW8gPT09IGZhbHNlID8gJ1ZpZGVvJyA6IF9jb25zdHJhaW50cy5jYW1lcmEudmlkZW8gPT09IGZhbHNlID8gJ0F1ZGlvJyA6ICdhbGwnOwogICAgICAgICAgICBwdWJsaXNoVHlwZSA9IHBsYXlUeXBlOyAvLyBjb25zb2xlLmVycm9yKCdwbGF5VHlwZScsIHBsYXlUeXBlKTsKCiAgICAgICAgICAgIHB1c2goX2NvbnN0cmFpbnRzLCB7CiAgICAgICAgICAgICAgZXh0cmFJbmZvOiBKU09OLnN0cmluZ2lmeSh7CiAgICAgICAgICAgICAgICBwbGF5VHlwZTogcGxheVR5cGUKICAgICAgICAgICAgICB9KQogICAgICAgICAgICB9LCBpc05ldyk7CgogICAgICAgICAgY2FzZSA5OgogICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTMuc3RvcCgpOwogICAgICAgIH0KICAgICAgfQogICAgfSwgX2NhbGxlZTEzKTsKICB9KSk7CiAgcmV0dXJuIF9wdWJsaXNoLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7Cn0KCmZ1bmN0aW9uIHB1c2goX3gxMykgewogIHJldHVybiBfcHVzaC5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwp9CgpmdW5jdGlvbiBfcHVzaCgpIHsKICBfcHVzaCA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTE0KGNvbnN0cmFpbnRzKSB7CiAgICB2YXIgcHVibGlzaE9wdGlvbiwKICAgICAgICBpc05ldywKICAgICAgICByZXN1bHQsCiAgICAgICAgX2FyZ3MxNCA9IGFyZ3VtZW50czsKICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMTQkKF9jb250ZXh0MTQpIHsKICAgICAgd2hpbGUgKDEpIHsKICAgICAgICBzd2l0Y2ggKF9jb250ZXh0MTQucHJldiA9IF9jb250ZXh0MTQubmV4dCkgewogICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICBwdWJsaXNoT3B0aW9uID0gX2FyZ3MxNC5sZW5ndGggPiAxICYmIF9hcmdzMTRbMV0gIT09IHVuZGVmaW5lZCA/IF9hcmdzMTRbMV0gOiB7fTsKICAgICAgICAgICAgaXNOZXcgPSBfYXJnczE0Lmxlbmd0aCA+IDIgPyBfYXJnczE0WzJdIDogdW5kZWZpbmVkOwogICAgICAgICAgICBfY29udGV4dDE0LnByZXYgPSAyOwoKICAgICAgICAgICAgaWYgKGxvY2FsU3RyZWFtKSB7CiAgICAgICAgICAgICAgemcuZGVzdHJveVN0cmVhbShsb2NhbFN0cmVhbSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIF9jb250ZXh0MTQubmV4dCA9IDY7CiAgICAgICAgICAgIHJldHVybiB6Zy5jcmVhdGVTdHJlYW0oY29uc3RyYWludHMpOwoKICAgICAgICAgIGNhc2UgNjoKICAgICAgICAgICAgbG9jYWxTdHJlYW0gPSBfY29udGV4dDE0LnNlbnQ7CiAgICAgICAgICAgIC8vIHZhciBBdWRpb0NvbnRleHQgPSB3aW5kb3cuQXVkaW9Db250ZXh0IHx8IHdpbmRvdy53ZWJraXRBdWRpb0NvbnRleHQ7IC8vIOWFvOWuueaApwogICAgICAgICAgICAvLyBsZXQgbG9jYWxUcmFjaz0gbG9jYWxTdHJlYW0uZ2V0QXVkaW9UcmFja3MoKVswXTsKICAgICAgICAgICAgLy8gbGV0IGF1ZGlvQ29udGV4dCA9IG5ldyBBdWRpb0NvbnRleHQoKTsvLyDliJvlu7pBdWRpb+S4iuS4i+aWhwogICAgICAgICAgICAvLyBsZXQgbWVkaWFTdHJlYW1Tb3VyY2UgPSBhdWRpb0NvbnRleHQuY3JlYXRlTWVkaWFTdHJlYW1Tb3VyY2UobG9jYWxTdHJlYW0pOwogICAgICAgICAgICAvLyBsZXQgZGVzdGluYXRpb24gPSBhdWRpb0NvbnRleHQuY3JlYXRlTWVkaWFTdHJlYW1EZXN0aW5hdGlvbigpOwogICAgICAgICAgICAvLyBsZXQgZ2Fpbk5vZGUgPSBhdWRpb0NvbnRleHQuY3JlYXRlR2FpbigpOwogICAgICAgICAgICAvLyBtZWRpYVN0cmVhbVNvdXJjZS5jb25uZWN0KGdhaW5Ob2RlKTsKICAgICAgICAgICAgLy8gZ2Fpbk5vZGUuY29ubmVjdChkZXN0aW5hdGlvbik7CiAgICAgICAgICAgIC8vIGdhaW5Ob2RlLmdhaW4udmFsdWU9MzsKICAgICAgICAgICAgLy8gbGV0IGF1ZGlvVHJhY2sgPSBkZXN0aW5hdGlvbi5zdHJlYW0uZ2V0QXVkaW9UcmFja3MoKVswXTsKICAgICAgICAgICAgLy8gbG9jYWxTdHJlYW0ucmVtb3ZlVHJhY2sobG9jYWxUcmFjayk7CiAgICAgICAgICAgIC8vIGxvY2FsU3RyZWFtLmFkZFRyYWNrKGF1ZGlvVHJhY2spOwogICAgICAgICAgICBwcmV2aWV3VmlkZW8uc3JjT2JqZWN0ID0gbG9jYWxTdHJlYW07CiAgICAgICAgICAgIGlzUHJldmlld2VkID0gdHJ1ZTsKICAgICAgICAgICAgJCgnLnNvdW5kJykuaGFzQ2xhc3MoJ2Qtbm9uZScpICYmICQoJy5zb3VuZCcpLnJlbW92ZUNsYXNzKCdkLW5vbmUnKTsKICAgICAgICAgICAgaXNOZXcgJiYgKHB1Ymxpc2hTdHJlYW1JZCA9ICd3ZWJydGMnICsgbmV3IERhdGUoKS5nZXRUaW1lKCkpOwogICAgICAgICAgICBpZiAoJCgiI3ZpZGVvQ29kZWMiKS52YWwoKSkgcHVibGlzaE9wdGlvbi52aWRlb0NvZGVjID0gJCgiI3ZpZGVvQ29kZWMiKS52YWwoKTsKICAgICAgICAgICAgaWYgKCQoJyNyb29tSWQnKS52YWwoKSkgcHVibGlzaE9wdGlvbi5yb29tSUQgPSAkKCcjcm9vbUlkJykudmFsKCk7CiAgICAgICAgICAgIHJlc3VsdCA9IHpnLnN0YXJ0UHVibGlzaGluZ1N0cmVhbShwdWJsaXNoU3RyZWFtSWQsIGxvY2FsU3RyZWFtLCBwdWJsaXNoT3B0aW9uKTsKICAgICAgICAgICAgY29uc29sZS5sb2coJ3B1Ymxpc2ggc3RyZWFtJyArIHB1Ymxpc2hTdHJlYW1JZCwgcmVzdWx0KTsKICAgICAgICAgICAgX2NvbnRleHQxNC5uZXh0ID0gMjA7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgMTc6CiAgICAgICAgICAgIF9jb250ZXh0MTQucHJldiA9IDE3OwogICAgICAgICAgICBfY29udGV4dDE0LnQwID0gX2NvbnRleHQxNFsiY2F0Y2giXSgyKTsKCiAgICAgICAgICAgIGlmIChfY29udGV4dDE0LnQwLm5hbWUpIHsKICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdjcmVhdGVTdHJlYW0nLCBfY29udGV4dDE0LnQwLm5hbWUsIF9jb250ZXh0MTQudDAubWVzc2FnZSk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignY3JlYXRlU3RyZWFtIGVycm9yJywgX2NvbnRleHQxNC50MCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICBjYXNlIDIwOgogICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTQuc3RvcCgpOwogICAgICAgIH0KICAgICAgfQogICAgfSwgX2NhbGxlZTE0LCBudWxsLCBbWzIsIDE3XV0pOwogIH0pKTsKICByZXR1cm4gX3B1c2guYXBwbHkodGhpcywgYXJndW1lbnRzKTsKfQoKJCgnI3RvZ2dsZUNhbWVyYScpLmNsaWNrKGZ1bmN0aW9uICgpIHsKICB6Zy5tdXRlUHVibGlzaFN0cmVhbVZpZGVvKHByZXZpZXdWaWRlby5zcmNPYmplY3QsICEkKHRoaXMpLmhhc0NsYXNzKCdkaXNhYmxlZCcpKTsKICAkKHRoaXMpLnRvZ2dsZUNsYXNzKCdkaXNhYmxlZCcpOwp9KTsKJCgnI3RvZ2dsZVNwZWFrZXInKS5jbGljayhmdW5jdGlvbiAoKSB7CiAgemcubXV0ZVB1Ymxpc2hTdHJlYW1BdWRpbyhwcmV2aWV3VmlkZW8uc3JjT2JqZWN0LCAhJCh0aGlzKS5oYXNDbGFzcygnZGlzYWJsZWQnKSk7CiAgJCh0aGlzKS50b2dnbGVDbGFzcygnZGlzYWJsZWQnKTsKfSk7CiQoJyNlbnRlclJvb20nKS5jbGljayggLyojX19QVVJFX18qL19hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTQoKSB7CiAgdmFyIGxvZ2luU3VjOwogIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlNCQoX2NvbnRleHQ0KSB7CiAgICB3aGlsZSAoMSkgewogICAgICBzd2l0Y2ggKF9jb250ZXh0NC5wcmV2ID0gX2NvbnRleHQ0Lm5leHQpIHsKICAgICAgICBjYXNlIDA6CiAgICAgICAgICBsb2dpblN1YyA9IGZhbHNlOwogICAgICAgICAgX2NvbnRleHQ0LnByZXYgPSAxOwogICAgICAgICAgX2NvbnRleHQ0Lm5leHQgPSA0OwogICAgICAgICAgcmV0dXJuIGVudGVyUm9vbSgpOwoKICAgICAgICBjYXNlIDQ6CiAgICAgICAgICBsb2dpblN1YyA9IF9jb250ZXh0NC5zZW50OwoKICAgICAgICAgIGlmICghbG9naW5TdWMpIHsKICAgICAgICAgICAgX2NvbnRleHQ0Lm5leHQgPSAxMzsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKGxvY2FsU3RyZWFtKSB7CiAgICAgICAgICAgIHpnLmRlc3Ryb3lTdHJlYW0obG9jYWxTdHJlYW0pOwogICAgICAgICAgfQoKICAgICAgICAgIF9jb250ZXh0NC5uZXh0ID0gOTsKICAgICAgICAgIHJldHVybiB6Zy5jcmVhdGVTdHJlYW0oewogICAgICAgICAgICBjYW1lcmE6IHsKICAgICAgICAgICAgICBhdWRpb0lucHV0OiAkKCcjYXVkaW9MaXN0JykudmFsKCksCiAgICAgICAgICAgICAgdmlkZW9JbnB1dDogJCgnI3ZpZGVvTGlzdCcpLnZhbCgpLAogICAgICAgICAgICAgIHZpZGVvOiAkKCcjdmlkZW9MaXN0JykudmFsKCkgPT09ICcwJyA/IGZhbHNlIDogdHJ1ZSwKICAgICAgICAgICAgICBhdWRpbzogJCgnI2F1ZGlvTGlzdCcpLnZhbCgpID09PSAnMCcgPyBmYWxzZSA6IHRydWUKICAgICAgICAgICAgfQogICAgICAgICAgfSk7CgogICAgICAgIGNhc2UgOToKICAgICAgICAgIGxvY2FsU3RyZWFtID0gX2NvbnRleHQ0LnNlbnQ7CiAgICAgICAgICBwcmV2aWV3VmlkZW8uc3JjT2JqZWN0ID0gbG9jYWxTdHJlYW07CiAgICAgICAgICBpc1ByZXZpZXdlZCA9IHRydWU7CiAgICAgICAgICAkKCcjdmlkZW9MaXN0JykudmFsKCkgPT09ICcwJyAmJiAocHJldmlld1ZpZGVvLmNvbnRyb2xzID0gdHJ1ZSk7CgogICAgICAgIGNhc2UgMTM6CiAgICAgICAgICBfY29udGV4dDQubmV4dCA9IDE4OwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgMTU6CiAgICAgICAgICBfY29udGV4dDQucHJldiA9IDE1OwogICAgICAgICAgX2NvbnRleHQ0LnQwID0gX2NvbnRleHQ0WyJjYXRjaCJdKDEpOwogICAgICAgICAgY29uc29sZS5lcnJvcihfY29udGV4dDQudDApOwoKICAgICAgICBjYXNlIDE4OgogICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICByZXR1cm4gX2NvbnRleHQ0LnN0b3AoKTsKICAgICAgfQogICAgfQogIH0sIF9jYWxsZWU0LCBudWxsLCBbWzEsIDE1XV0pOwp9KSkpOwpleHBvcnQgeyB6ZywgYXBwSUQsIHB1Ymxpc2hTdHJlYW1JZCwgY2hlY2tBblJ1biwgc3VwcG9ydFNjcmVlblNoYXJpbmcsIHVzZXJJRCwgdXNlTG9jYWxTdHJlYW1MaXN0LCBsb2dvdXQsIGVudGVyUm9vbSwgcHVzaCwgcHVibGlzaCwgcHJldmlld1ZpZGVvLCBpc1ByZXZpZXdlZCwgbG9naW5Sb29tLCBwdWJsaXNoVHlwZSwgbDMgfTsgLy8gJCh3aW5kb3cpLm9uKCd1bmxvYWQnLCBmdW5jdGlvbigpIHsKLy8gICAgIGxvZ291dCgpOwovLyB9KTs="},{"version":3,"sources":["/Users/chengxiaofeng/Desktop/项目/手写板项目/web/src/views/common.js"],"names":["VConsole","ZegoExpressEngine","getCgi","getBrowser","userName","Date","getTime","tokenUrl","userID","publishStreamId","zg","appID","server","cgiToken","previewVideo","useLocalStreamList","isPreviewed","supportScreenSharing","loginRoom","localStream","publishType","l3","roomList","$","get","rsp","data","console","log","browser","versions","u","navigator","userAgent","app","appVersion","trident","indexOf","presto","webKit","gecko","mobile","match","ios","android","iPhone","iPad","webApp","weixin","qq","language","browserLanguage","toLowerCase","window","checkAnRun","checkScreen","getVersion","checkSystemRequirements","result","warn","videoCodec","H264","attr","VP8","webRTC","alert","screenSharing","start","error","initSDK","setLogConfig","logLevel","remoteLogLevel","logURL","setDebugVerbose","setSoundLevelDelegate","click","loginSuc","enterRoom","publish","logout","enumDevices","audioInputList","videoInputList","deviceInfo","microphones","map","item","index","deviceName","push","deviceID","cameras","html","join","on","roomID","state","errorCode","extendedData","updateType","userList","JSON","stringify","streamID","info","videos","i","length","srcObject","streamList","remoteStream","playOption","val","resourceMode","startPlayingStream","then","stream","videoTemp","append","video","muted","err","k","j","stopPlayingStream","remove","splice","streamQuality","videoFPS","videoBitrate","audio","audioBitrate","audioFPS","status","forEach","type","Math","round","soundLevel","device","deviceType","count","login","roomId","token","app_id","id_name","cgi_token","userUpdate","findIndex","room","stopPublishingStream","destroyStream","hasClass","addClass","logoutRoom","constraints","isNew","camera","undefined","_constraints","audioInput","videoInput","Object","assign","controls","playType","extraInfo","publishOption","createStream","removeClass","startPublishingStream","name","message","mutePublishStreamVideo","toggleClass","mutePublishStreamAudio"],"mappings":"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","sourcesContent":["/* eslint-disable @typescript-eslint/no-use-before-define */\nimport VConsole from 'vconsole';\nimport './assets/bootstrap.min';\nimport './assets/bootstrap.min.css';\nimport { ZegoExpressEngine } from 'zego-express-engine-webrtc';\nimport { getCgi } from './content';\nimport { getBrowser } from './assets/utils';\n\nnew VConsole();\nconst userName = 'sampleUser' + new Date().getTime();\nconst tokenUrl = 'https://wsliveroom-alpha.zego.im:8282/token';\nlet userID = 'sample' + new Date().getTime();\nlet publishStreamId = 'webrtc' + new Date().getTime();\nlet zg;\nlet appID = 1739272706; // 请从官网控制台获取对应的appID\nlet server = 'wss://webliveroom-test.zego.im/ws'; // 请从官网控制台获取对应的server地址，否则可能登录失败\n\nlet cgiToken = '';\n//const appSign = '';\nlet previewVideo;\nlet useLocalStreamList = [];\nlet isPreviewed = false;\nlet supportScreenSharing = false;\nlet loginRoom = false;\n\nlet localStream;\nlet publishType;\n\nlet l3;\nlet roomList = [];\n\n// 测试用代码，开发者请忽略\n// Test code, developers please ignore\n\n({ appID, server, cgiToken, userID, l3 } = getCgi(appID, server, cgiToken));\nif (userID == \"\") userID = 'sample' + new Date().getTime();\n\nif (cgiToken && tokenUrl == 'https://wsliveroom-alpha.zego.im:8282/token') {\n    $.get(cgiToken, rsp => {\n        cgiToken = rsp.data;\n        console.log(cgiToken);\n    });\n}\n\n// 测试用代码 end\n// Test code end\n\nlet browser = {\n    versions:function(){\n        var u = navigator.userAgent, app = navigator.appVersion;\n        return {\n            trident: u.indexOf('Trident') > -1, //IE内核\n            presto: u.indexOf('Presto') > -1, //opera内核\n            webKit: u.indexOf('AppleWebKit') > -1, //苹果、谷歌内核\n            gecko: u.indexOf('Gecko') > -1 && u.indexOf('KHTML') == -1,//火狐内核\n            mobile: !!u.match(/AppleWebKit.*Mobile.*/), //是否为移动终端\n            ios: !!u.match(/\\(i[^;]+;( U;)? CPU.+Mac OS X/), //ios终端\n            android: u.indexOf('Android') > -1 || u.indexOf('Adr') > -1, //android终端\n            iPhone: u.indexOf('iPhone') > -1 , //是否为iPhone或者QQHD浏览器\n            iPad: u.indexOf('iPad') > -1, //是否iPad\n            webApp: u.indexOf('Safari') == -1, //是否web应用程序，没有头部与底部\n            weixin: u.indexOf('MicroMessenger') > -1, //是否微信 （2015-01-22新增）\n            qq: u.match(/\\sQQ/i) == \" qq\" //是否QQ\n        };\n    }(),\n    language:(navigator.browserLanguage || navigator.language).toLowerCase()\n}\n\n// eslint-disable-next-line prefer-const\nzg = new ZegoExpressEngine(appID, server);\n\nwindow.zg = zg;\nwindow.useLocalStreamList = useLocalStreamList;\n\nasync function checkAnRun(checkScreen) {\n    console.log('sdk version is', zg.getVersion());\n    try {\n        const result = await zg.checkSystemRequirements();\n\n        console.warn('checkSystemRequirements ', result);\n        !result.videoCodec.H264 && $('#videoCodeType option:eq(1)').attr('disabled', 'disabled');\n        !result.videoCodec.VP8 && $('#videoCodeType option:eq(2)').attr('disabled', 'disabled');\n\n        if (!result.webRTC) {\n            alert('browser is not support webrtc!!');\n            return false;\n        } else if (!result.videoCodec.H264 && !result.videoCodec.VP8) {\n            alert('browser is not support H264 and VP8');\n            return false;\n        } else if (result.videoCodec.H264) {\n            supportScreenSharing = result.screenSharing;\n            if (checkScreen && !supportScreenSharing) alert('browser is not support screenSharing');\n            previewVideo = $('#previewVideo')[0];\n            start();\n        } else {\n            alert('不支持H264，请前往混流转码测试');\n        }\n\n        return true;\n    } catch (err) {\n        console.error('checkSystemRequirements', err);\n        return false;\n    }\n\n\n}\n\nasync function start() {\n    initSDK();\n\n    zg.setLogConfig({\n        logLevel: 'debug',\n        remoteLogLevel: 'info',\n        logURL: '',\n    });\n\n    zg.setDebugVerbose(false);\n    zg.setSoundLevelDelegate(true, 3000);\n\n    $('#createRoom').click(async () => {\n        let loginSuc = false;\n        try {\n            loginSuc = await enterRoom();\n            loginSuc && (await publish());\n        } catch (error) {\n            console.error(error);\n        }\n    });\n\n    $('#openRoom').click(async () => {\n        await enterRoom();\n    });\n\n    $('#leaveRoom').click(function () {\n        logout();\n    });\n\n    $('#stopPlaySound').click(() => {\n        zg.setSoundLevelDelegate(false);\n    });\n\n    $('#resumePlaySound').click(() => {\n        zg.setSoundLevelDelegate(false);\n        zg.setSoundLevelDelegate(true);\n    });\n}\n\nasync function enumDevices() {\n    const audioInputList = [],\n        videoInputList = [];\n    const deviceInfo = await zg.enumDevices();\n\n    deviceInfo &&\n        deviceInfo.microphones.map((item, index) => {\n            if (!item.deviceName) {\n                item.deviceName = 'microphone' + index;\n            }\n            audioInputList.push(' <option value=\"' + item.deviceID + '\">' + item.deviceName + '</option>');\n            console.log('microphone: ' + item.deviceName);\n            return item;\n        });\n\n    deviceInfo &&\n        deviceInfo.cameras.map((item, index) => {\n            if (!item.deviceName) {\n                item.deviceName = 'camera' + index;\n            }\n            videoInputList.push(' <option value=\"' + item.deviceID + '\">' + item.deviceName + '</option>');\n            console.log('camera: ' + item.deviceName);\n            return item;\n        });\n\n    audioInputList.push('<option value=\"0\">禁止</option>');\n    videoInputList.push('<option value=\"0\">禁止</option>');\n\n    $('#audioList').html(audioInputList.join(''));\n    $('#videoList').html(videoInputList.join(''));\n}\n\nfunction initSDK() {\n    enumDevices();\n\n    zg.on('roomStateUpdate', (roomID, state, errorCode, extendedData) => {\n        console.warn('roomStateUpdate: ', roomID, state, errorCode, extendedData);\n    });\n    zg.on('roomUserUpdate', (roomID, updateType, userList) => {\n        console.warn(\n            `roomUserUpdate: room ${roomID}, user ${updateType === 'ADD' ? 'added' : 'left'} `,\n            JSON.stringify(userList),\n        );\n    });\n    zg.on('publisherStateUpdate', result => {\n        console.log('publisherStateUpdate: ', result.streamID, result.state);\n        if (result.state == 'PUBLISHING') {\n            console.info(' publish  success ' + result.streamID);\n        } else if (result.state == 'PUBLISH_REQUESTING') {\n            console.info(' publish  retry');\n        } else {\n            if (result.errorCode == 0) {\n                console.warn('publish stop ' + result.errorCode);\n            } else {\n                console.error('publish error ' + result.errorCode);\n            }\n            // const _msg = stateInfo.error.msg;\n            // if (stateInfo.error.msg.indexOf ('server session closed, reason: ') > -1) {\n            //         const code = stateInfo.error.msg.replace ('server session closed, reason: ', '');\n            //         if (code === '21') {\n            //                 _msg = '音频编解码不支持(opus)';\n            //         } else if (code === '22') {\n            //                 _msg = '视频编解码不支持(H264)'\n            //         } else if (code === '20') {\n            //                 _msg = 'sdp 解释错误';\n            //         }\n            // }\n            // alert('推流失败,reason = ' + _msg);\n        }\n    });\n    zg.on('playerStateUpdate', result => {\n        console.log('playerStateUpdate', result.streamID, result.state);\n        if (result.state == 'PLAYING') {\n            console.info(' play  success ' + result.streamID);\n            const browser = getBrowser();\n            console.warn('browser', browser);\n            if (browser === 'Safari') {\n                const videos = $('.remoteVideo video');\n                for (let i = 0; i < videos.length; i++) {\n                    videos[i].srcObject = videos[i].srcObject;\n                }\n            }\n        } else if (result.state == 'PLAY_REQUESTING') {\n            console.info(' play  retry');\n        } else {\n            if (result.errorCode == 0) {\n                console.warn('play stop ' + result.errorCode);\n            } else {\n                console.error('play error ' + result.errorCode);\n            }\n\n            // const _msg = stateInfo.error.msg;\n            // if (stateInfo.error.msg.indexOf ('server session closed, reason: ') > -1) {\n            //         const code = stateInfo.error.msg.replace ('server session closed, reason: ', '');\n            //         if (code === '21') {\n            //                 _msg = '音频编解码不支持(opus)';\n            //         } else if (code === '22') {\n            //                 _msg = '视频编解码不支持(H264)'\n            //         } else if (code === '20') {\n            //                 _msg = 'sdp 解释错误';\n            //         }\n            // }\n            // alert('拉流失败,reason = ' + _msg);\n        }\n    });\n    zg.on('streamExtraInfoUpdate', (roomID, streamList) => {\n        console.warn(`streamExtraInfoUpdate: room ${roomID},  `, JSON.stringify(streamList));\n    });\n    zg.on('roomStreamUpdate', async (roomID, updateType, streamList, extendedData) => {\n        console.warn('roomStreamUpdate 1 roomID ', roomID, streamList, extendedData);\n        // let queue = []\n        if (updateType == 'ADD') {\n            for (let i = 0; i < streamList.length; i++) {\n                console.info(streamList[i].streamID + ' was added');\n                let remoteStream;\n                let playOption = {};\n\n                if($(\"#videoCodec\").val()) playOption.videoCodec = $(\"#videoCodec\").val();\n                if(l3 == true) playOption.resourceMode = 2;\n\n                zg.startPlayingStream(streamList[i].streamID,playOption).then(stream => {\n                    remoteStream = stream;\n                    useLocalStreamList.push(streamList[i]);\n                    let videoTemp = $(`<video id=${streamList[i].streamID} autoplay muted playsinline controls></video>`)\n                    //queue.push(videoTemp)\n                    $('.remoteVideo').append(videoTemp);\n                    const video = $('.remoteVideo video:last')[0];\n                    console.warn('video', video, remoteStream);\n                    video.srcObject = remoteStream;\n                    video.muted = false;\n                    // videoTemp = null;\n                }).catch(err => {\n                    console.error('err', err);\n                });\n\n            }\n            // const inIphone = browser.versions.mobile && browser.versions.ios\n            // const inSafari = browser.versions.webApp\n            // const inWx = browser.versions.weixin\n            // if(streamList.length > 1 && (inIphone || inSafari || inWx)) {\n            //     const ac = zc.zegoWebRTC.ac;\n            //     ac.resume();\n            //     const gain = ac.createGain();\n\n            //     while(queue.length) {\n            //         let temp = queue.shift()\n            //         if(temp.srcObject) {\n            //             queue.push(ac.createMediaStreamSource(temp.srcObject))\n            //         } else {\n            //             temp.connect(gain)\n            //         }\n            //     }\n            //     gain.connect(ac.destination);\n            // }\n        } else if (updateType == 'DELETE') {\n            for (let k = 0; k < useLocalStreamList.length; k++) {\n                for (let j = 0; j < streamList.length; j++) {\n                    if (useLocalStreamList[k].streamID === streamList[j].streamID) {\n                        try {\n                            zg.stopPlayingStream(useLocalStreamList[k].streamID);\n                        } catch (error) {\n                            console.error(error);\n                        }\n\n                        console.info(useLocalStreamList[k].streamID + 'was devared');\n\n\n                        $('.remoteVideo video:eq(' + k + ')').remove();\n                        useLocalStreamList.splice(k--, 1);\n                        break;\n                    }\n                }\n            }\n        }\n    });\n\n    zg.on('playQualityUpdate', async (streamID, streamQuality) => {\n        console.log(\n            `play#${streamID} videoFPS: ${streamQuality.video.videoFPS} videoBitrate: ${streamQuality.video.videoBitrate} audioBitrate: ${streamQuality.audio.audioBitrate} audioFPS: ${streamQuality.audio.audioFPS}`,\n        );\n        console.log(`play#${streamID}`, streamQuality);\n    });\n\n    zg.on('publishQualityUpdate', async (streamID, streamQuality) => {\n        console.log(\n            `publish#${streamID} videoFPS: ${streamQuality.video.videoFPS} videoBitrate: ${streamQuality.video.videoBitrate} audioBitrate: ${streamQuality.audio.audioBitrate} audioFPS: ${streamQuality.audio.audioFPS}`,\n        );\n        console.log(`publish#${streamID}`, streamQuality);\n    });\n\n    zg.on('remoteCameraStatusUpdate', (streamID, status) => {\n        console.warn(`remoteCameraStatusUpdate ${streamID} camera status ${status == 'OPEN' ? 'open' : 'close'}`);\n    });\n\n    zg.on('remoteMicStatusUpdate', (streamID, status) => {\n        console.warn(`remoteMicStatusUpdate ${streamID} micro status ${status == 'OPEN' ? 'open' : 'close'}`);\n    });\n\n    zg.on('soundLevelUpdate', (streamList) => {\n        streamList.forEach(stream => {\n            stream.type == 'push' && $('#soundLevel').html(Math.round(stream.soundLevel) + '');\n            console.warn(`${stream.type} ${stream.streamID}, soundLevel: ${stream.soundLevel}`);\n        });\n    });\n    zg.on('deviceError', (errorCode, deviceName) => {\n        console.warn(`deviceError`, errorCode, deviceName);\n    });\n    zg.on('videoDeviceStateChanged', (updateType, device) => {\n        console.warn(`videoDeviceStateChanged`, device, updateType);\n    });\n    zg.on('audioDeviceStateChanged', (updateType, deviceType, device) => {\n        console.warn(`audioDeviceStateChanged`, device, updateType, deviceType);\n    });\n    zg.on('roomOnlineUserCountUpdate', (roomID, count) => {\n        console.warn(`roomOnlineUserCountUpdate ${roomID} ${count}`);\n    });\n}\n\nasync function login(roomId) {\n    // 获取token需要客户自己实现，token是对登录房间的唯一验证\n    // Obtaining a token needs to be implemented by the customer. The token is the only verification for the login room.\n    let token = '';\n    //测试用，开发者请忽略\n    //Test code, developers please ignore\n    if (cgiToken) {\n        token = await $.get(tokenUrl, {\n            app_id: appID,\n            id_name: userID,\n            cgi_token: cgiToken,\n        });\n        //测试用结束\n        //Test code end\n    } else {\n        token = await $.get('https://wsliveroom-alpha.zego.im:8282/token', {\n            app_id: appID,\n            id_name: userID,\n        });\n    }\n    await zg.loginRoom(roomId, token, { userID, userName }, { userUpdate: true });\n    roomList.push(roomId);\n\n    return true;\n}\n\nasync function enterRoom() {\n    const roomId = $('#roomId').val();\n    if (!roomId) {\n        alert('roomId is empty');\n        return false;\n    }\n\n    // for (let i = 0; i < useLocalStreamList.length; i++) {\n    //     useLocalStreamList[i].streamID && zg.stopPlayingStream(useLocalStreamList[i].streamID);\n    // }\n\n    await login(roomId);\n    loginRoom = true;\n\n    // console.warn('remoteVideo')\n    // $('.remoteVideo').html('');\n\n    return true;\n}\n\nasync function logout() {\n    console.info('leave room  and close stream');\n    const roomId = $('#roomId').val();\n    // 停止拉流\n    // stop playing\n    for (let i = 0; i < useLocalStreamList.length; i++) {\n        useLocalStreamList[i].streamID && zg.stopPlayingStream(useLocalStreamList[i].streamID);\n    }\n\n    // 清空页面\n    // Clear page\n    useLocalStreamList = [];\n    // window.useLocalStreamList = [];\n\n    roomList.splice(roomList.findIndex(room => room == roomId), 1);\n\n    if (previewVideo.srcObject && isPreviewed && (!roomId || roomList.length == 0) ) {\n      previewVideo.srcObject = null;\n      zg.stopPublishingStream(publishStreamId);\n      zg.destroyStream(localStream);\n      isPreviewed = false;\n      !$('.sound').hasClass('d-none') && $('.sound').addClass('d-none');\n    }\n\n    if (!roomId || roomList.length == 0) {\n      $('.remoteVideo').html('');\n      $('#memberList').html('');\n    }\n\n    //退出登录\n    //logout\n    zg.logoutRoom(roomId);\n    loginRoom = false;\n}\n\nasync function publish(constraints, isNew) {\n    console.warn('createStream', $('#audioList').val(), $('#videoList').val());\n    console.warn('constraints', constraints);\n    const video =\n        constraints && constraints.camera && typeof constraints.camera.video === 'boolean'\n            ? constraints.camera.video\n            : undefined;\n\n    const _constraints = {\n        camera: {\n            audioInput: $('#audioList').val(),\n            videoInput: $('#videoList').val(),\n            video: video !== undefined ? video : $('#videoList').val() === '0' ? false : true,\n            audio: $('#audioList').val() === '0' ? false : true,\n            // channelCount: constraints && constraints.camera && constraints.camera.channelCount,\n        },\n    };\n    constraints && constraints.camera && Object.assign(_constraints.camera, constraints.camera);\n    !_constraints.camera.video && (previewVideo.controls = true);\n    const playType =\n        _constraints.camera.audio === false ? 'Video' : _constraints.camera.video === false ? 'Audio' : 'all';\n    publishType = playType;\n    // console.error('playType', playType);\n    push(_constraints, { extraInfo: JSON.stringify({ playType }) }, isNew);\n}\nasync function push(constraints, publishOption = {}, isNew) {\n    try {\n        if(localStream) {\n            zg.destroyStream(localStream)\n        }\n        localStream = await zg.createStream(constraints);\n        // var AudioContext = window.AudioContext || window.webkitAudioContext; // 兼容性\n        // let localTrack= localStream.getAudioTracks()[0];\n        // let audioContext = new AudioContext();// 创建Audio上下文\n        // let mediaStreamSource = audioContext.createMediaStreamSource(localStream);\n        // let destination = audioContext.createMediaStreamDestination();\n        // let gainNode = audioContext.createGain();\n        // mediaStreamSource.connect(gainNode);\n        // gainNode.connect(destination);\n        // gainNode.gain.value=3;\n        // let audioTrack = destination.stream.getAudioTracks()[0];\n        // localStream.removeTrack(localTrack);\n        // localStream.addTrack(audioTrack);\n        previewVideo.srcObject = localStream;\n        isPreviewed = true;\n        $('.sound').hasClass('d-none') && $('.sound').removeClass('d-none');\n        isNew && (publishStreamId = 'webrtc' + new Date().getTime());\n        if($(\"#videoCodec\").val()) publishOption.videoCodec = $(\"#videoCodec\").val();\n        if ($('#roomId').val()) publishOption.roomID = $('#roomId').val();\n        const result = zg.startPublishingStream(publishStreamId, localStream, publishOption);\n        console.log('publish stream' + publishStreamId, result);\n    } catch (err) {\n        if (err.name) {\n            console.error('createStream', err.name, err.message);\n        } else {\n            console.error('createStream error', err);\n        }\n    }\n}\n\n$('#toggleCamera').click(function () {\n    zg.mutePublishStreamVideo(previewVideo.srcObject, !$(this).hasClass('disabled'));\n    $(this).toggleClass('disabled');\n});\n\n$('#toggleSpeaker').click(function () {\n    zg.mutePublishStreamAudio(previewVideo.srcObject, !$(this).hasClass('disabled'));\n    $(this).toggleClass('disabled');\n});\n\n$('#enterRoom').click(async () => {\n  let loginSuc = false;\n  try {\n      loginSuc = await enterRoom();\n      if (loginSuc) {\n          if(localStream) {\n              zg.destroyStream(localStream)\n          }\n          localStream = await zg.createStream({\n              camera: {\n                  audioInput: $('#audioList').val() ,\n                  videoInput: $('#videoList').val() ,\n                  video: $('#videoList').val() === '0' ? false : true,\n                  audio: $('#audioList').val() === '0' ? false : true,\n              },\n          });\n          previewVideo.srcObject = localStream;\n          isPreviewed = true;\n          $('#videoList').val() === '0' && (previewVideo.controls = true);\n      }\n  } catch (error) {\n      console.error(error);\n  }\n});\n\nexport {\n    zg,\n    appID,\n    publishStreamId,\n    checkAnRun,\n    supportScreenSharing,\n    userID,\n    useLocalStreamList,\n    logout,\n    enterRoom,\n    push,\n    publish,\n    previewVideo,\n    isPreviewed,\n    loginRoom,\n    publishType,\n    l3,\n};\n\n// $(window).on('unload', function() {\n//     logout();\n// });\n"]}]}