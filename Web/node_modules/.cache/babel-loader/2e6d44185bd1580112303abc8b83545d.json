{"remainingRequest":"/Users/chengxiaofeng/Desktop/项目/手写板项目/web/node_modules/babel-loader/lib/index.js!/Users/chengxiaofeng/Desktop/项目/手写板项目/web/src/views/common.js","dependencies":[{"path":"/Users/chengxiaofeng/Desktop/项目/手写板项目/web/src/views/common.js","mtime":1630544787812},{"path":"/Users/chengxiaofeng/Desktop/项目/手写板项目/web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/chengxiaofeng/Desktop/项目/手写板项目/web/node_modules/babel-loader/lib/index.js","mtime":315532800000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIi9Vc2Vycy9jaGVuZ3hpYW9mZW5nL0Rlc2t0b3AvXHU5ODc5XHU3NkVFL1x1NjI0Qlx1NTE5OVx1Njc3Rlx1OTg3OVx1NzZFRS93ZWIvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2FzeW5jVG9HZW5lcmF0b3IiOwppbXBvcnQgInJlZ2VuZXJhdG9yLXJ1bnRpbWUvcnVudGltZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmRhdGUudG8tc3RyaW5nLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuaW5kZXgtb2YuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5yZWdleHAuZXhlYy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5tYXRjaC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmNvbmNhdC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LnNwbGljZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmZvci1lYWNoLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5mb3ItZWFjaC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5Lm1hcC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmpvaW4uanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5maW5kLWluZGV4LmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZnVuY3Rpb24ubmFtZS5qcyI7CgovKiBlc2xpbnQtZGlzYWJsZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdXNlLWJlZm9yZS1kZWZpbmUgKi8KaW1wb3J0IFZDb25zb2xlIGZyb20gJ3Zjb25zb2xlJzsKaW1wb3J0ICcuL2Fzc2V0cy9ib290c3RyYXAubWluJzsKaW1wb3J0ICcuL2Fzc2V0cy9ib290c3RyYXAubWluLmNzcyc7CmltcG9ydCB7IFplZ29FeHByZXNzRW5naW5lIH0gZnJvbSAnemVnby1leHByZXNzLWVuZ2luZS13ZWJydGMnOwppbXBvcnQgeyBnZXRDZ2kgfSBmcm9tICcuL2NvbnRlbnQnOwppbXBvcnQgeyBnZXRCcm93c2VyIH0gZnJvbSAnLi9hc3NldHMvdXRpbHMnOwpuZXcgVkNvbnNvbGUoKTsKdmFyIHVzZXJOYW1lID0gJ3NhbXBsZVVzZXInICsgbmV3IERhdGUoKS5nZXRUaW1lKCk7CnZhciB0b2tlblVybCA9ICdodHRwczovL3dzbGl2ZXJvb20tYWxwaGEuemVnby5pbTo4MjgyL3Rva2VuJzsKdmFyIHVzZXJJRCA9ICdzYW1wbGUnICsgbmV3IERhdGUoKS5nZXRUaW1lKCk7CnZhciBwdWJsaXNoU3RyZWFtSWQgPSAnd2VicnRjJyArIG5ldyBEYXRlKCkuZ2V0VGltZSgpOwp2YXIgemc7CnZhciBhcHBJRCA9IDE2MTAxNTk0NzU7IC8vIOivt+S7juWumOe9keaOp+WItuWPsOiOt+WPluWvueW6lOeahGFwcElECgp2YXIgc2VydmVyID0gJ3dzczovL3dlYmxpdmVyb29tLXRlc3QuemVnby5pbS93cyc7IC8vIOivt+S7juWumOe9keaOp+WItuWPsOiOt+WPluWvueW6lOeahHNlcnZlcuWcsOWdgO+8jOWQpuWImeWPr+iDveeZu+W9leWksei0pQoKdmFyIGNnaVRva2VuID0gJyc7IC8vY29uc3QgYXBwU2lnbiA9ICcnOwoKdmFyIHByZXZpZXdWaWRlbzsKdmFyIHVzZUxvY2FsU3RyZWFtTGlzdCA9IFtdOwp2YXIgaXNQcmV2aWV3ZWQgPSBmYWxzZTsKdmFyIHN1cHBvcnRTY3JlZW5TaGFyaW5nID0gZmFsc2U7CnZhciBsb2dpblJvb20gPSBmYWxzZTsKdmFyIGxvY2FsU3RyZWFtOwp2YXIgcHVibGlzaFR5cGU7CnZhciBsMzsKdmFyIHJvb21MaXN0ID0gW107IC8vIOa1i+ivleeUqOS7o+egge+8jOW8gOWPkeiAheivt+W/veeVpQovLyBUZXN0IGNvZGUsIGRldmVsb3BlcnMgcGxlYXNlIGlnbm9yZQoKdmFyIF9nZXRDZ2kgPSBnZXRDZ2koYXBwSUQsIHNlcnZlciwgY2dpVG9rZW4pOwoKYXBwSUQgPSBfZ2V0Q2dpLmFwcElEOwpzZXJ2ZXIgPSBfZ2V0Q2dpLnNlcnZlcjsKY2dpVG9rZW4gPSBfZ2V0Q2dpLmNnaVRva2VuOwp1c2VySUQgPSBfZ2V0Q2dpLnVzZXJJRDsKbDMgPSBfZ2V0Q2dpLmwzOwppZiAodXNlcklEID09ICIiKSB1c2VySUQgPSAnc2FtcGxlJyArIG5ldyBEYXRlKCkuZ2V0VGltZSgpOwoKaWYgKGNnaVRva2VuICYmIHRva2VuVXJsID09ICdodHRwczovL3dzbGl2ZXJvb20tYWxwaGEuemVnby5pbTo4MjgyL3Rva2VuJykgewogICQuZ2V0KGNnaVRva2VuLCBmdW5jdGlvbiAocnNwKSB7CiAgICBjZ2lUb2tlbiA9IHJzcC5kYXRhOwogICAgY29uc29sZS5sb2coY2dpVG9rZW4pOwogIH0pOwp9IC8vIOa1i+ivleeUqOS7o+eggSBlbmQKLy8gVGVzdCBjb2RlIGVuZAoKCnZhciBicm93c2VyID0gewogIHZlcnNpb25zOiBmdW5jdGlvbiAoKSB7CiAgICB2YXIgdSA9IG5hdmlnYXRvci51c2VyQWdlbnQsCiAgICAgICAgYXBwID0gbmF2aWdhdG9yLmFwcFZlcnNpb247CiAgICByZXR1cm4gewogICAgICB0cmlkZW50OiB1LmluZGV4T2YoJ1RyaWRlbnQnKSA+IC0xLAogICAgICAvL0lF5YaF5qC4CiAgICAgIHByZXN0bzogdS5pbmRleE9mKCdQcmVzdG8nKSA+IC0xLAogICAgICAvL29wZXJh5YaF5qC4CiAgICAgIHdlYktpdDogdS5pbmRleE9mKCdBcHBsZVdlYktpdCcpID4gLTEsCiAgICAgIC8v6Iu55p6c44CB6LC35q2M5YaF5qC4CiAgICAgIGdlY2tvOiB1LmluZGV4T2YoJ0dlY2tvJykgPiAtMSAmJiB1LmluZGV4T2YoJ0tIVE1MJykgPT0gLTEsCiAgICAgIC8v54Gr54uQ5YaF5qC4CiAgICAgIG1vYmlsZTogISF1Lm1hdGNoKC9BcHBsZVdlYktpdC4qTW9iaWxlLiovKSwKICAgICAgLy/mmK/lkKbkuLrnp7vliqjnu4jnq68KICAgICAgaW9zOiAhIXUubWF0Y2goL1woaVteO10rOyggVTspPyBDUFUuK01hYyBPUyBYLyksCiAgICAgIC8vaW9z57uI56uvCiAgICAgIGFuZHJvaWQ6IHUuaW5kZXhPZignQW5kcm9pZCcpID4gLTEgfHwgdS5pbmRleE9mKCdBZHInKSA+IC0xLAogICAgICAvL2FuZHJvaWTnu4jnq68KICAgICAgaVBob25lOiB1LmluZGV4T2YoJ2lQaG9uZScpID4gLTEsCiAgICAgIC8v5piv5ZCm5Li6aVBob25l5oiW6ICFUVFIROa1j+iniOWZqAogICAgICBpUGFkOiB1LmluZGV4T2YoJ2lQYWQnKSA+IC0xLAogICAgICAvL+aYr+WQpmlQYWQKICAgICAgd2ViQXBwOiB1LmluZGV4T2YoJ1NhZmFyaScpID09IC0xLAogICAgICAvL+aYr+WQpndlYuW6lOeUqOeoi+W6j++8jOayoeacieWktOmDqOS4juW6lemDqAogICAgICB3ZWl4aW46IHUuaW5kZXhPZignTWljcm9NZXNzZW5nZXInKSA+IC0xLAogICAgICAvL+aYr+WQpuW+ruS/oSDvvIgyMDE1LTAxLTIy5paw5aKe77yJCiAgICAgIHFxOiB1Lm1hdGNoKC9cc1FRL2kpID09ICIgcXEiIC8v5piv5ZCmUVEKCiAgICB9OwogIH0oKSwKICBsYW5ndWFnZTogKG5hdmlnYXRvci5icm93c2VyTGFuZ3VhZ2UgfHwgbmF2aWdhdG9yLmxhbmd1YWdlKS50b0xvd2VyQ2FzZSgpCn07IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBwcmVmZXItY29uc3QKCnpnID0gbmV3IFplZ29FeHByZXNzRW5naW5lKGFwcElELCBzZXJ2ZXIpOwp3aW5kb3cuemcgPSB6ZzsKd2luZG93LnVzZUxvY2FsU3RyZWFtTGlzdCA9IHVzZUxvY2FsU3RyZWFtTGlzdDsKCmZ1bmN0aW9uIGNoZWNrQW5SdW4oX3gpIHsKICByZXR1cm4gX2NoZWNrQW5SdW4uYXBwbHkodGhpcywgYXJndW1lbnRzKTsKfQoKZnVuY3Rpb24gX2NoZWNrQW5SdW4oKSB7CiAgX2NoZWNrQW5SdW4gPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU1KGNoZWNrU2NyZWVuKSB7CiAgICB2YXIgcmVzdWx0OwogICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU1JChfY29udGV4dDUpIHsKICAgICAgd2hpbGUgKDEpIHsKICAgICAgICBzd2l0Y2ggKF9jb250ZXh0NS5wcmV2ID0gX2NvbnRleHQ1Lm5leHQpIHsKICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgX2NvbnRleHQ1LnByZXYgPSAwOwogICAgICAgICAgICBfY29udGV4dDUubmV4dCA9IDM7CiAgICAgICAgICAgIHJldHVybiB6Zy5jaGVja1N5c3RlbVJlcXVpcmVtZW50cygpOwoKICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgcmVzdWx0ID0gX2NvbnRleHQ1LnNlbnQ7CiAgICAgICAgICAgIC8vIGNvbnNvbGUud2FybignY2hlY2tTeXN0ZW1SZXF1aXJlbWVudHMgJywgcmVzdWx0KTsKICAgICAgICAgICAgIXJlc3VsdC52aWRlb0NvZGVjLkgyNjQgJiYgJCgnI3ZpZGVvQ29kZVR5cGUgb3B0aW9uOmVxKDEpJykuYXR0cignZGlzYWJsZWQnLCAnZGlzYWJsZWQnKTsKICAgICAgICAgICAgIXJlc3VsdC52aWRlb0NvZGVjLlZQOCAmJiAkKCcjdmlkZW9Db2RlVHlwZSBvcHRpb246ZXEoMiknKS5hdHRyKCdkaXNhYmxlZCcsICdkaXNhYmxlZCcpOwoKICAgICAgICAgICAgaWYgKHJlc3VsdC53ZWJSVEMpIHsKICAgICAgICAgICAgICBfY29udGV4dDUubmV4dCA9IDExOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CgogICAgICAgICAgICBhbGVydCgnYnJvd3NlciBpcyBub3Qgc3VwcG9ydCB3ZWJydGMhIScpOwogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ1LmFicnVwdCgicmV0dXJuIiwgZmFsc2UpOwoKICAgICAgICAgIGNhc2UgMTE6CiAgICAgICAgICAgIGlmICghKCFyZXN1bHQudmlkZW9Db2RlYy5IMjY0ICYmICFyZXN1bHQudmlkZW9Db2RlYy5WUDgpKSB7CiAgICAgICAgICAgICAgX2NvbnRleHQ1Lm5leHQgPSAxNjsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgYWxlcnQoJ2Jyb3dzZXIgaXMgbm90IHN1cHBvcnQgSDI2NCBhbmQgVlA4Jyk7CiAgICAgICAgICAgIHJldHVybiBfY29udGV4dDUuYWJydXB0KCJyZXR1cm4iLCBmYWxzZSk7CgogICAgICAgICAgY2FzZSAxNjoKICAgICAgICAgICAgaWYgKHJlc3VsdC52aWRlb0NvZGVjLkgyNjQpIHsKICAgICAgICAgICAgICBzdXBwb3J0U2NyZWVuU2hhcmluZyA9IHJlc3VsdC5zY3JlZW5TaGFyaW5nOwogICAgICAgICAgICAgIGlmIChjaGVja1NjcmVlbiAmJiAhc3VwcG9ydFNjcmVlblNoYXJpbmcpIGFsZXJ0KCdicm93c2VyIGlzIG5vdCBzdXBwb3J0IHNjcmVlblNoYXJpbmcnKTsKICAgICAgICAgICAgICBwcmV2aWV3VmlkZW8gPSAkKCcjcHJldmlld1ZpZGVvJylbMF07CiAgICAgICAgICAgICAgc3RhcnQoKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBhbGVydCgn5LiN5pSv5oyBSDI2NO+8jOivt+WJjeW+gOa3t+a1gei9rOeggea1i+ivlScpOwogICAgICAgICAgICB9CgogICAgICAgICAgY2FzZSAxNzoKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NS5hYnJ1cHQoInJldHVybiIsIHRydWUpOwoKICAgICAgICAgIGNhc2UgMjA6CiAgICAgICAgICAgIF9jb250ZXh0NS5wcmV2ID0gMjA7CiAgICAgICAgICAgIF9jb250ZXh0NS50MCA9IF9jb250ZXh0NVsiY2F0Y2giXSgwKTsKICAgICAgICAgICAgY29uc29sZS5lcnJvcignY2hlY2tTeXN0ZW1SZXF1aXJlbWVudHMnLCBfY29udGV4dDUudDApOwogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ1LmFicnVwdCgicmV0dXJuIiwgZmFsc2UpOwoKICAgICAgICAgIGNhc2UgMjQ6CiAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ1LnN0b3AoKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sIF9jYWxsZWU1LCBudWxsLCBbWzAsIDIwXV0pOwogIH0pKTsKICByZXR1cm4gX2NoZWNrQW5SdW4uYXBwbHkodGhpcywgYXJndW1lbnRzKTsKfQoKZnVuY3Rpb24gc3RhcnQoKSB7CiAgcmV0dXJuIF9zdGFydC5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwp9CgpmdW5jdGlvbiBfc3RhcnQoKSB7CiAgX3N0YXJ0ID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlOCgpIHsKICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlOCQoX2NvbnRleHQ4KSB7CiAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgc3dpdGNoIChfY29udGV4dDgucHJldiA9IF9jb250ZXh0OC5uZXh0KSB7CiAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgIGluaXRTREsoKTsKICAgICAgICAgICAgemcuc2V0TG9nQ29uZmlnKHsKICAgICAgICAgICAgICBsb2dMZXZlbDogJ2RlYnVnJywKICAgICAgICAgICAgICByZW1vdGVMb2dMZXZlbDogJ2luZm8nLAogICAgICAgICAgICAgIGxvZ1VSTDogJycKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIHpnLnNldERlYnVnVmVyYm9zZShmYWxzZSk7CiAgICAgICAgICAgIHpnLnNldFNvdW5kTGV2ZWxEZWxlZ2F0ZSh0cnVlLCAzMDAwKTsKICAgICAgICAgICAgJCgnI2NyZWF0ZVJvb20nKS5jbGljayggLyojX19QVVJFX18qL19hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTYoKSB7CiAgICAgICAgICAgICAgdmFyIGxvZ2luU3VjOwogICAgICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlNiQoX2NvbnRleHQ2KSB7CiAgICAgICAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0Ni5wcmV2ID0gX2NvbnRleHQ2Lm5leHQpIHsKICAgICAgICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICAgICAgICBsb2dpblN1YyA9IGZhbHNlOwogICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQ2LnByZXYgPSAxOwogICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQ2Lm5leHQgPSA0OwogICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGVudGVyUm9vbSgpOwoKICAgICAgICAgICAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICAgICAgICAgICAgICBsb2dpblN1YyA9IF9jb250ZXh0Ni5zZW50OwogICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQ2LnQwID0gbG9naW5TdWM7CgogICAgICAgICAgICAgICAgICAgICAgaWYgKCFfY29udGV4dDYudDApIHsKICAgICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQ2Lm5leHQgPSA5OwogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDYubmV4dCA9IDk7CiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcHVibGlzaCgpOwoKICAgICAgICAgICAgICAgICAgICBjYXNlIDk6CiAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDYubmV4dCA9IDE0OwogICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgICAgICAgIGNhc2UgMTE6CiAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDYucHJldiA9IDExOwogICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQ2LnQxID0gX2NvbnRleHQ2WyJjYXRjaCJdKDEpOwogICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihfY29udGV4dDYudDEpOwoKICAgICAgICAgICAgICAgICAgICBjYXNlIDE0OgogICAgICAgICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ2LnN0b3AoKTsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0sIF9jYWxsZWU2LCBudWxsLCBbWzEsIDExXV0pOwogICAgICAgICAgICB9KSkpOwogICAgICAgICAgICAkKCcjb3BlblJvb20nKS5jbGljayggLyojX19QVVJFX18qL19hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTcoKSB7CiAgICAgICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU3JChfY29udGV4dDcpIHsKICAgICAgICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ3LnByZXYgPSBfY29udGV4dDcubmV4dCkgewogICAgICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0Ny5uZXh0ID0gMjsKICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBlbnRlclJvb20oKTsKCiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ3LnN0b3AoKTsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0sIF9jYWxsZWU3KTsKICAgICAgICAgICAgfSkpKTsKICAgICAgICAgICAgJCgnI2xlYXZlUm9vbScpLmNsaWNrKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICBsb2dvdXQoKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICQoJyNzdG9wUGxheVNvdW5kJykuY2xpY2soZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgIHpnLnNldFNvdW5kTGV2ZWxEZWxlZ2F0ZShmYWxzZSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICAkKCcjcmVzdW1lUGxheVNvdW5kJykuY2xpY2soZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgIHpnLnNldFNvdW5kTGV2ZWxEZWxlZ2F0ZShmYWxzZSk7CiAgICAgICAgICAgICAgemcuc2V0U291bmRMZXZlbERlbGVnYXRlKHRydWUpOwogICAgICAgICAgICB9KTsKCiAgICAgICAgICBjYXNlIDk6CiAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ4LnN0b3AoKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sIF9jYWxsZWU4KTsKICB9KSk7CiAgcmV0dXJuIF9zdGFydC5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwp9CgpmdW5jdGlvbiBlbnVtRGV2aWNlcygpIHsKICByZXR1cm4gX2VudW1EZXZpY2VzLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7Cn0KCmZ1bmN0aW9uIF9lbnVtRGV2aWNlcygpIHsKICBfZW51bURldmljZXMgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU5KCkgewogICAgdmFyIGF1ZGlvSW5wdXRMaXN0LCB2aWRlb0lucHV0TGlzdCwgZGV2aWNlSW5mbzsKICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlOSQoX2NvbnRleHQ5KSB7CiAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgc3dpdGNoIChfY29udGV4dDkucHJldiA9IF9jb250ZXh0OS5uZXh0KSB7CiAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgIGF1ZGlvSW5wdXRMaXN0ID0gW10sIHZpZGVvSW5wdXRMaXN0ID0gW107CiAgICAgICAgICAgIF9jb250ZXh0OS5uZXh0ID0gMzsKICAgICAgICAgICAgcmV0dXJuIHpnLmVudW1EZXZpY2VzKCk7CgogICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICBkZXZpY2VJbmZvID0gX2NvbnRleHQ5LnNlbnQ7CiAgICAgICAgICAgIGRldmljZUluZm8gJiYgZGV2aWNlSW5mby5taWNyb3Bob25lcy5tYXAoZnVuY3Rpb24gKGl0ZW0sIGluZGV4KSB7CiAgICAgICAgICAgICAgaWYgKCFpdGVtLmRldmljZU5hbWUpIHsKICAgICAgICAgICAgICAgIGl0ZW0uZGV2aWNlTmFtZSA9ICdtaWNyb3Bob25lJyArIGluZGV4OwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgYXVkaW9JbnB1dExpc3QucHVzaCgnIDxvcHRpb24gdmFsdWU9IicgKyBpdGVtLmRldmljZUlEICsgJyI+JyArIGl0ZW0uZGV2aWNlTmFtZSArICc8L29wdGlvbj4nKTsgLy8gY29uc29sZS5sb2coJ21pY3JvcGhvbmU6ICcgKyBpdGVtLmRldmljZU5hbWUpOwoKICAgICAgICAgICAgICByZXR1cm4gaXRlbTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGRldmljZUluZm8gJiYgZGV2aWNlSW5mby5jYW1lcmFzLm1hcChmdW5jdGlvbiAoaXRlbSwgaW5kZXgpIHsKICAgICAgICAgICAgICBpZiAoIWl0ZW0uZGV2aWNlTmFtZSkgewogICAgICAgICAgICAgICAgaXRlbS5kZXZpY2VOYW1lID0gJ2NhbWVyYScgKyBpbmRleDsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIHZpZGVvSW5wdXRMaXN0LnB1c2goJyA8b3B0aW9uIHZhbHVlPSInICsgaXRlbS5kZXZpY2VJRCArICciPicgKyBpdGVtLmRldmljZU5hbWUgKyAnPC9vcHRpb24+Jyk7CiAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2NhbWVyYTogJyArIGl0ZW0uZGV2aWNlTmFtZSk7CiAgICAgICAgICAgICAgcmV0dXJuIGl0ZW07CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBhdWRpb0lucHV0TGlzdC5wdXNoKCc8b3B0aW9uIHZhbHVlPSIwIj7npoHmraI8L29wdGlvbj4nKTsKICAgICAgICAgICAgdmlkZW9JbnB1dExpc3QucHVzaCgnPG9wdGlvbiB2YWx1ZT0iMCI+56aB5q2iPC9vcHRpb24+Jyk7CiAgICAgICAgICAgICQoJyNhdWRpb0xpc3QnKS5odG1sKGF1ZGlvSW5wdXRMaXN0LmpvaW4oJycpKTsKICAgICAgICAgICAgJCgnI3ZpZGVvTGlzdCcpLmh0bWwodmlkZW9JbnB1dExpc3Quam9pbignJykpOwoKICAgICAgICAgIGNhc2UgMTA6CiAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ5LnN0b3AoKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sIF9jYWxsZWU5KTsKICB9KSk7CiAgcmV0dXJuIF9lbnVtRGV2aWNlcy5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwp9CgpmdW5jdGlvbiBpbml0U0RLKCkgewogIGVudW1EZXZpY2VzKCk7CiAgemcub24oJ3Jvb21TdGF0ZVVwZGF0ZScsIGZ1bmN0aW9uIChyb29tSUQsIHN0YXRlLCBlcnJvckNvZGUsIGV4dGVuZGVkRGF0YSkgewogICAgY29uc29sZS53YXJuKCdyb29tU3RhdGVVcGRhdGU6ICcsIHJvb21JRCwgc3RhdGUsIGVycm9yQ29kZSwgZXh0ZW5kZWREYXRhKTsKICB9KTsKICB6Zy5vbigncm9vbVVzZXJVcGRhdGUnLCBmdW5jdGlvbiAocm9vbUlELCB1cGRhdGVUeXBlLCB1c2VyTGlzdCkgewogICAgY29uc29sZS53YXJuKCJyb29tVXNlclVwZGF0ZTogcm9vbSAiLmNvbmNhdChyb29tSUQsICIsIHVzZXIgIikuY29uY2F0KHVwZGF0ZVR5cGUgPT09ICdBREQnID8gJ2FkZGVkJyA6ICdsZWZ0JywgIiAiKSwgSlNPTi5zdHJpbmdpZnkodXNlckxpc3QpKTsKICB9KTsKICB6Zy5vbigncHVibGlzaGVyU3RhdGVVcGRhdGUnLCBmdW5jdGlvbiAocmVzdWx0KSB7CiAgICAvLyBjb25zb2xlLmxvZygncHVibGlzaGVyU3RhdGVVcGRhdGU6ICcsIHJlc3VsdC5zdHJlYW1JRCwgcmVzdWx0LnN0YXRlKTsKICAgIGlmIChyZXN1bHQuc3RhdGUgPT0gJ1BVQkxJU0hJTkcnKSB7CiAgICAgIGNvbnNvbGUuaW5mbygnIHB1Ymxpc2ggIHN1Y2Nlc3MgJyArIHJlc3VsdC5zdHJlYW1JRCk7CiAgICB9IGVsc2UgaWYgKHJlc3VsdC5zdGF0ZSA9PSAnUFVCTElTSF9SRVFVRVNUSU5HJykgewogICAgICBjb25zb2xlLmluZm8oJyBwdWJsaXNoICByZXRyeScpOwogICAgfSBlbHNlIHsKICAgICAgaWYgKHJlc3VsdC5lcnJvckNvZGUgPT0gMCkgewogICAgICAgIGNvbnNvbGUud2FybigncHVibGlzaCBzdG9wICcgKyByZXN1bHQuZXJyb3JDb2RlKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBjb25zb2xlLmVycm9yKCdwdWJsaXNoIGVycm9yICcgKyByZXN1bHQuZXJyb3JDb2RlKTsKICAgICAgfSAvLyBjb25zdCBfbXNnID0gc3RhdGVJbmZvLmVycm9yLm1zZzsKICAgICAgLy8gaWYgKHN0YXRlSW5mby5lcnJvci5tc2cuaW5kZXhPZiAoJ3NlcnZlciBzZXNzaW9uIGNsb3NlZCwgcmVhc29uOiAnKSA+IC0xKSB7CiAgICAgIC8vICAgICAgICAgY29uc3QgY29kZSA9IHN0YXRlSW5mby5lcnJvci5tc2cucmVwbGFjZSAoJ3NlcnZlciBzZXNzaW9uIGNsb3NlZCwgcmVhc29uOiAnLCAnJyk7CiAgICAgIC8vICAgICAgICAgaWYgKGNvZGUgPT09ICcyMScpIHsKICAgICAgLy8gICAgICAgICAgICAgICAgIF9tc2cgPSAn6Z+z6aKR57yW6Kej56CB5LiN5pSv5oyBKG9wdXMpJzsKICAgICAgLy8gICAgICAgICB9IGVsc2UgaWYgKGNvZGUgPT09ICcyMicpIHsKICAgICAgLy8gICAgICAgICAgICAgICAgIF9tc2cgPSAn6KeG6aKR57yW6Kej56CB5LiN5pSv5oyBKEgyNjQpJwogICAgICAvLyAgICAgICAgIH0gZWxzZSBpZiAoY29kZSA9PT0gJzIwJykgewogICAgICAvLyAgICAgICAgICAgICAgICAgX21zZyA9ICdzZHAg6Kej6YeK6ZSZ6K+vJzsKICAgICAgLy8gICAgICAgICB9CiAgICAgIC8vIH0KICAgICAgLy8gYWxlcnQoJ+aOqOa1geWksei0pSxyZWFzb24gPSAnICsgX21zZyk7CgogICAgfQogIH0pOwogIHpnLm9uKCdwbGF5ZXJTdGF0ZVVwZGF0ZScsIGZ1bmN0aW9uIChyZXN1bHQpIHsKICAgIGNvbnNvbGUubG9nKCdwbGF5ZXJTdGF0ZVVwZGF0ZScsIHJlc3VsdC5zdHJlYW1JRCwgcmVzdWx0LnN0YXRlKTsKCiAgICBpZiAocmVzdWx0LnN0YXRlID09ICdQTEFZSU5HJykgewogICAgICBjb25zb2xlLmluZm8oJyBwbGF5ICBzdWNjZXNzICcgKyByZXN1bHQuc3RyZWFtSUQpOwoKICAgICAgdmFyIF9icm93c2VyID0gZ2V0QnJvd3NlcigpOwoKICAgICAgY29uc29sZS53YXJuKCdicm93c2VyJywgX2Jyb3dzZXIpOwoKICAgICAgaWYgKF9icm93c2VyID09PSAnU2FmYXJpJykgewogICAgICAgIHZhciB2aWRlb3MgPSAkKCcucmVtb3RlVmlkZW8gdmlkZW8nKTsKCiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB2aWRlb3MubGVuZ3RoOyBpKyspIHsKICAgICAgICAgIHZpZGVvc1tpXS5zcmNPYmplY3QgPSB2aWRlb3NbaV0uc3JjT2JqZWN0OwogICAgICAgIH0KICAgICAgfQogICAgfSBlbHNlIGlmIChyZXN1bHQuc3RhdGUgPT0gJ1BMQVlfUkVRVUVTVElORycpIHsKICAgICAgY29uc29sZS5pbmZvKCcgcGxheSAgcmV0cnknKTsKICAgIH0gZWxzZSB7CiAgICAgIGlmIChyZXN1bHQuZXJyb3JDb2RlID09IDApIHsKICAgICAgICBjb25zb2xlLndhcm4oJ3BsYXkgc3RvcCAnICsgcmVzdWx0LmVycm9yQ29kZSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY29uc29sZS5lcnJvcigncGxheSBlcnJvciAnICsgcmVzdWx0LmVycm9yQ29kZSk7CiAgICAgIH0gLy8gY29uc3QgX21zZyA9IHN0YXRlSW5mby5lcnJvci5tc2c7CiAgICAgIC8vIGlmIChzdGF0ZUluZm8uZXJyb3IubXNnLmluZGV4T2YgKCdzZXJ2ZXIgc2Vzc2lvbiBjbG9zZWQsIHJlYXNvbjogJykgPiAtMSkgewogICAgICAvLyAgICAgICAgIGNvbnN0IGNvZGUgPSBzdGF0ZUluZm8uZXJyb3IubXNnLnJlcGxhY2UgKCdzZXJ2ZXIgc2Vzc2lvbiBjbG9zZWQsIHJlYXNvbjogJywgJycpOwogICAgICAvLyAgICAgICAgIGlmIChjb2RlID09PSAnMjEnKSB7CiAgICAgIC8vICAgICAgICAgICAgICAgICBfbXNnID0gJ+mfs+mikee8luino+eggeS4jeaUr+aMgShvcHVzKSc7CiAgICAgIC8vICAgICAgICAgfSBlbHNlIGlmIChjb2RlID09PSAnMjInKSB7CiAgICAgIC8vICAgICAgICAgICAgICAgICBfbXNnID0gJ+inhumikee8luino+eggeS4jeaUr+aMgShIMjY0KScKICAgICAgLy8gICAgICAgICB9IGVsc2UgaWYgKGNvZGUgPT09ICcyMCcpIHsKICAgICAgLy8gICAgICAgICAgICAgICAgIF9tc2cgPSAnc2RwIOino+mHiumUmeivryc7CiAgICAgIC8vICAgICAgICAgfQogICAgICAvLyB9CiAgICAgIC8vIGFsZXJ0KCfmi4nmtYHlpLHotKUscmVhc29uID0gJyArIF9tc2cpOwoKICAgIH0KICB9KTsKICB6Zy5vbignc3RyZWFtRXh0cmFJbmZvVXBkYXRlJywgZnVuY3Rpb24gKHJvb21JRCwgc3RyZWFtTGlzdCkgewogICAgY29uc29sZS53YXJuKCJzdHJlYW1FeHRyYUluZm9VcGRhdGU6IHJvb20gIi5jb25jYXQocm9vbUlELCAiLCAgIiksIEpTT04uc3RyaW5naWZ5KHN0cmVhbUxpc3QpKTsKICB9KTsKICB6Zy5vbigncm9vbVN0cmVhbVVwZGF0ZScsIC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgICB2YXIgX3JlZiA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZShyb29tSUQsIHVwZGF0ZVR5cGUsIHN0cmVhbUxpc3QsIGV4dGVuZGVkRGF0YSkgewogICAgICB2YXIgX2xvb3AsIGksIGssIGo7CgogICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgY29uc29sZS53YXJuKCdyb29tU3RyZWFtVXBkYXRlIDEgcm9vbUlEICcsIHJvb21JRCwgc3RyZWFtTGlzdCwgZXh0ZW5kZWREYXRhKTsgLy8gbGV0IHF1ZXVlID0gW10KCiAgICAgICAgICAgICAgaWYgKCEodXBkYXRlVHlwZSA9PSAnQUREJykpIHsKICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA2OwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBfbG9vcCA9IGZ1bmN0aW9uIF9sb29wKGkpIHsKICAgICAgICAgICAgICAgIGNvbnNvbGUuaW5mbyhzdHJlYW1MaXN0W2ldLnN0cmVhbUlEICsgJyB3YXMgYWRkZWQnKTsKICAgICAgICAgICAgICAgIHZhciByZW1vdGVTdHJlYW0gPSB2b2lkIDA7CiAgICAgICAgICAgICAgICB2YXIgcGxheU9wdGlvbiA9IHt9OwogICAgICAgICAgICAgICAgaWYgKCQoIiN2aWRlb0NvZGVjIikudmFsKCkpIHBsYXlPcHRpb24udmlkZW9Db2RlYyA9ICQoIiN2aWRlb0NvZGVjIikudmFsKCk7CiAgICAgICAgICAgICAgICBpZiAobDMgPT0gdHJ1ZSkgcGxheU9wdGlvbi5yZXNvdXJjZU1vZGUgPSAyOwogICAgICAgICAgICAgICAgemcuc3RhcnRQbGF5aW5nU3RyZWFtKHN0cmVhbUxpc3RbaV0uc3RyZWFtSUQsIHBsYXlPcHRpb24pLnRoZW4oZnVuY3Rpb24gKHN0cmVhbSkgewogICAgICAgICAgICAgICAgICByZW1vdGVTdHJlYW0gPSBzdHJlYW07CiAgICAgICAgICAgICAgICAgIHVzZUxvY2FsU3RyZWFtTGlzdC5wdXNoKHN0cmVhbUxpc3RbaV0pOwogICAgICAgICAgICAgICAgICB2YXIgdmlkZW9UZW1wID0gJCgiPHZpZGVvIGlkPSIuY29uY2F0KHN0cmVhbUxpc3RbaV0uc3RyZWFtSUQsICIgYXV0b3BsYXkgbXV0ZWQgcGxheXNpbmxpbmUgY29udHJvbHM+PC92aWRlbz4iKSk7IC8vcXVldWUucHVzaCh2aWRlb1RlbXApCgogICAgICAgICAgICAgICAgICAkKCcucmVtb3RlVmlkZW8nKS5hcHBlbmQodmlkZW9UZW1wKTsKICAgICAgICAgICAgICAgICAgdmFyIHZpZGVvID0gJCgnLnJlbW90ZVZpZGVvIHZpZGVvOmxhc3QnKVswXTsKICAgICAgICAgICAgICAgICAgY29uc29sZS53YXJuKCd2aWRlbycsIHZpZGVvLCByZW1vdGVTdHJlYW0pOwogICAgICAgICAgICAgICAgICB2aWRlby5zcmNPYmplY3QgPSByZW1vdGVTdHJlYW07CiAgICAgICAgICAgICAgICAgIHZpZGVvLm11dGVkID0gZmFsc2U7IC8vIHZpZGVvVGVtcCA9IG51bGw7CiAgICAgICAgICAgICAgICB9KVsiY2F0Y2giXShmdW5jdGlvbiAoZXJyKSB7CiAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ2VycicsIGVycik7CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICB9OwoKICAgICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgc3RyZWFtTGlzdC5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgICAgX2xvb3AoaSk7CiAgICAgICAgICAgICAgfSAvLyBjb25zdCBpbklwaG9uZSA9IGJyb3dzZXIudmVyc2lvbnMubW9iaWxlICYmIGJyb3dzZXIudmVyc2lvbnMuaW9zCiAgICAgICAgICAgICAgLy8gY29uc3QgaW5TYWZhcmkgPSBicm93c2VyLnZlcnNpb25zLndlYkFwcAogICAgICAgICAgICAgIC8vIGNvbnN0IGluV3ggPSBicm93c2VyLnZlcnNpb25zLndlaXhpbgogICAgICAgICAgICAgIC8vIGlmKHN0cmVhbUxpc3QubGVuZ3RoID4gMSAmJiAoaW5JcGhvbmUgfHwgaW5TYWZhcmkgfHwgaW5XeCkpIHsKICAgICAgICAgICAgICAvLyAgICAgY29uc3QgYWMgPSB6Yy56ZWdvV2ViUlRDLmFjOwogICAgICAgICAgICAgIC8vICAgICBhYy5yZXN1bWUoKTsKICAgICAgICAgICAgICAvLyAgICAgY29uc3QgZ2FpbiA9IGFjLmNyZWF0ZUdhaW4oKTsKICAgICAgICAgICAgICAvLyAgICAgd2hpbGUocXVldWUubGVuZ3RoKSB7CiAgICAgICAgICAgICAgLy8gICAgICAgICBsZXQgdGVtcCA9IHF1ZXVlLnNoaWZ0KCkKICAgICAgICAgICAgICAvLyAgICAgICAgIGlmKHRlbXAuc3JjT2JqZWN0KSB7CiAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgcXVldWUucHVzaChhYy5jcmVhdGVNZWRpYVN0cmVhbVNvdXJjZSh0ZW1wLnNyY09iamVjdCkpCiAgICAgICAgICAgICAgLy8gICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIC8vICAgICAgICAgICAgIHRlbXAuY29ubmVjdChnYWluKQogICAgICAgICAgICAgIC8vICAgICAgICAgfQogICAgICAgICAgICAgIC8vICAgICB9CiAgICAgICAgICAgICAgLy8gICAgIGdhaW4uY29ubmVjdChhYy5kZXN0aW5hdGlvbik7CiAgICAgICAgICAgICAgLy8gfQoKCiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDIzOwogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSA2OgogICAgICAgICAgICAgIGlmICghKHVwZGF0ZVR5cGUgPT0gJ0RFTEVURScpKSB7CiAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMjM7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGsgPSAwOwoKICAgICAgICAgICAgY2FzZSA4OgogICAgICAgICAgICAgIGlmICghKGsgPCB1c2VMb2NhbFN0cmVhbUxpc3QubGVuZ3RoKSkgewogICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDIzOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBqID0gMDsKCiAgICAgICAgICAgIGNhc2UgMTA6CiAgICAgICAgICAgICAgaWYgKCEoaiA8IHN0cmVhbUxpc3QubGVuZ3RoKSkgewogICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDIwOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBpZiAoISh1c2VMb2NhbFN0cmVhbUxpc3Rba10uc3RyZWFtSUQgPT09IHN0cmVhbUxpc3Rbal0uc3RyZWFtSUQpKSB7CiAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMTc7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICB6Zy5zdG9wUGxheWluZ1N0cmVhbSh1c2VMb2NhbFN0cmVhbUxpc3Rba10uc3RyZWFtSUQpOwogICAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGVycm9yKTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGNvbnNvbGUuaW5mbyh1c2VMb2NhbFN0cmVhbUxpc3Rba10uc3RyZWFtSUQgKyAnd2FzIGRldmFyZWQnKTsKICAgICAgICAgICAgICAkKCcucmVtb3RlVmlkZW8gdmlkZW86ZXEoJyArIGsgKyAnKScpLnJlbW92ZSgpOwogICAgICAgICAgICAgIHVzZUxvY2FsU3RyZWFtTGlzdC5zcGxpY2Uoay0tLCAxKTsKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KCJicmVhayIsIDIwKTsKCiAgICAgICAgICAgIGNhc2UgMTc6CiAgICAgICAgICAgICAgaisrOwogICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAxMDsKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgMjA6CiAgICAgICAgICAgICAgaysrOwogICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA4OwogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSAyMzoKICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwgX2NhbGxlZSk7CiAgICB9KSk7CgogICAgcmV0dXJuIGZ1bmN0aW9uIChfeDIsIF94MywgX3g0LCBfeDUpIHsKICAgICAgcmV0dXJuIF9yZWYuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgIH07CiAgfSgpKTsKICB6Zy5vbigncGxheVF1YWxpdHlVcGRhdGUnLCAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkgewogICAgdmFyIF9yZWYyID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMihzdHJlYW1JRCwgc3RyZWFtUXVhbGl0eSkgewogICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTIkKF9jb250ZXh0MikgewogICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0Mi5wcmV2ID0gX2NvbnRleHQyLm5leHQpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIGNvbnNvbGUubG9nKCJwbGF5IyIuY29uY2F0KHN0cmVhbUlELCAiIHZpZGVvRlBTOiAiKS5jb25jYXQoc3RyZWFtUXVhbGl0eS52aWRlby52aWRlb0ZQUywgIiB2aWRlb0JpdHJhdGU6ICIpLmNvbmNhdChzdHJlYW1RdWFsaXR5LnZpZGVvLnZpZGVvQml0cmF0ZSwgIiBhdWRpb0JpdHJhdGU6ICIpLmNvbmNhdChzdHJlYW1RdWFsaXR5LmF1ZGlvLmF1ZGlvQml0cmF0ZSwgIiBhdWRpb0ZQUzogIikuY29uY2F0KHN0cmVhbVF1YWxpdHkuYXVkaW8uYXVkaW9GUFMpKTsKICAgICAgICAgICAgICBjb25zb2xlLmxvZygicGxheSMiLmNvbmNhdChzdHJlYW1JRCksIHN0cmVhbVF1YWxpdHkpOwoKICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuc3RvcCgpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwgX2NhbGxlZTIpOwogICAgfSkpOwoKICAgIHJldHVybiBmdW5jdGlvbiAoX3g2LCBfeDcpIHsKICAgICAgcmV0dXJuIF9yZWYyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICB9OwogIH0oKSk7CiAgemcub24oJ3B1Ymxpc2hRdWFsaXR5VXBkYXRlJywgLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHsKICAgIHZhciBfcmVmMyA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTMoc3RyZWFtSUQsIHN0cmVhbVF1YWxpdHkpIHsKICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUzJChfY29udGV4dDMpIHsKICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgc3dpdGNoIChfY29udGV4dDMucHJldiA9IF9jb250ZXh0My5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBjb25zb2xlLmxvZygicHVibGlzaCMiLmNvbmNhdChzdHJlYW1JRCwgIiB2aWRlb0ZQUzogIikuY29uY2F0KHN0cmVhbVF1YWxpdHkudmlkZW8udmlkZW9GUFMsICIgdmlkZW9CaXRyYXRlOiAiKS5jb25jYXQoc3RyZWFtUXVhbGl0eS52aWRlby52aWRlb0JpdHJhdGUsICIgYXVkaW9CaXRyYXRlOiAiKS5jb25jYXQoc3RyZWFtUXVhbGl0eS5hdWRpby5hdWRpb0JpdHJhdGUsICIgYXVkaW9GUFM6ICIpLmNvbmNhdChzdHJlYW1RdWFsaXR5LmF1ZGlvLmF1ZGlvRlBTKSk7CiAgICAgICAgICAgICAgY29uc29sZS5sb2coInB1Ymxpc2gjIi5jb25jYXQoc3RyZWFtSUQpLCBzdHJlYW1RdWFsaXR5KTsKCiAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzLnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sIF9jYWxsZWUzKTsKICAgIH0pKTsKCiAgICByZXR1cm4gZnVuY3Rpb24gKF94OCwgX3g5KSB7CiAgICAgIHJldHVybiBfcmVmMy5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgfTsKICB9KCkpOwogIHpnLm9uKCdyZW1vdGVDYW1lcmFTdGF0dXNVcGRhdGUnLCBmdW5jdGlvbiAoc3RyZWFtSUQsIHN0YXR1cykgewogICAgY29uc29sZS53YXJuKCJyZW1vdGVDYW1lcmFTdGF0dXNVcGRhdGUgIi5jb25jYXQoc3RyZWFtSUQsICIgY2FtZXJhIHN0YXR1cyAiKS5jb25jYXQoc3RhdHVzID09ICdPUEVOJyA/ICdvcGVuJyA6ICdjbG9zZScpKTsKICB9KTsKICB6Zy5vbigncmVtb3RlTWljU3RhdHVzVXBkYXRlJywgZnVuY3Rpb24gKHN0cmVhbUlELCBzdGF0dXMpIHsKICAgIGNvbnNvbGUud2FybigicmVtb3RlTWljU3RhdHVzVXBkYXRlICIuY29uY2F0KHN0cmVhbUlELCAiIG1pY3JvIHN0YXR1cyAiKS5jb25jYXQoc3RhdHVzID09ICdPUEVOJyA/ICdvcGVuJyA6ICdjbG9zZScpKTsKICB9KTsKICB6Zy5vbignc291bmRMZXZlbFVwZGF0ZScsIGZ1bmN0aW9uIChzdHJlYW1MaXN0KSB7CiAgICBzdHJlYW1MaXN0LmZvckVhY2goZnVuY3Rpb24gKHN0cmVhbSkgewogICAgICBzdHJlYW0udHlwZSA9PSAncHVzaCcgJiYgJCgnI3NvdW5kTGV2ZWwnKS5odG1sKE1hdGgucm91bmQoc3RyZWFtLnNvdW5kTGV2ZWwpICsgJycpOwogICAgICBjb25zb2xlLndhcm4oIiIuY29uY2F0KHN0cmVhbS50eXBlLCAiICIpLmNvbmNhdChzdHJlYW0uc3RyZWFtSUQsICIsIHNvdW5kTGV2ZWw6ICIpLmNvbmNhdChzdHJlYW0uc291bmRMZXZlbCkpOwogICAgfSk7CiAgfSk7CiAgemcub24oJ2RldmljZUVycm9yJywgZnVuY3Rpb24gKGVycm9yQ29kZSwgZGV2aWNlTmFtZSkgewogICAgY29uc29sZS53YXJuKCJkZXZpY2VFcnJvciIsIGVycm9yQ29kZSwgZGV2aWNlTmFtZSk7CiAgfSk7CiAgemcub24oJ3ZpZGVvRGV2aWNlU3RhdGVDaGFuZ2VkJywgZnVuY3Rpb24gKHVwZGF0ZVR5cGUsIGRldmljZSkgewogICAgY29uc29sZS53YXJuKCJ2aWRlb0RldmljZVN0YXRlQ2hhbmdlZCIsIGRldmljZSwgdXBkYXRlVHlwZSk7CiAgfSk7CiAgemcub24oJ2F1ZGlvRGV2aWNlU3RhdGVDaGFuZ2VkJywgZnVuY3Rpb24gKHVwZGF0ZVR5cGUsIGRldmljZVR5cGUsIGRldmljZSkgewogICAgY29uc29sZS53YXJuKCJhdWRpb0RldmljZVN0YXRlQ2hhbmdlZCIsIGRldmljZSwgdXBkYXRlVHlwZSwgZGV2aWNlVHlwZSk7CiAgfSk7CiAgemcub24oJ3Jvb21PbmxpbmVVc2VyQ291bnRVcGRhdGUnLCBmdW5jdGlvbiAocm9vbUlELCBjb3VudCkgewogICAgY29uc29sZS53YXJuKCJyb29tT25saW5lVXNlckNvdW50VXBkYXRlICIuY29uY2F0KHJvb21JRCwgIiAiKS5jb25jYXQoY291bnQpKTsKICB9KTsKfQoKZnVuY3Rpb24gbG9naW4oX3gxMCkgewogIHJldHVybiBfbG9naW4uYXBwbHkodGhpcywgYXJndW1lbnRzKTsKfQoKZnVuY3Rpb24gX2xvZ2luKCkgewogIF9sb2dpbiA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTEwKHJvb21JZCkgewogICAgdmFyIHRva2VuOwogICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUxMCQoX2NvbnRleHQxMCkgewogICAgICB3aGlsZSAoMSkgewogICAgICAgIHN3aXRjaCAoX2NvbnRleHQxMC5wcmV2ID0gX2NvbnRleHQxMC5uZXh0KSB7CiAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgIC8vIOiOt+WPlnRva2Vu6ZyA6KaB5a6i5oi36Ieq5bex5a6e546w77yMdG9rZW7mmK/lr7nnmbvlvZXmiL/pl7TnmoTllK/kuIDpqozor4EKICAgICAgICAgICAgLy8gT2J0YWluaW5nIGEgdG9rZW4gbmVlZHMgdG8gYmUgaW1wbGVtZW50ZWQgYnkgdGhlIGN1c3RvbWVyLiBUaGUgdG9rZW4gaXMgdGhlIG9ubHkgdmVyaWZpY2F0aW9uIGZvciB0aGUgbG9naW4gcm9vbS4KICAgICAgICAgICAgdG9rZW4gPSAnJzsgLy/mtYvor5XnlKjvvIzlvIDlj5HogIXor7flv73nlaUKICAgICAgICAgICAgLy9UZXN0IGNvZGUsIGRldmVsb3BlcnMgcGxlYXNlIGlnbm9yZQoKICAgICAgICAgICAgaWYgKCFjZ2lUb2tlbikgewogICAgICAgICAgICAgIF9jb250ZXh0MTAubmV4dCA9IDc7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIF9jb250ZXh0MTAubmV4dCA9IDQ7CiAgICAgICAgICAgIHJldHVybiAkLmdldCh0b2tlblVybCwgewogICAgICAgICAgICAgIGFwcF9pZDogYXBwSUQsCiAgICAgICAgICAgICAgaWRfbmFtZTogdXNlcklELAogICAgICAgICAgICAgIGNnaV90b2tlbjogY2dpVG9rZW4KICAgICAgICAgICAgfSk7CgogICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICB0b2tlbiA9IF9jb250ZXh0MTAuc2VudDsKICAgICAgICAgICAgX2NvbnRleHQxMC5uZXh0ID0gMTA7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgNzoKICAgICAgICAgICAgX2NvbnRleHQxMC5uZXh0ID0gOTsKICAgICAgICAgICAgcmV0dXJuICQuZ2V0KCdodHRwczovL3dzbGl2ZXJvb20tYWxwaGEuemVnby5pbTo4MjgyL3Rva2VuJywgewogICAgICAgICAgICAgIGFwcF9pZDogYXBwSUQsCiAgICAgICAgICAgICAgaWRfbmFtZTogdXNlcklECiAgICAgICAgICAgIH0pOwoKICAgICAgICAgIGNhc2UgOToKICAgICAgICAgICAgdG9rZW4gPSBfY29udGV4dDEwLnNlbnQ7CgogICAgICAgICAgY2FzZSAxMDoKICAgICAgICAgICAgX2NvbnRleHQxMC5uZXh0ID0gMTI7CiAgICAgICAgICAgIHJldHVybiB6Zy5sb2dpblJvb20ocm9vbUlkLCB0b2tlbiwgewogICAgICAgICAgICAgIHVzZXJJRDogdXNlcklELAogICAgICAgICAgICAgIHVzZXJOYW1lOiB1c2VyTmFtZQogICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgdXNlclVwZGF0ZTogdHJ1ZQogICAgICAgICAgICB9KTsKCiAgICAgICAgICBjYXNlIDEyOgogICAgICAgICAgICByb29tTGlzdC5wdXNoKHJvb21JZCk7CiAgICAgICAgICAgIHJldHVybiBfY29udGV4dDEwLmFicnVwdCgicmV0dXJuIiwgdHJ1ZSk7CgogICAgICAgICAgY2FzZSAxNDoKICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgIHJldHVybiBfY29udGV4dDEwLnN0b3AoKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sIF9jYWxsZWUxMCk7CiAgfSkpOwogIHJldHVybiBfbG9naW4uYXBwbHkodGhpcywgYXJndW1lbnRzKTsKfQoKZnVuY3Rpb24gZW50ZXJSb29tKCkgewogIHJldHVybiBfZW50ZXJSb29tLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7Cn0KCmZ1bmN0aW9uIF9lbnRlclJvb20oKSB7CiAgX2VudGVyUm9vbSA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTExKCkgewogICAgdmFyIHJvb21JZDsKICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMTEkKF9jb250ZXh0MTEpIHsKICAgICAgd2hpbGUgKDEpIHsKICAgICAgICBzd2l0Y2ggKF9jb250ZXh0MTEucHJldiA9IF9jb250ZXh0MTEubmV4dCkgewogICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAvLyBjb25zdCByb29tSWQgPSAkKCcjcm9vbUlkJykudmFsKCk7CiAgICAgICAgICAgIHJvb21JZCA9ICIxMTEiOwoKICAgICAgICAgICAgaWYgKHJvb21JZCkgewogICAgICAgICAgICAgIF9jb250ZXh0MTEubmV4dCA9IDQ7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGFsZXJ0KCdyb29tSWQgaXMgZW1wdHknKTsKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTEuYWJydXB0KCJyZXR1cm4iLCBmYWxzZSk7CgogICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICBfY29udGV4dDExLm5leHQgPSA2OwogICAgICAgICAgICByZXR1cm4gbG9naW4ocm9vbUlkKTsKCiAgICAgICAgICBjYXNlIDY6CiAgICAgICAgICAgIGxvZ2luUm9vbSA9IHRydWU7IC8vIGNvbnNvbGUud2FybigncmVtb3RlVmlkZW8nKQogICAgICAgICAgICAvLyAkKCcucmVtb3RlVmlkZW8nKS5odG1sKCcnKTsKCiAgICAgICAgICAgIHJldHVybiBfY29udGV4dDExLmFicnVwdCgicmV0dXJuIiwgdHJ1ZSk7CgogICAgICAgICAgY2FzZSA4OgogICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTEuc3RvcCgpOwogICAgICAgIH0KICAgICAgfQogICAgfSwgX2NhbGxlZTExKTsKICB9KSk7CiAgcmV0dXJuIF9lbnRlclJvb20uYXBwbHkodGhpcywgYXJndW1lbnRzKTsKfQoKZnVuY3Rpb24gbG9nb3V0KCkgewogIHJldHVybiBfbG9nb3V0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7Cn0KCmZ1bmN0aW9uIF9sb2dvdXQoKSB7CiAgX2xvZ291dCA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTEyKCkgewogICAgdmFyIHJvb21JZCwgaTsKICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMTIkKF9jb250ZXh0MTIpIHsKICAgICAgd2hpbGUgKDEpIHsKICAgICAgICBzd2l0Y2ggKF9jb250ZXh0MTIucHJldiA9IF9jb250ZXh0MTIubmV4dCkgewogICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICBjb25zb2xlLmluZm8oJ2xlYXZlIHJvb20gIGFuZCBjbG9zZSBzdHJlYW0nKTsKICAgICAgICAgICAgcm9vbUlkID0gJCgnI3Jvb21JZCcpLnZhbCgpOyAvLyDlgZzmraLmi4nmtYEKICAgICAgICAgICAgLy8gc3RvcCBwbGF5aW5nCgogICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgdXNlTG9jYWxTdHJlYW1MaXN0Lmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAgdXNlTG9jYWxTdHJlYW1MaXN0W2ldLnN0cmVhbUlEICYmIHpnLnN0b3BQbGF5aW5nU3RyZWFtKHVzZUxvY2FsU3RyZWFtTGlzdFtpXS5zdHJlYW1JRCk7CiAgICAgICAgICAgIH0gLy8g5riF56m66aG16Z2iCiAgICAgICAgICAgIC8vIENsZWFyIHBhZ2UKCgogICAgICAgICAgICB1c2VMb2NhbFN0cmVhbUxpc3QgPSBbXTsgLy8gd2luZG93LnVzZUxvY2FsU3RyZWFtTGlzdCA9IFtdOwoKICAgICAgICAgICAgcm9vbUxpc3Quc3BsaWNlKHJvb21MaXN0LmZpbmRJbmRleChmdW5jdGlvbiAocm9vbSkgewogICAgICAgICAgICAgIHJldHVybiByb29tID09IHJvb21JZDsKICAgICAgICAgICAgfSksIDEpOwoKICAgICAgICAgICAgaWYgKHByZXZpZXdWaWRlby5zcmNPYmplY3QgJiYgaXNQcmV2aWV3ZWQgJiYgKCFyb29tSWQgfHwgcm9vbUxpc3QubGVuZ3RoID09IDApKSB7CiAgICAgICAgICAgICAgcHJldmlld1ZpZGVvLnNyY09iamVjdCA9IG51bGw7CiAgICAgICAgICAgICAgemcuc3RvcFB1Ymxpc2hpbmdTdHJlYW0ocHVibGlzaFN0cmVhbUlkKTsKICAgICAgICAgICAgICB6Zy5kZXN0cm95U3RyZWFtKGxvY2FsU3RyZWFtKTsKICAgICAgICAgICAgICBpc1ByZXZpZXdlZCA9IGZhbHNlOwogICAgICAgICAgICAgICEkKCcuc291bmQnKS5oYXNDbGFzcygnZC1ub25lJykgJiYgJCgnLnNvdW5kJykuYWRkQ2xhc3MoJ2Qtbm9uZScpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoIXJvb21JZCB8fCByb29tTGlzdC5sZW5ndGggPT0gMCkgewogICAgICAgICAgICAgICQoJy5yZW1vdGVWaWRlbycpLmh0bWwoJycpOwogICAgICAgICAgICAgICQoJyNtZW1iZXJMaXN0JykuaHRtbCgnJyk7CiAgICAgICAgICAgIH0gLy/pgIDlh7rnmbvlvZUKICAgICAgICAgICAgLy9sb2dvdXQKCgogICAgICAgICAgICB6Zy5sb2dvdXRSb29tKHJvb21JZCk7CiAgICAgICAgICAgIGxvZ2luUm9vbSA9IGZhbHNlOwoKICAgICAgICAgIGNhc2UgOToKICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgIHJldHVybiBfY29udGV4dDEyLnN0b3AoKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sIF9jYWxsZWUxMik7CiAgfSkpOwogIHJldHVybiBfbG9nb3V0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7Cn0KCmZ1bmN0aW9uIHB1Ymxpc2goX3gxMSwgX3gxMikgewogIHJldHVybiBfcHVibGlzaC5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwp9CgpmdW5jdGlvbiBfcHVibGlzaCgpIHsKICBfcHVibGlzaCA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTEzKGNvbnN0cmFpbnRzLCBpc05ldykgewogICAgdmFyIHZpZGVvLCBfY29uc3RyYWludHMsIHBsYXlUeXBlOwoKICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMTMkKF9jb250ZXh0MTMpIHsKICAgICAgd2hpbGUgKDEpIHsKICAgICAgICBzd2l0Y2ggKF9jb250ZXh0MTMucHJldiA9IF9jb250ZXh0MTMubmV4dCkgewogICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICBjb25zb2xlLndhcm4oJ2NyZWF0ZVN0cmVhbScsICQoJyNhdWRpb0xpc3QnKS52YWwoKSwgJCgnI3ZpZGVvTGlzdCcpLnZhbCgpKTsKICAgICAgICAgICAgY29uc29sZS53YXJuKCdjb25zdHJhaW50cycsIGNvbnN0cmFpbnRzKTsKICAgICAgICAgICAgdmlkZW8gPSBjb25zdHJhaW50cyAmJiBjb25zdHJhaW50cy5jYW1lcmEgJiYgdHlwZW9mIGNvbnN0cmFpbnRzLmNhbWVyYS52aWRlbyA9PT0gJ2Jvb2xlYW4nID8gY29uc3RyYWludHMuY2FtZXJhLnZpZGVvIDogdW5kZWZpbmVkOwogICAgICAgICAgICBfY29uc3RyYWludHMgPSB7CiAgICAgICAgICAgICAgY2FtZXJhOiB7CiAgICAgICAgICAgICAgICBhdWRpb0lucHV0OiAkKCcjYXVkaW9MaXN0JykudmFsKCksCiAgICAgICAgICAgICAgICB2aWRlb0lucHV0OiAkKCcjdmlkZW9MaXN0JykudmFsKCksCiAgICAgICAgICAgICAgICB2aWRlbzogdmlkZW8gIT09IHVuZGVmaW5lZCA/IHZpZGVvIDogJCgnI3ZpZGVvTGlzdCcpLnZhbCgpID09PSAnMCcgPyBmYWxzZSA6IHRydWUsCiAgICAgICAgICAgICAgICBhdWRpbzogJCgnI2F1ZGlvTGlzdCcpLnZhbCgpID09PSAnMCcgPyBmYWxzZSA6IHRydWUgLy8gY2hhbm5lbENvdW50OiBjb25zdHJhaW50cyAmJiBjb25zdHJhaW50cy5jYW1lcmEgJiYgY29uc3RyYWludHMuY2FtZXJhLmNoYW5uZWxDb3VudCwKCiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9OwogICAgICAgICAgICBjb25zdHJhaW50cyAmJiBjb25zdHJhaW50cy5jYW1lcmEgJiYgT2JqZWN0LmFzc2lnbihfY29uc3RyYWludHMuY2FtZXJhLCBjb25zdHJhaW50cy5jYW1lcmEpOwogICAgICAgICAgICAhX2NvbnN0cmFpbnRzLmNhbWVyYS52aWRlbyAmJiAocHJldmlld1ZpZGVvLmNvbnRyb2xzID0gZmFsc2UpOwogICAgICAgICAgICBwbGF5VHlwZSA9IF9jb25zdHJhaW50cy5jYW1lcmEuYXVkaW8gPT09IGZhbHNlID8gJ1ZpZGVvJyA6IF9jb25zdHJhaW50cy5jYW1lcmEudmlkZW8gPT09IGZhbHNlID8gJ0F1ZGlvJyA6ICdhbGwnOwogICAgICAgICAgICBwdWJsaXNoVHlwZSA9IHBsYXlUeXBlOyAvLyBjb25zb2xlLmVycm9yKCdwbGF5VHlwZScsIHBsYXlUeXBlKTsKCiAgICAgICAgICAgIHB1c2goX2NvbnN0cmFpbnRzLCB7CiAgICAgICAgICAgICAgZXh0cmFJbmZvOiBKU09OLnN0cmluZ2lmeSh7CiAgICAgICAgICAgICAgICBwbGF5VHlwZTogcGxheVR5cGUKICAgICAgICAgICAgICB9KQogICAgICAgICAgICB9LCBpc05ldyk7CgogICAgICAgICAgY2FzZSA5OgogICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTMuc3RvcCgpOwogICAgICAgIH0KICAgICAgfQogICAgfSwgX2NhbGxlZTEzKTsKICB9KSk7CiAgcmV0dXJuIF9wdWJsaXNoLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7Cn0KCmZ1bmN0aW9uIHB1c2goX3gxMykgewogIHJldHVybiBfcHVzaC5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwp9CgpmdW5jdGlvbiBfcHVzaCgpIHsKICBfcHVzaCA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTE0KGNvbnN0cmFpbnRzKSB7CiAgICB2YXIgcHVibGlzaE9wdGlvbiwKICAgICAgICBpc05ldywKICAgICAgICByZXN1bHQsCiAgICAgICAgX2FyZ3MxNCA9IGFyZ3VtZW50czsKICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMTQkKF9jb250ZXh0MTQpIHsKICAgICAgd2hpbGUgKDEpIHsKICAgICAgICBzd2l0Y2ggKF9jb250ZXh0MTQucHJldiA9IF9jb250ZXh0MTQubmV4dCkgewogICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICBwdWJsaXNoT3B0aW9uID0gX2FyZ3MxNC5sZW5ndGggPiAxICYmIF9hcmdzMTRbMV0gIT09IHVuZGVmaW5lZCA/IF9hcmdzMTRbMV0gOiB7fTsKICAgICAgICAgICAgaXNOZXcgPSBfYXJnczE0Lmxlbmd0aCA+IDIgPyBfYXJnczE0WzJdIDogdW5kZWZpbmVkOwogICAgICAgICAgICBfY29udGV4dDE0LnByZXYgPSAyOwoKICAgICAgICAgICAgaWYgKGxvY2FsU3RyZWFtKSB7CiAgICAgICAgICAgICAgemcuZGVzdHJveVN0cmVhbShsb2NhbFN0cmVhbSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIF9jb250ZXh0MTQubmV4dCA9IDY7CiAgICAgICAgICAgIHJldHVybiB6Zy5jcmVhdGVTdHJlYW0oY29uc3RyYWludHMpOwoKICAgICAgICAgIGNhc2UgNjoKICAgICAgICAgICAgbG9jYWxTdHJlYW0gPSBfY29udGV4dDE0LnNlbnQ7CiAgICAgICAgICAgIC8vIHZhciBBdWRpb0NvbnRleHQgPSB3aW5kb3cuQXVkaW9Db250ZXh0IHx8IHdpbmRvdy53ZWJraXRBdWRpb0NvbnRleHQ7IC8vIOWFvOWuueaApwogICAgICAgICAgICAvLyBsZXQgbG9jYWxUcmFjaz0gbG9jYWxTdHJlYW0uZ2V0QXVkaW9UcmFja3MoKVswXTsKICAgICAgICAgICAgLy8gbGV0IGF1ZGlvQ29udGV4dCA9IG5ldyBBdWRpb0NvbnRleHQoKTsvLyDliJvlu7pBdWRpb+S4iuS4i+aWhwogICAgICAgICAgICAvLyBsZXQgbWVkaWFTdHJlYW1Tb3VyY2UgPSBhdWRpb0NvbnRleHQuY3JlYXRlTWVkaWFTdHJlYW1Tb3VyY2UobG9jYWxTdHJlYW0pOwogICAgICAgICAgICAvLyBsZXQgZGVzdGluYXRpb24gPSBhdWRpb0NvbnRleHQuY3JlYXRlTWVkaWFTdHJlYW1EZXN0aW5hdGlvbigpOwogICAgICAgICAgICAvLyBsZXQgZ2Fpbk5vZGUgPSBhdWRpb0NvbnRleHQuY3JlYXRlR2FpbigpOwogICAgICAgICAgICAvLyBtZWRpYVN0cmVhbVNvdXJjZS5jb25uZWN0KGdhaW5Ob2RlKTsKICAgICAgICAgICAgLy8gZ2Fpbk5vZGUuY29ubmVjdChkZXN0aW5hdGlvbik7CiAgICAgICAgICAgIC8vIGdhaW5Ob2RlLmdhaW4udmFsdWU9MzsKICAgICAgICAgICAgLy8gbGV0IGF1ZGlvVHJhY2sgPSBkZXN0aW5hdGlvbi5zdHJlYW0uZ2V0QXVkaW9UcmFja3MoKVswXTsKICAgICAgICAgICAgLy8gbG9jYWxTdHJlYW0ucmVtb3ZlVHJhY2sobG9jYWxUcmFjayk7CiAgICAgICAgICAgIC8vIGxvY2FsU3RyZWFtLmFkZFRyYWNrKGF1ZGlvVHJhY2spOwogICAgICAgICAgICBwcmV2aWV3VmlkZW8uc3JjT2JqZWN0ID0gbG9jYWxTdHJlYW07CiAgICAgICAgICAgIGlzUHJldmlld2VkID0gdHJ1ZTsKICAgICAgICAgICAgJCgnLnNvdW5kJykuaGFzQ2xhc3MoJ2Qtbm9uZScpICYmICQoJy5zb3VuZCcpLnJlbW92ZUNsYXNzKCdkLW5vbmUnKTsKICAgICAgICAgICAgaXNOZXcgJiYgKHB1Ymxpc2hTdHJlYW1JZCA9ICd3ZWJydGMnICsgbmV3IERhdGUoKS5nZXRUaW1lKCkpOwogICAgICAgICAgICBpZiAoJCgiI3ZpZGVvQ29kZWMiKS52YWwoKSkgcHVibGlzaE9wdGlvbi52aWRlb0NvZGVjID0gJCgiI3ZpZGVvQ29kZWMiKS52YWwoKTsKICAgICAgICAgICAgaWYgKCQoJyNyb29tSWQnKS52YWwoKSkgcHVibGlzaE9wdGlvbi5yb29tSUQgPSAkKCcjcm9vbUlkJykudmFsKCk7CiAgICAgICAgICAgIHJlc3VsdCA9IHpnLnN0YXJ0UHVibGlzaGluZ1N0cmVhbShwdWJsaXNoU3RyZWFtSWQsIGxvY2FsU3RyZWFtLCBwdWJsaXNoT3B0aW9uKTsKICAgICAgICAgICAgY29uc29sZS5sb2coJ3B1Ymxpc2ggc3RyZWFtJyArIHB1Ymxpc2hTdHJlYW1JZCwgcmVzdWx0KTsKICAgICAgICAgICAgX2NvbnRleHQxNC5uZXh0ID0gMjA7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgMTc6CiAgICAgICAgICAgIF9jb250ZXh0MTQucHJldiA9IDE3OwogICAgICAgICAgICBfY29udGV4dDE0LnQwID0gX2NvbnRleHQxNFsiY2F0Y2giXSgyKTsKCiAgICAgICAgICAgIGlmIChfY29udGV4dDE0LnQwLm5hbWUpIHsKICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdjcmVhdGVTdHJlYW0nLCBfY29udGV4dDE0LnQwLm5hbWUsIF9jb250ZXh0MTQudDAubWVzc2FnZSk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignY3JlYXRlU3RyZWFtIGVycm9yJywgX2NvbnRleHQxNC50MCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICBjYXNlIDIwOgogICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTQuc3RvcCgpOwogICAgICAgIH0KICAgICAgfQogICAgfSwgX2NhbGxlZTE0LCBudWxsLCBbWzIsIDE3XV0pOwogIH0pKTsKICByZXR1cm4gX3B1c2guYXBwbHkodGhpcywgYXJndW1lbnRzKTsKfQoKJCgnI3RvZ2dsZUNhbWVyYScpLmNsaWNrKGZ1bmN0aW9uICgpIHsKICB6Zy5tdXRlUHVibGlzaFN0cmVhbVZpZGVvKHByZXZpZXdWaWRlby5zcmNPYmplY3QsICEkKHRoaXMpLmhhc0NsYXNzKCdkaXNhYmxlZCcpKTsKICAkKHRoaXMpLnRvZ2dsZUNsYXNzKCdkaXNhYmxlZCcpOwp9KTsKJCgnI3RvZ2dsZVNwZWFrZXInKS5jbGljayhmdW5jdGlvbiAoKSB7CiAgemcubXV0ZVB1Ymxpc2hTdHJlYW1BdWRpbyhwcmV2aWV3VmlkZW8uc3JjT2JqZWN0LCAhJCh0aGlzKS5oYXNDbGFzcygnZGlzYWJsZWQnKSk7CiAgJCh0aGlzKS50b2dnbGVDbGFzcygnZGlzYWJsZWQnKTsKfSk7CiQoJyNlbnRlclJvb20nKS5jbGljayggLyojX19QVVJFX18qL19hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTQoKSB7CiAgdmFyIGxvZ2luU3VjOwogIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlNCQoX2NvbnRleHQ0KSB7CiAgICB3aGlsZSAoMSkgewogICAgICBzd2l0Y2ggKF9jb250ZXh0NC5wcmV2ID0gX2NvbnRleHQ0Lm5leHQpIHsKICAgICAgICBjYXNlIDA6CiAgICAgICAgICBsb2dpblN1YyA9IGZhbHNlOwogICAgICAgICAgX2NvbnRleHQ0LnByZXYgPSAxOwogICAgICAgICAgX2NvbnRleHQ0Lm5leHQgPSA0OwogICAgICAgICAgcmV0dXJuIGVudGVyUm9vbSgpOwoKICAgICAgICBjYXNlIDQ6CiAgICAgICAgICBsb2dpblN1YyA9IF9jb250ZXh0NC5zZW50OwoKICAgICAgICAgIGlmICghbG9naW5TdWMpIHsKICAgICAgICAgICAgX2NvbnRleHQ0Lm5leHQgPSAxMzsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKGxvY2FsU3RyZWFtKSB7CiAgICAgICAgICAgIHpnLmRlc3Ryb3lTdHJlYW0obG9jYWxTdHJlYW0pOwogICAgICAgICAgfQoKICAgICAgICAgIF9jb250ZXh0NC5uZXh0ID0gOTsKICAgICAgICAgIHJldHVybiB6Zy5jcmVhdGVTdHJlYW0oewogICAgICAgICAgICBjYW1lcmE6IHsKICAgICAgICAgICAgICBhdWRpb0lucHV0OiAkKCcjYXVkaW9MaXN0JykudmFsKCksCiAgICAgICAgICAgICAgdmlkZW9JbnB1dDogJCgnI3ZpZGVvTGlzdCcpLnZhbCgpLAogICAgICAgICAgICAgIHZpZGVvOiAkKCcjdmlkZW9MaXN0JykudmFsKCkgPT09ICcwJyA/IGZhbHNlIDogdHJ1ZSwKICAgICAgICAgICAgICBhdWRpbzogJCgnI2F1ZGlvTGlzdCcpLnZhbCgpID09PSAnMCcgPyBmYWxzZSA6IHRydWUKICAgICAgICAgICAgfQogICAgICAgICAgfSk7CgogICAgICAgIGNhc2UgOToKICAgICAgICAgIGxvY2FsU3RyZWFtID0gX2NvbnRleHQ0LnNlbnQ7CiAgICAgICAgICBwcmV2aWV3VmlkZW8uc3JjT2JqZWN0ID0gbG9jYWxTdHJlYW07CiAgICAgICAgICBpc1ByZXZpZXdlZCA9IHRydWU7CiAgICAgICAgICAkKCcjdmlkZW9MaXN0JykudmFsKCkgPT09ICcwJyAmJiAocHJldmlld1ZpZGVvLmNvbnRyb2xzID0gdHJ1ZSk7CgogICAgICAgIGNhc2UgMTM6CiAgICAgICAgICBfY29udGV4dDQubmV4dCA9IDE4OwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgMTU6CiAgICAgICAgICBfY29udGV4dDQucHJldiA9IDE1OwogICAgICAgICAgX2NvbnRleHQ0LnQwID0gX2NvbnRleHQ0WyJjYXRjaCJdKDEpOwogICAgICAgICAgY29uc29sZS5lcnJvcihfY29udGV4dDQudDApOwoKICAgICAgICBjYXNlIDE4OgogICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICByZXR1cm4gX2NvbnRleHQ0LnN0b3AoKTsKICAgICAgfQogICAgfQogIH0sIF9jYWxsZWU0LCBudWxsLCBbWzEsIDE1XV0pOwp9KSkpOwpleHBvcnQgeyB6ZywgYXBwSUQsIHB1Ymxpc2hTdHJlYW1JZCwgY2hlY2tBblJ1biwgc3VwcG9ydFNjcmVlblNoYXJpbmcsIHVzZXJJRCwgdXNlTG9jYWxTdHJlYW1MaXN0LCBsb2dvdXQsIGVudGVyUm9vbSwgcHVzaCwgcHVibGlzaCwgcHJldmlld1ZpZGVvLCBpc1ByZXZpZXdlZCwgbG9naW5Sb29tLCBwdWJsaXNoVHlwZSwgbDMgfTsgLy8gJCh3aW5kb3cpLm9uKCd1bmxvYWQnLCBmdW5jdGlvbigpIHsKLy8gICAgIGxvZ291dCgpOwovLyB9KTs="},{"version":3,"sources":["/Users/chengxiaofeng/Desktop/项目/手写板项目/web/src/views/common.js"],"names":["VConsole","ZegoExpressEngine","getCgi","getBrowser","userName","Date","getTime","tokenUrl","userID","publishStreamId","zg","appID","server","cgiToken","previewVideo","useLocalStreamList","isPreviewed","supportScreenSharing","loginRoom","localStream","publishType","l3","roomList","$","get","rsp","data","console","log","browser","versions","u","navigator","userAgent","app","appVersion","trident","indexOf","presto","webKit","gecko","mobile","match","ios","android","iPhone","iPad","webApp","weixin","qq","language","browserLanguage","toLowerCase","window","checkAnRun","checkScreen","checkSystemRequirements","result","videoCodec","H264","attr","VP8","webRTC","alert","screenSharing","start","error","initSDK","setLogConfig","logLevel","remoteLogLevel","logURL","setDebugVerbose","setSoundLevelDelegate","click","loginSuc","enterRoom","publish","logout","enumDevices","audioInputList","videoInputList","deviceInfo","microphones","map","item","index","deviceName","push","deviceID","cameras","html","join","on","roomID","state","errorCode","extendedData","warn","updateType","userList","JSON","stringify","info","streamID","videos","i","length","srcObject","streamList","remoteStream","playOption","val","resourceMode","startPlayingStream","then","stream","videoTemp","append","video","muted","err","k","j","stopPlayingStream","remove","splice","streamQuality","videoFPS","videoBitrate","audio","audioBitrate","audioFPS","status","forEach","type","Math","round","soundLevel","device","deviceType","count","login","roomId","token","app_id","id_name","cgi_token","userUpdate","findIndex","room","stopPublishingStream","destroyStream","hasClass","addClass","logoutRoom","constraints","isNew","camera","undefined","_constraints","audioInput","videoInput","Object","assign","controls","playType","extraInfo","publishOption","createStream","removeClass","startPublishingStream","name","message","mutePublishStreamVideo","toggleClass","mutePublishStreamAudio"],"mappings":"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","sourcesContent":["/* eslint-disable @typescript-eslint/no-use-before-define */\nimport VConsole from 'vconsole';\nimport './assets/bootstrap.min';\nimport './assets/bootstrap.min.css';\nimport { ZegoExpressEngine } from 'zego-express-engine-webrtc';\nimport { getCgi } from './content';\nimport { getBrowser } from './assets/utils';\n\nnew VConsole();\nconst userName = 'sampleUser' + new Date().getTime();\nconst tokenUrl = 'https://wsliveroom-alpha.zego.im:8282/token';\nlet userID = 'sample' + new Date().getTime();\nlet publishStreamId = 'webrtc' + new Date().getTime();\nlet zg;\nlet appID = 1610159475; // 请从官网控制台获取对应的appID\nlet server = 'wss://webliveroom-test.zego.im/ws'; // 请从官网控制台获取对应的server地址，否则可能登录失败\n\nlet cgiToken = '';\n//const appSign = '';\nlet previewVideo;\nlet useLocalStreamList = [];\nlet isPreviewed = false;\nlet supportScreenSharing = false;\nlet loginRoom = false;\n\nlet localStream;\nlet publishType;\n\nlet l3;\nlet roomList = [];\n\n// 测试用代码，开发者请忽略\n// Test code, developers please ignore\n\n({ appID, server, cgiToken, userID, l3 } = getCgi(appID, server, cgiToken));\nif (userID == \"\") userID = 'sample' + new Date().getTime();\n\nif (cgiToken && tokenUrl == 'https://wsliveroom-alpha.zego.im:8282/token') {\n    $.get(cgiToken, rsp => {\n        cgiToken = rsp.data;\n        console.log(cgiToken);\n    });\n}\n\n// 测试用代码 end\n// Test code end\n\nlet browser = {\n    versions:function(){\n        var u = navigator.userAgent, app = navigator.appVersion;\n        return {\n            trident: u.indexOf('Trident') > -1, //IE内核\n            presto: u.indexOf('Presto') > -1, //opera内核\n            webKit: u.indexOf('AppleWebKit') > -1, //苹果、谷歌内核\n            gecko: u.indexOf('Gecko') > -1 && u.indexOf('KHTML') == -1,//火狐内核\n            mobile: !!u.match(/AppleWebKit.*Mobile.*/), //是否为移动终端\n            ios: !!u.match(/\\(i[^;]+;( U;)? CPU.+Mac OS X/), //ios终端\n            android: u.indexOf('Android') > -1 || u.indexOf('Adr') > -1, //android终端\n            iPhone: u.indexOf('iPhone') > -1 , //是否为iPhone或者QQHD浏览器\n            iPad: u.indexOf('iPad') > -1, //是否iPad\n            webApp: u.indexOf('Safari') == -1, //是否web应用程序，没有头部与底部\n            weixin: u.indexOf('MicroMessenger') > -1, //是否微信 （2015-01-22新增）\n            qq: u.match(/\\sQQ/i) == \" qq\" //是否QQ\n        };\n    }(),\n    language:(navigator.browserLanguage || navigator.language).toLowerCase()\n}\n\n// eslint-disable-next-line prefer-const\nzg = new ZegoExpressEngine(appID, server);\n\nwindow.zg = zg;\nwindow.useLocalStreamList = useLocalStreamList;\n\nasync function checkAnRun(checkScreen) {\n    // console.log('sdk version is', zg.getVersion());\n    try {\n        const result = await zg.checkSystemRequirements();\n\n        // console.warn('checkSystemRequirements ', result);\n        !result.videoCodec.H264 && $('#videoCodeType option:eq(1)').attr('disabled', 'disabled');\n        !result.videoCodec.VP8 && $('#videoCodeType option:eq(2)').attr('disabled', 'disabled');\n\n        if (!result.webRTC) {\n            alert('browser is not support webrtc!!');\n            return false;\n        } else if (!result.videoCodec.H264 && !result.videoCodec.VP8) {\n            alert('browser is not support H264 and VP8');\n            return false;\n        } else if (result.videoCodec.H264) {\n            supportScreenSharing = result.screenSharing;\n            if (checkScreen && !supportScreenSharing) alert('browser is not support screenSharing');\n            previewVideo = $('#previewVideo')[0];\n            start();\n        } else {\n            alert('不支持H264，请前往混流转码测试');\n        }\n\n        return true;\n    } catch (err) {\n        console.error('checkSystemRequirements', err);\n        return false;\n    }\n\n\n}\n\nasync function start() {\n    initSDK();\n\n    zg.setLogConfig({\n        logLevel: 'debug',\n        remoteLogLevel: 'info',\n        logURL: '',\n    });\n\n    zg.setDebugVerbose(false);\n    zg.setSoundLevelDelegate(true, 3000);\n\n    $('#createRoom').click(async () => {\n        let loginSuc = false;\n        try {\n            loginSuc = await enterRoom();\n            loginSuc && (await publish());\n            \n\n        } catch (error) {\n            console.error(error);\n        }\n    });\n\n    $('#openRoom').click(async () => {\n        await enterRoom();\n    });\n\n    $('#leaveRoom').click(function () {\n        logout();\n    });\n\n    $('#stopPlaySound').click(() => {\n        zg.setSoundLevelDelegate(false);\n    });\n\n    $('#resumePlaySound').click(() => {\n        zg.setSoundLevelDelegate(false);\n        zg.setSoundLevelDelegate(true);\n    });\n}\n\nasync function enumDevices() {\n    const audioInputList = [],\n        videoInputList = [];\n    const deviceInfo = await zg.enumDevices();\n\n    deviceInfo &&\n        deviceInfo.microphones.map((item, index) => {\n            if (!item.deviceName) {\n                item.deviceName = 'microphone' + index;\n            }\n            audioInputList.push(' <option value=\"' + item.deviceID + '\">' + item.deviceName + '</option>');\n            // console.log('microphone: ' + item.deviceName);\n            return item;\n        });\n\n    deviceInfo &&\n        deviceInfo.cameras.map((item, index) => {\n            if (!item.deviceName) {\n                item.deviceName = 'camera' + index;\n            }\n            videoInputList.push(' <option value=\"' + item.deviceID + '\">' + item.deviceName + '</option>');\n            console.log('camera: ' + item.deviceName);\n            return item;\n        });\n\n    audioInputList.push('<option value=\"0\">禁止</option>');\n    videoInputList.push('<option value=\"0\">禁止</option>');\n\n    $('#audioList').html(audioInputList.join(''));\n    $('#videoList').html(videoInputList.join(''));\n}\n\nfunction initSDK() {\n    enumDevices();\n\n    zg.on('roomStateUpdate', (roomID, state, errorCode, extendedData) => {\n        console.warn('roomStateUpdate: ', roomID, state, errorCode, extendedData);\n    });\n    zg.on('roomUserUpdate', (roomID, updateType, userList) => {\n        console.warn(\n            `roomUserUpdate: room ${roomID}, user ${updateType === 'ADD' ? 'added' : 'left'} `,\n            JSON.stringify(userList),\n        );\n    });\n    zg.on('publisherStateUpdate', result => {\n        // console.log('publisherStateUpdate: ', result.streamID, result.state);\n        if (result.state == 'PUBLISHING') {\n            console.info(' publish  success ' + result.streamID);\n        } else if (result.state == 'PUBLISH_REQUESTING') {\n            console.info(' publish  retry');\n        } else {\n            if (result.errorCode == 0) {\n                console.warn('publish stop ' + result.errorCode);\n            } else {\n                console.error('publish error ' + result.errorCode);\n            }\n            // const _msg = stateInfo.error.msg;\n            // if (stateInfo.error.msg.indexOf ('server session closed, reason: ') > -1) {\n            //         const code = stateInfo.error.msg.replace ('server session closed, reason: ', '');\n            //         if (code === '21') {\n            //                 _msg = '音频编解码不支持(opus)';\n            //         } else if (code === '22') {\n            //                 _msg = '视频编解码不支持(H264)'\n            //         } else if (code === '20') {\n            //                 _msg = 'sdp 解释错误';\n            //         }\n            // }\n            // alert('推流失败,reason = ' + _msg);\n        }\n    });\n    zg.on('playerStateUpdate', result => {\n        console.log('playerStateUpdate', result.streamID, result.state);\n        if (result.state == 'PLAYING') {\n            console.info(' play  success ' + result.streamID);\n            const browser = getBrowser();\n            console.warn('browser', browser);\n            if (browser === 'Safari') {\n                const videos = $('.remoteVideo video');\n                for (let i = 0; i < videos.length; i++) {\n                    videos[i].srcObject = videos[i].srcObject;\n                }\n            }\n        } else if (result.state == 'PLAY_REQUESTING') {\n            console.info(' play  retry');\n        } else {\n            if (result.errorCode == 0) {\n                console.warn('play stop ' + result.errorCode);\n            } else {\n                console.error('play error ' + result.errorCode);\n            }\n\n            // const _msg = stateInfo.error.msg;\n            // if (stateInfo.error.msg.indexOf ('server session closed, reason: ') > -1) {\n            //         const code = stateInfo.error.msg.replace ('server session closed, reason: ', '');\n            //         if (code === '21') {\n            //                 _msg = '音频编解码不支持(opus)';\n            //         } else if (code === '22') {\n            //                 _msg = '视频编解码不支持(H264)'\n            //         } else if (code === '20') {\n            //                 _msg = 'sdp 解释错误';\n            //         }\n            // }\n            // alert('拉流失败,reason = ' + _msg);\n        }\n    });\n    zg.on('streamExtraInfoUpdate', (roomID, streamList) => {\n        console.warn(`streamExtraInfoUpdate: room ${roomID},  `, JSON.stringify(streamList));\n    });\n    zg.on('roomStreamUpdate', async (roomID, updateType, streamList, extendedData) => {\n        console.warn('roomStreamUpdate 1 roomID ', roomID, streamList, extendedData);\n        // let queue = []\n        if (updateType == 'ADD') {\n            for (let i = 0; i < streamList.length; i++) {\n                console.info(streamList[i].streamID + ' was added');\n                let remoteStream;\n                let playOption = {};\n\n                if($(\"#videoCodec\").val()) playOption.videoCodec = $(\"#videoCodec\").val();\n                if(l3 == true) playOption.resourceMode = 2;\n\n                zg.startPlayingStream(streamList[i].streamID,playOption).then(stream => {\n                    remoteStream = stream;\n                    useLocalStreamList.push(streamList[i]);\n                    let videoTemp = $(`<video id=${streamList[i].streamID} autoplay muted playsinline controls></video>`)\n                    //queue.push(videoTemp)\n                    $('.remoteVideo').append(videoTemp);\n                    const video = $('.remoteVideo video:last')[0];\n                    console.warn('video', video, remoteStream);\n                    video.srcObject = remoteStream;\n                    video.muted = false;\n                    // videoTemp = null;\n                }).catch(err => {\n                    console.error('err', err);\n                });\n\n            }\n            // const inIphone = browser.versions.mobile && browser.versions.ios\n            // const inSafari = browser.versions.webApp\n            // const inWx = browser.versions.weixin\n            // if(streamList.length > 1 && (inIphone || inSafari || inWx)) {\n            //     const ac = zc.zegoWebRTC.ac;\n            //     ac.resume();\n            //     const gain = ac.createGain();\n\n            //     while(queue.length) {\n            //         let temp = queue.shift()\n            //         if(temp.srcObject) {\n            //             queue.push(ac.createMediaStreamSource(temp.srcObject))\n            //         } else {\n            //             temp.connect(gain)\n            //         }\n            //     }\n            //     gain.connect(ac.destination);\n            // }\n        } else if (updateType == 'DELETE') {\n            for (let k = 0; k < useLocalStreamList.length; k++) {\n                for (let j = 0; j < streamList.length; j++) {\n                    if (useLocalStreamList[k].streamID === streamList[j].streamID) {\n                        try {\n                            zg.stopPlayingStream(useLocalStreamList[k].streamID);\n                        } catch (error) {\n                            console.error(error);\n                        }\n\n                        console.info(useLocalStreamList[k].streamID + 'was devared');\n\n\n                        $('.remoteVideo video:eq(' + k + ')').remove();\n                        useLocalStreamList.splice(k--, 1);\n                        break;\n                    }\n                }\n            }\n        }\n    });\n\n    zg.on('playQualityUpdate', async (streamID, streamQuality) => {\n        console.log(\n            `play#${streamID} videoFPS: ${streamQuality.video.videoFPS} videoBitrate: ${streamQuality.video.videoBitrate} audioBitrate: ${streamQuality.audio.audioBitrate} audioFPS: ${streamQuality.audio.audioFPS}`,\n        );\n        console.log(`play#${streamID}`, streamQuality);\n    });\n\n    zg.on('publishQualityUpdate', async (streamID, streamQuality) => {\n        console.log(\n            `publish#${streamID} videoFPS: ${streamQuality.video.videoFPS} videoBitrate: ${streamQuality.video.videoBitrate} audioBitrate: ${streamQuality.audio.audioBitrate} audioFPS: ${streamQuality.audio.audioFPS}`,\n        );\n        console.log(`publish#${streamID}`, streamQuality);\n    });\n\n    zg.on('remoteCameraStatusUpdate', (streamID, status) => {\n        console.warn(`remoteCameraStatusUpdate ${streamID} camera status ${status == 'OPEN' ? 'open' : 'close'}`);\n    });\n\n    zg.on('remoteMicStatusUpdate', (streamID, status) => {\n        console.warn(`remoteMicStatusUpdate ${streamID} micro status ${status == 'OPEN' ? 'open' : 'close'}`);\n    });\n\n    zg.on('soundLevelUpdate', (streamList) => {\n        streamList.forEach(stream => {\n            stream.type == 'push' && $('#soundLevel').html(Math.round(stream.soundLevel) + '');\n            console.warn(`${stream.type} ${stream.streamID}, soundLevel: ${stream.soundLevel}`);\n        });\n    });\n    zg.on('deviceError', (errorCode, deviceName) => {\n        console.warn(`deviceError`, errorCode, deviceName);\n    });\n    zg.on('videoDeviceStateChanged', (updateType, device) => {\n        console.warn(`videoDeviceStateChanged`, device, updateType);\n    });\n    zg.on('audioDeviceStateChanged', (updateType, deviceType, device) => {\n        console.warn(`audioDeviceStateChanged`, device, updateType, deviceType);\n    });\n    zg.on('roomOnlineUserCountUpdate', (roomID, count) => {\n        console.warn(`roomOnlineUserCountUpdate ${roomID} ${count}`);\n    });\n}\n\nasync function login(roomId) {\n    // 获取token需要客户自己实现，token是对登录房间的唯一验证\n    // Obtaining a token needs to be implemented by the customer. The token is the only verification for the login room.\n    let token = '';\n    //测试用，开发者请忽略\n    //Test code, developers please ignore\n    if (cgiToken) {\n        token = await $.get(tokenUrl, {\n            app_id: appID,\n            id_name: userID,\n            cgi_token: cgiToken,\n        });\n        //测试用结束\n        //Test code end\n    } else {\n        token = await $.get('https://wsliveroom-alpha.zego.im:8282/token', {\n            app_id: appID,\n            id_name: userID,\n        });\n    }\n    await zg.loginRoom(roomId, token, { userID, userName }, { userUpdate: true });\n    roomList.push(roomId);\n\n    return true;\n}\n\nasync function enterRoom() {\n    // const roomId = $('#roomId').val();\n    const roomId =\"111\";\n    if (!roomId) {\n        alert('roomId is empty');\n        return false;\n    }\n\n    // for (let i = 0; i < useLocalStreamList.length; i++) {\n    //     useLocalStreamList[i].streamID && zg.stopPlayingStream(useLocalStreamList[i].streamID);\n    // }\n\n    await login(roomId);\n    loginRoom = true;\n\n    // console.warn('remoteVideo')\n    // $('.remoteVideo').html('');\n\n    return true;\n}\n\nasync function logout() {\n    console.info('leave room  and close stream');\n    const roomId = $('#roomId').val();\n    // 停止拉流\n    // stop playing\n    for (let i = 0; i < useLocalStreamList.length; i++) {\n        useLocalStreamList[i].streamID && zg.stopPlayingStream(useLocalStreamList[i].streamID);\n    }\n\n    // 清空页面\n    // Clear page\n    useLocalStreamList = [];\n    // window.useLocalStreamList = [];\n\n    roomList.splice(roomList.findIndex(room => room == roomId), 1);\n\n    if (previewVideo.srcObject && isPreviewed && (!roomId || roomList.length == 0) ) {\n      previewVideo.srcObject = null;\n      zg.stopPublishingStream(publishStreamId);\n      zg.destroyStream(localStream);\n      isPreviewed = false;\n      !$('.sound').hasClass('d-none') && $('.sound').addClass('d-none');\n    }\n\n    if (!roomId || roomList.length == 0) {\n      $('.remoteVideo').html('');\n      $('#memberList').html('');\n    }\n\n    //退出登录\n    //logout\n    zg.logoutRoom(roomId);\n    loginRoom = false;\n}\n\nasync function publish(constraints, isNew) {\n    console.warn('createStream', $('#audioList').val(), $('#videoList').val());\n    console.warn('constraints', constraints);\n    const video =\n        constraints && constraints.camera && typeof constraints.camera.video === 'boolean'\n            ? constraints.camera.video\n            : undefined;\n\n    const _constraints = {\n        camera: {\n            audioInput: $('#audioList').val(),\n            videoInput: $('#videoList').val(),\n            video: video !== undefined ? video : $('#videoList').val() === '0' ? false : true,\n            audio: $('#audioList').val() === '0' ? false : true,\n            // channelCount: constraints && constraints.camera && constraints.camera.channelCount,\n        },\n    };\n    constraints && constraints.camera && Object.assign(_constraints.camera, constraints.camera);\n    !_constraints.camera.video && (previewVideo.controls = false);\n    const playType =\n        _constraints.camera.audio === false ? 'Video' : _constraints.camera.video === false ? 'Audio' : 'all';\n    publishType = playType;\n    // console.error('playType', playType);\n    push(_constraints, { extraInfo: JSON.stringify({ playType }) }, isNew);\n}\nasync function push(constraints, publishOption = {}, isNew) {\n    try {\n        if(localStream) {\n            zg.destroyStream(localStream)\n        }\n        localStream = await zg.createStream(constraints);\n        // var AudioContext = window.AudioContext || window.webkitAudioContext; // 兼容性\n        // let localTrack= localStream.getAudioTracks()[0];\n        // let audioContext = new AudioContext();// 创建Audio上下文\n        // let mediaStreamSource = audioContext.createMediaStreamSource(localStream);\n        // let destination = audioContext.createMediaStreamDestination();\n        // let gainNode = audioContext.createGain();\n        // mediaStreamSource.connect(gainNode);\n        // gainNode.connect(destination);\n        // gainNode.gain.value=3;\n        // let audioTrack = destination.stream.getAudioTracks()[0];\n        // localStream.removeTrack(localTrack);\n        // localStream.addTrack(audioTrack);\n        previewVideo.srcObject = localStream;\n        isPreviewed = true;\n        $('.sound').hasClass('d-none') && $('.sound').removeClass('d-none');\n        isNew && (publishStreamId = 'webrtc' + new Date().getTime());\n        if($(\"#videoCodec\").val()) publishOption.videoCodec = $(\"#videoCodec\").val();\n        if ($('#roomId').val()) publishOption.roomID = $('#roomId').val();\n        const result = zg.startPublishingStream(publishStreamId, localStream, publishOption);\n        console.log('publish stream' + publishStreamId, result);\n    } catch (err) {\n        if (err.name) {\n            console.error('createStream', err.name, err.message);\n        } else {\n            console.error('createStream error', err);\n        }\n    }\n}\n\n$('#toggleCamera').click(function () {\n    zg.mutePublishStreamVideo(previewVideo.srcObject, !$(this).hasClass('disabled'));\n    $(this).toggleClass('disabled');\n});\n\n$('#toggleSpeaker').click(function () {\n    zg.mutePublishStreamAudio(previewVideo.srcObject, !$(this).hasClass('disabled'));\n    $(this).toggleClass('disabled');\n});\n\n$('#enterRoom').click(async () => {\n  let loginSuc = false;\n  try {\n      loginSuc = await enterRoom();\n      if (loginSuc) {\n          if(localStream) {\n              zg.destroyStream(localStream)\n          }\n          localStream = await zg.createStream({\n              camera: {\n                  audioInput: $('#audioList').val() ,\n                  videoInput: $('#videoList').val() ,\n                  video: $('#videoList').val() === '0' ? false : true,\n                  audio: $('#audioList').val() === '0' ? false : true,\n              },\n          });\n          previewVideo.srcObject = localStream;\n          isPreviewed = true;\n          $('#videoList').val() === '0' && (previewVideo.controls = true);\n      }\n  } catch (error) {\n      console.error(error);\n  }\n});\n\nexport {\n    zg,\n    appID,\n    publishStreamId,\n    checkAnRun,\n    supportScreenSharing,\n    userID,\n    useLocalStreamList,\n    logout,\n    enterRoom,\n    push,\n    publish,\n    previewVideo,\n    isPreviewed,\n    loginRoom,\n    publishType,\n    l3,\n};\n\n// $(window).on('unload', function() {\n//     logout();\n// });\n"]}]}