{"remainingRequest":"/Users/chengxiaofeng/Desktop/项目/手写板项目/web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/chengxiaofeng/Desktop/项目/手写板项目/web/src/views/test.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/chengxiaofeng/Desktop/项目/手写板项目/web/src/views/test.vue","mtime":1630492808402},{"path":"/Users/chengxiaofeng/Desktop/项目/手写板项目/web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/chengxiaofeng/Desktop/项目/手写板项目/web/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/chengxiaofeng/Desktop/项目/手写板项目/web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/chengxiaofeng/Desktop/项目/手写板项目/web/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IG1hcEdldHRlcnMsIG1hcFN0YXRlIH0gZnJvbSAndnVleCcKaW1wb3J0IHsgY2hlY2tBblJ1biwgZW50ZXJSb29tLCBwdWJsaXNoLCB6ZywgdXNlTG9jYWxTdHJlYW1MaXN0LCBsb2dvdXQgfSBmcm9tICcuL2NvbW1vbic7CgpleHBvcnQgZGVmYXVsdCB7CiAgICAgY3JlYXRlZCgpIHsKICAgIHRoaXMuJHN0b3JlLmRpc3BhdGNoKCdzZW5kVXNlckVudGVyJykKICAgIAogICAgJChhc3luYyAoKSA9PiB7CiAgICBhd2FpdCBjaGVja0FuUnVuKCk7CiAgICB6Zy5vZmYoJ3Jvb21TdHJlYW1VcGRhdGUnKTsKICAgIHpnLm9uKCdyb29tU3RyZWFtVXBkYXRlJywgYXN5bmMgKHJvb21JRCwgdXBkYXRlVHlwZSwgc3RyZWFtTGlzdCwgZXh0ZW5kZWREYXRhKSA9PiB7CiAgICAgICAgLy8gY29uc29sZS5sb2coJ3Jvb21TdHJlYW1VcGRhdGUgcm9vbUlEICcsIHJvb21JRCwgc3RyZWFtTGlzdCwgZXh0ZW5kZWREYXRhKTsKICAgICAgICBpZiAodXBkYXRlVHlwZSA9PSAnQUREJykgewogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHN0cmVhbUxpc3QubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUuaW5mbyhzdHJlYW1MaXN0W2ldLnN0cmVhbUlEICsgJyB3YXMgYWRkZWQnKTsKICAgICAgICAgICAgICAgIGxldCByZW1vdGVTdHJlYW07CgogICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICByZW1vdGVTdHJlYW0gPSBhd2FpdCB6Zy5zdGFydFBsYXlpbmdTdHJlYW0oc3RyZWFtTGlzdFtpXS5zdHJlYW1JRCwgewogICAgICAgICAgICAgICAgICAgICAgICB2aWRlbzogZmFsc2UsCiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgdXNlTG9jYWxTdHJlYW1MaXN0LnB1c2goc3RyZWFtTGlzdFtpXSk7CgogICAgICAgICAgICAgICAgICAgICQoJy5yZW1vdGVWaWRlbycpLmFwcGVuZCgkKGA8YXVkaW8gaWQ9JHtzdHJlYW1MaXN0W2ldLnN0cmVhbUlEfSBhdXRvcGxheSBtdXRlZCBwbGF5c2lubGluZSA+PC9hdWRpbz5gKSk7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgYXVkaW8gPSAkKCcucmVtb3RlVmlkZW8gYXVkaW86bGFzdCcpWzBdOwogICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUud2FybignYXVkaW8nLCBhdWRpbywgcmVtb3RlU3RyZWFtKTsKICAgICAgICAgICAgICAgICAgICBhdWRpby5zcmNPYmplY3QgPSByZW1vdGVTdHJlYW07CiAgICAgICAgICAgICAgICAgICAgYXVkaW8ubXV0ZWQgPSBmYWxzZTsKICAgICAgICAgICAgICAgICAgICB2YXIgTXlEaXYgPWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJ2aWV3MiIpOwogICAgICAgICAgICAgICAgICAgIC8vIGFsZXJ0KE15RGl2KTsKICAgICAgICAgICAgICAgICAgICBsZXQgbmFtZSA9IFsi5a2m55SfIiwi5omT5byA6bqm5YWL6aOOIiwi5YWz6Zet6bqm5YWL6aOOIiwi5omT5byA5ZCs562SIiwi5YWz6Zet5ZCs562SIl0KICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IDU7IGkrKykgewogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiaW5wdXQiKTsKICAgICAgICAgICAgICAgICAgICAgICAgYnV0dG9uLnNldEF0dHJpYnV0ZSgidHlwZSIsICJidXR0b24iKTsKICAgICAgICAgICAgICAgICAgICAgICAgYnV0dG9uLnNldEF0dHJpYnV0ZSgidmFsdWUiLCBuYW1lW2ldICk7CiAgICAgICAgICAgICAgICAgICAgICAgIGJ1dHRvbi5zZXRBdHRyaWJ1dGUoImlkIiwgImJ0biIgKyBpKTsKICAgICAgICAgICAgICAgICAgICAgICAgYnV0dG9uLnN0eWxlLndpZHRoID0gIjEyMHB4IjsKICAgICAgICAgICAgICAgICAgICAgICAgLy8gYnV0dG9uLnNldEF0dHJpYnV0ZSgib25jbGljayIsICJmdW5jdGlvbih0aGlzLmlkKSIpOwogICAgICAgICAgICAgICAgICAgICAgICBNeURpdi5hcHBlbmRDaGlsZChidXR0b24pOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5lcnJvcihlcnJvcik7CiAgICAgICAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIGlmICh1cGRhdGVUeXBlID09ICdERUxFVEUnKSB7CiAgICAgICAgICAgIGZvciAobGV0IGsgPSAwOyBrIDwgdXNlTG9jYWxTdHJlYW1MaXN0Lmxlbmd0aDsgaysrKSB7CiAgICAgICAgICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IHN0cmVhbUxpc3QubGVuZ3RoOyBqKyspIHsKICAgICAgICAgICAgICAgICAgICBpZiAodXNlTG9jYWxTdHJlYW1MaXN0W2tdLnN0cmVhbUlEID09PSBzdHJlYW1MaXN0W2pdLnN0cmVhbUlEKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB6Zy5zdG9wUGxheWluZ1N0cmVhbSh1c2VMb2NhbFN0cmVhbUxpc3Rba10uc3RyZWFtSUQpOwogICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUuaW5mbyh1c2VMb2NhbFN0cmVhbUxpc3Rba10uc3RyZWFtSUQgKyAnd2FzIGRldmFyZWQnKTsKCgogICAgICAgICAgICAgICAgICAgICAgICAkKCcucmVtb3RlVmlkZW8gYXVkaW86ZXEoJyArIGsgKyAnKScpLnJlbW92ZSgpOwogICAgICAgICAgICAgICAgICAgICAgICB1c2VMb2NhbFN0cmVhbUxpc3Quc3BsaWNlKGstLSwgMSk7CgogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9KTsKCiAgICAKfSk7CgoKICB9LApjb21wdXRlZDogewp9LAptb3VudGVkKCl7CiAgICAKfSwKZGF0YSgpewogICAgcmV0dXJuewogICAgICAgIAogICAgfQp9LAptZXRob2RzOiB7CiAgICBhc3luYyBlbnRlclJvb20oKXsKICAgICAgICBsZXQgbG9naW5TdWMgPSBmYWxzZTsKICAgICAgICB0cnkgewogICAgICAgICAgICBsb2dpblN1YyA9IGF3YWl0IGVudGVyUm9vbSgpOwogICAgICAgICAgICBsb2dpblN1YyAmJiAoYXdhaXQgcHVibGlzaCh7IGNhbWVyYTogeyB2aWRlbzogZmFsc2UgfSB9KSk7CiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7CiAgICAgICAgfQogICAgfSwKCiAgICBhc3luYyBvcGVuU2F5KCl7CiAgICAgICAgbG9nb3V0KCkKICAgICAgICBsZXQgbG9naW5TdWMgPSBmYWxzZTsKICAgICAgICB0cnkgewogICAgICAgICAgICBsb2dpblN1YyA9IGF3YWl0IGVudGVyUm9vbSgpOwogICAgICAgICAgICBsb2dpblN1YyAmJiAoYXdhaXQgcHVibGlzaCgpKTsKICAgICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgICAgICBjb25zb2xlLmVycm9yKGVycm9yKTsKICAgICAgICB9CiAgICB9LAogICAgYXN5bmMgY2xvc2VTYXkoKXsKICAgICAgICBsb2dvdXQoKQogICAgICAgIGVudGVyUm9vbSgpCiAgICB9LAogICAgb3Blbkxpc3RlbigpewogICAgICAgIHZhciBteUF1dG8gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncHJldmlld1ZpZGVvJyk7CiAgICAgICAgbXlBdXRvLnBsYXkoKTsKICAgIH0sCiAgICBjbG9zZUxpc3RlbigpewogICAgICAgIHZhciBteUF1dG8gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncHJldmlld1ZpZGVvJyk7CiAgICAgICAgbXlBdXRvLnBhdXNlKCk7CiAgICB9LAp9Cgp9Cg=="},{"version":3,"sources":["test.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6CA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;AAGA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;;AAGA;;;AAGA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA","file":"test.vue","sourceRoot":"src/views","sourcesContent":["<template>\n<el-container>\n    <el-header>\n        \n    </el-header>\n    <el-main>\n            <div class=\"my-3 p-3 bg-white rounded box-shadow small\">\n\n      <h6 class=\"border-bottom border-gray pb-2 mb-0 pureAudioContent\">推拉纯音频流</h6>\n\n      <div class=\"row\" style=\"margin-top:1%\">\n      </div>\n\n      <div class=\"row\"> \n        <div class=\"col-sm\">\n          <button type=\"button\" id=\"createRoom\" class=\"btn btn-primary btn-sm enterRoomPush\" @click=\"enterRoom\">进入房间（推流）</button>\n          <button type=\"button\" id=\"openRoom\" class=\"btn btn-primary btn-sm enterRoomPlay\">进入房间（不推流）</button>\n          <button type=\"button\" id=\"leaveRoom\" class=\"btn btn-secondary btn-sm leaveRoom\">退出</button>\n        </div>\n      </div>\n      \n      <div id=\"view\"></div>\n      \n      <div class=\"row videoRow\">\n        <div class=\"col-sm\" >\n          <label id=\"previewLabel\"></label>\n          <audio id=\"previewVideo\" autoplay muted playsinline ></audio>\n          <el-tag>老师 </el-tag>\n          <input type=\"button\" id=\"btn1\" value=\"打开麦克风\" @click=\"openSay\"/>\n          <input type=\"button\" id=\"btn2\" value=\"关闭麦克风\" @click=\"closeSay\"/>\n          <input type=\"button\" id=\"btn3\"  value=\"打开听筒\" @click=\"openListen\" />\n          <input type=\"button\" id=\"btn4\" value=\"关闭听筒\" @click=\"closeListen\" />\n        </div>\n        <div class=\"col-sm remoteVideo\">\n          <!--<video  autoplay muted playsinline></video>-->\n        </div>\n      </div>\n      <div id=\"view2\" style=\"margin-top: 20px;\"></div>\n    </div>\n         \n    </el-main>\n</el-container>\n</template>\n\n<script>\nimport { mapGetters, mapState } from 'vuex'\nimport { checkAnRun, enterRoom, publish, zg, useLocalStreamList, logout } from './common';\n\nexport default {\n     created() {\n    this.$store.dispatch('sendUserEnter')\n    \n    $(async () => {\n    await checkAnRun();\n    zg.off('roomStreamUpdate');\n    zg.on('roomStreamUpdate', async (roomID, updateType, streamList, extendedData) => {\n        // console.log('roomStreamUpdate roomID ', roomID, streamList, extendedData);\n        if (updateType == 'ADD') {\n            for (let i = 0; i < streamList.length; i++) {\n                // console.info(streamList[i].streamID + ' was added');\n                let remoteStream;\n\n                try {\n                    remoteStream = await zg.startPlayingStream(streamList[i].streamID, {\n                        video: false,\n                    });\n                    useLocalStreamList.push(streamList[i]);\n\n                    $('.remoteVideo').append($(`<audio id=${streamList[i].streamID} autoplay muted playsinline ></audio>`));\n                    const audio = $('.remoteVideo audio:last')[0];\n                    // console.warn('audio', audio, remoteStream);\n                    audio.srcObject = remoteStream;\n                    audio.muted = false;\n                    var MyDiv =document.getElementById(\"view2\");\n                    // alert(MyDiv);\n                    let name = [\"学生\",\"打开麦克风\",\"关闭麦克风\",\"打开听筒\",\"关闭听筒\"]\n                    for (let i = 0; i < 5; i++) {\n                        var button = document.createElement(\"input\");\n                        button.setAttribute(\"type\", \"button\");\n                        button.setAttribute(\"value\", name[i] );\n                        button.setAttribute(\"id\", \"btn\" + i);\n                        button.style.width = \"120px\";\n                        // button.setAttribute(\"onclick\", \"function(this.id)\");\n                        MyDiv.appendChild(button);\n                    }\n                } catch (error) {\n                    // console.error(error);\n                    continue;\n                }\n\n            }\n        } else if (updateType == 'DELETE') {\n            for (let k = 0; k < useLocalStreamList.length; k++) {\n                for (let j = 0; j < streamList.length; j++) {\n                    if (useLocalStreamList[k].streamID === streamList[j].streamID) {\n                        try {\n                            zg.stopPlayingStream(useLocalStreamList[k].streamID);\n                        } catch (error) {\n                            console.error(error);\n                        }\n\n                        // console.info(useLocalStreamList[k].streamID + 'was devared');\n\n\n                        $('.remoteVideo audio:eq(' + k + ')').remove();\n                        useLocalStreamList.splice(k--, 1);\n\n                        break;\n                    }\n                }\n            }\n        }\n    });\n\n    \n});\n\n\n  },\ncomputed: {\n},\nmounted(){\n    \n},\ndata(){\n    return{\n        \n    }\n},\nmethods: {\n    async enterRoom(){\n        let loginSuc = false;\n        try {\n            loginSuc = await enterRoom();\n            loginSuc && (await publish({ camera: { video: false } }));\n        } catch (error) {\n            console.error(error);\n        }\n    },\n\n    async openSay(){\n        logout()\n        let loginSuc = false;\n        try {\n            loginSuc = await enterRoom();\n            loginSuc && (await publish());\n        } catch (error) {\n            console.error(error);\n        }\n    },\n    async closeSay(){\n        logout()\n        enterRoom()\n    },\n    openListen(){\n        var myAuto = document.getElementById('previewVideo');\n        myAuto.play();\n    },\n    closeListen(){\n        var myAuto = document.getElementById('previewVideo');\n        myAuto.pause();\n    },\n}\n\n}\n</script>\n<style lang = \"less\" scoped>\n.el-container{\n    width: 100%;\n    height: 100%;\n    background-color: aqua;\n\n    .el-header{\n        line-height: 60px;\n    }\n\n    .el-main{\n        background-color: aquamarine;\n        overflow: hidden;\n         \n        .bg-f2{\n          background-color: #f8f9fa;\n        }\n        video{\n            width: 320px;\n            height: auto;\n        }\n        .videoRow{\n            margin-top: 30px;\n        }\n        #previewLabel{\n            display: block;\n        }\n            \n        \n    }\n}\n.el-card{\n    width: 100%;\n    height: 100%;\n}\n</style>"]}]}