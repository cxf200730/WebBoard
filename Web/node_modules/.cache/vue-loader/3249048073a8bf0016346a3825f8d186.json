{"remainingRequest":"/Users/chengxiaofeng/Desktop/项目/手写板项目/web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/chengxiaofeng/Desktop/项目/手写板项目/web/src/views/test.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/chengxiaofeng/Desktop/项目/手写板项目/web/src/views/test.vue","mtime":1630492228963},{"path":"/Users/chengxiaofeng/Desktop/项目/手写板项目/web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/chengxiaofeng/Desktop/项目/手写板项目/web/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/chengxiaofeng/Desktop/项目/手写板项目/web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/chengxiaofeng/Desktop/项目/手写板项目/web/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IG1hcEdldHRlcnMsIG1hcFN0YXRlIH0gZnJvbSAndnVleCcKaW1wb3J0IHsgY2hlY2tBblJ1biwgZW50ZXJSb29tLCBwdWJsaXNoLCB6ZywgdXNlTG9jYWxTdHJlYW1MaXN0IH0gZnJvbSAnLi9jb21tb24nOwoKZXhwb3J0IGRlZmF1bHQgewogICAgIGNyZWF0ZWQoKSB7CiAgICB0aGlzLiRzdG9yZS5kaXNwYXRjaCgnc2VuZFVzZXJFbnRlcicpCiAgICAKICAgICQoYXN5bmMgKCkgPT4gewogICAgYXdhaXQgY2hlY2tBblJ1bigpOwogICAgemcub2ZmKCdyb29tU3RyZWFtVXBkYXRlJyk7CiAgICB6Zy5vbigncm9vbVN0cmVhbVVwZGF0ZScsIGFzeW5jIChyb29tSUQsIHVwZGF0ZVR5cGUsIHN0cmVhbUxpc3QsIGV4dGVuZGVkRGF0YSkgPT4gewogICAgICAgIC8vIGNvbnNvbGUubG9nKCdyb29tU3RyZWFtVXBkYXRlIHJvb21JRCAnLCByb29tSUQsIHN0cmVhbUxpc3QsIGV4dGVuZGVkRGF0YSk7CiAgICAgICAgaWYgKHVwZGF0ZVR5cGUgPT0gJ0FERCcpIHsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzdHJlYW1MaXN0Lmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmluZm8oc3RyZWFtTGlzdFtpXS5zdHJlYW1JRCArICcgd2FzIGFkZGVkJyk7CiAgICAgICAgICAgICAgICBsZXQgcmVtb3RlU3RyZWFtOwoKICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgcmVtb3RlU3RyZWFtID0gYXdhaXQgemcuc3RhcnRQbGF5aW5nU3RyZWFtKHN0cmVhbUxpc3RbaV0uc3RyZWFtSUQsIHsKICAgICAgICAgICAgICAgICAgICAgICAgdmlkZW86IGZhbHNlLAogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgIHVzZUxvY2FsU3RyZWFtTGlzdC5wdXNoKHN0cmVhbUxpc3RbaV0pOwoKICAgICAgICAgICAgICAgICAgICAkKCcucmVtb3RlVmlkZW8nKS5hcHBlbmQoJChgPGF1ZGlvIGlkPSR7c3RyZWFtTGlzdFtpXS5zdHJlYW1JRH0gYXV0b3BsYXkgbXV0ZWQgcGxheXNpbmxpbmUgPjwvYXVkaW8+YCkpOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IGF1ZGlvID0gJCgnLnJlbW90ZVZpZGVvIGF1ZGlvOmxhc3QnKVswXTsKICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLndhcm4oJ2F1ZGlvJywgYXVkaW8sIHJlbW90ZVN0cmVhbSk7CiAgICAgICAgICAgICAgICAgICAgYXVkaW8uc3JjT2JqZWN0ID0gcmVtb3RlU3RyZWFtOwogICAgICAgICAgICAgICAgICAgIGF1ZGlvLm11dGVkID0gZmFsc2U7CiAgICAgICAgICAgICAgICAgICAgdmFyIE15RGl2ID1kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgidmlldzIiKTsKICAgICAgICAgICAgICAgICAgICAvLyBhbGVydChNeURpdik7CiAgICAgICAgICAgICAgICAgICAgbGV0IG5hbWUgPSBbIuWtpueUnyIsIuaJk+W8gOm6puWFi+mjjiIsIuWFs+mXrem6puWFi+mjjiIsIuaJk+W8gOWQrOetkiIsIuWFs+mXreWQrOetkiJdCiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCA1OyBpKyspIHsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImlucHV0Iik7CiAgICAgICAgICAgICAgICAgICAgICAgIGJ1dHRvbi5zZXRBdHRyaWJ1dGUoInR5cGUiLCAiYnV0dG9uIik7CiAgICAgICAgICAgICAgICAgICAgICAgIGJ1dHRvbi5zZXRBdHRyaWJ1dGUoInZhbHVlIiwgbmFtZVtpXSApOwogICAgICAgICAgICAgICAgICAgICAgICBidXR0b24uc2V0QXR0cmlidXRlKCJpZCIsICJidG4iICsgaSk7CiAgICAgICAgICAgICAgICAgICAgICAgIGJ1dHRvbi5zdHlsZS53aWR0aCA9ICIxMjBweCI7CiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGJ1dHRvbi5zZXRBdHRyaWJ1dGUoIm9uY2xpY2siLCAiZnVuY3Rpb24odGhpcy5pZCkiKTsKICAgICAgICAgICAgICAgICAgICAgICAgTXlEaXYuYXBwZW5kQ2hpbGQoYnV0dG9uKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUuZXJyb3IoZXJyb3IpOwogICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgfQogICAgICAgIH0gZWxzZSBpZiAodXBkYXRlVHlwZSA9PSAnREVMRVRFJykgewogICAgICAgICAgICBmb3IgKGxldCBrID0gMDsgayA8IHVzZUxvY2FsU3RyZWFtTGlzdC5sZW5ndGg7IGsrKykgewogICAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBzdHJlYW1MaXN0Lmxlbmd0aDsgaisrKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKHVzZUxvY2FsU3RyZWFtTGlzdFtrXS5zdHJlYW1JRCA9PT0gc3RyZWFtTGlzdFtqXS5zdHJlYW1JRCkgewogICAgICAgICAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgemcuc3RvcFBsYXlpbmdTdHJlYW0odXNlTG9jYWxTdHJlYW1MaXN0W2tdLnN0cmVhbUlEKTsKICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpOwogICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmluZm8odXNlTG9jYWxTdHJlYW1MaXN0W2tdLnN0cmVhbUlEICsgJ3dhcyBkZXZhcmVkJyk7CgoKICAgICAgICAgICAgICAgICAgICAgICAgJCgnLnJlbW90ZVZpZGVvIGF1ZGlvOmVxKCcgKyBrICsgJyknKS5yZW1vdmUoKTsKICAgICAgICAgICAgICAgICAgICAgICAgdXNlTG9jYWxTdHJlYW1MaXN0LnNwbGljZShrLS0sIDEpOwoKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSk7CgogICAgCn0pOwoKCiAgfSwKY29tcHV0ZWQ6IHsKfSwKbW91bnRlZCgpewogICAgCn0sCmRhdGEoKXsKICAgIHJldHVybnsKICAgICAgICAKICAgIH0KfSwKbWV0aG9kczogewogICAgYXN5bmMgZW50ZXJSb29tKCl7CiAgICAgICAgbGV0IGxvZ2luU3VjID0gZmFsc2U7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgbG9naW5TdWMgPSBhd2FpdCBlbnRlclJvb20oKTsKICAgICAgICAgICAgbG9naW5TdWMgJiYgKGF3YWl0IHB1Ymxpc2goeyBjYW1lcmE6IHsgdmlkZW86IGZhbHNlIH0gfSkpOwogICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpOwogICAgICAgIH0KICAgIH0sCgogICAgYXN5bmMgb3BlblNheSgpewogICAgICAgIGxvZ291dCgpCiAgICAgICAgbGV0IGxvZ2luU3VjID0gZmFsc2U7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgbG9naW5TdWMgPSBhd2FpdCBlbnRlclJvb20oKTsKICAgICAgICAgICAgbG9naW5TdWMgJiYgKGF3YWl0IHB1Ymxpc2goKSk7CiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7CiAgICAgICAgfQogICAgfSwKICAgIGFzeW5jIGNsb3NlU2F5KCl7CiAgICAgICAgbG9nb3V0KCkKICAgICAgICBlbnRlclJvb20oKQogICAgfSwKICAgIG9wZW5MaXN0ZW4oKXsKICAgICAgICB2YXIgbXlBdXRvID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3ByZXZpZXdWaWRlbycpOwogICAgICAgIG15QXV0by5wbGF5KCk7CiAgICB9LAogICAgY2xvc2VMaXN0ZW4oKXsKICAgICAgICB2YXIgbXlBdXRvID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3ByZXZpZXdWaWRlbycpOwogICAgICAgIG15QXV0by5wYXVzZSgpOwogICAgfSwKfQoKfQo="},{"version":3,"sources":["test.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkDA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;AAGA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;;AAGA;;;AAGA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA","file":"test.vue","sourceRoot":"src/views","sourcesContent":["<template>\n<el-container>\n    <el-header>\n        \n    </el-header>\n    <el-main>\n            <div class=\"my-3 p-3 bg-white rounded box-shadow small\">\n\n      <h6 class=\"border-bottom border-gray pb-2 mb-0 pureAudioContent\">推拉纯音频流</h6>\n\n      <div class=\"row\" style=\"margin-top:1%\">\n\n      \n         \n\n\n      </div>\n\n      <div class=\"row\"> \n        <div class=\"col-sm\">\n          <button type=\"button\" id=\"createRoom\" class=\"btn btn-primary btn-sm enterRoomPush\" @click=\"enterRoom\">进入房间（推流）</button>\n          <button type=\"button\" id=\"openRoom\" class=\"btn btn-primary btn-sm enterRoomPlay\">进入房间（不推流）</button>\n          <button type=\"button\" id=\"leaveRoom\" class=\"btn btn-secondary btn-sm leaveRoom\">退出</button>\n        </div>\n      </div>\n      \n      <div id=\"view\"></div>\n      \n      <div class=\"row videoRow\">\n        <div class=\"col-sm\" >\n          <label id=\"previewLabel\"></label>\n          <audio id=\"previewVideo\" autoplay muted playsinline ></audio>\n          <el-tag>老师 </el-tag>\n          <input type=\"button\" id=\"btn1\" value=\"打开麦克风\" @click=\"openSay\"/>\n          <input type=\"button\" id=\"btn2\" value=\"关闭麦克风\" @click=\"closeSay\"/>\n          <input type=\"button\" id=\"btn3\"  value=\"打开听筒\" @click=\"openListen\" />\n          <input type=\"button\" id=\"btn4\" value=\"关闭听筒\" @click=\"closeListen\" />\n        </div>\n        <div class=\"col-sm remoteVideo\">\n          <!--<video  autoplay muted playsinline></video>-->\n        </div>\n      </div>\n      <div id=\"view2\" style=\"margin-top: 20px;\"></div>\n    </div>\n         \n    </el-main>\n</el-container>\n</template>\n\n<script>\nimport { mapGetters, mapState } from 'vuex'\nimport { checkAnRun, enterRoom, publish, zg, useLocalStreamList } from './common';\n\nexport default {\n     created() {\n    this.$store.dispatch('sendUserEnter')\n    \n    $(async () => {\n    await checkAnRun();\n    zg.off('roomStreamUpdate');\n    zg.on('roomStreamUpdate', async (roomID, updateType, streamList, extendedData) => {\n        // console.log('roomStreamUpdate roomID ', roomID, streamList, extendedData);\n        if (updateType == 'ADD') {\n            for (let i = 0; i < streamList.length; i++) {\n                // console.info(streamList[i].streamID + ' was added');\n                let remoteStream;\n\n                try {\n                    remoteStream = await zg.startPlayingStream(streamList[i].streamID, {\n                        video: false,\n                    });\n                    useLocalStreamList.push(streamList[i]);\n\n                    $('.remoteVideo').append($(`<audio id=${streamList[i].streamID} autoplay muted playsinline ></audio>`));\n                    const audio = $('.remoteVideo audio:last')[0];\n                    // console.warn('audio', audio, remoteStream);\n                    audio.srcObject = remoteStream;\n                    audio.muted = false;\n                    var MyDiv =document.getElementById(\"view2\");\n                    // alert(MyDiv);\n                    let name = [\"学生\",\"打开麦克风\",\"关闭麦克风\",\"打开听筒\",\"关闭听筒\"]\n                    for (let i = 0; i < 5; i++) {\n                        var button = document.createElement(\"input\");\n                        button.setAttribute(\"type\", \"button\");\n                        button.setAttribute(\"value\", name[i] );\n                        button.setAttribute(\"id\", \"btn\" + i);\n                        button.style.width = \"120px\";\n                        // button.setAttribute(\"onclick\", \"function(this.id)\");\n                        MyDiv.appendChild(button);\n                    }\n                } catch (error) {\n                    // console.error(error);\n                    continue;\n                }\n\n            }\n        } else if (updateType == 'DELETE') {\n            for (let k = 0; k < useLocalStreamList.length; k++) {\n                for (let j = 0; j < streamList.length; j++) {\n                    if (useLocalStreamList[k].streamID === streamList[j].streamID) {\n                        try {\n                            zg.stopPlayingStream(useLocalStreamList[k].streamID);\n                        } catch (error) {\n                            console.error(error);\n                        }\n\n                        // console.info(useLocalStreamList[k].streamID + 'was devared');\n\n\n                        $('.remoteVideo audio:eq(' + k + ')').remove();\n                        useLocalStreamList.splice(k--, 1);\n\n                        break;\n                    }\n                }\n            }\n        }\n    });\n\n    \n});\n\n\n  },\ncomputed: {\n},\nmounted(){\n    \n},\ndata(){\n    return{\n        \n    }\n},\nmethods: {\n    async enterRoom(){\n        let loginSuc = false;\n        try {\n            loginSuc = await enterRoom();\n            loginSuc && (await publish({ camera: { video: false } }));\n        } catch (error) {\n            console.error(error);\n        }\n    },\n\n    async openSay(){\n        logout()\n        let loginSuc = false;\n        try {\n            loginSuc = await enterRoom();\n            loginSuc && (await publish());\n        } catch (error) {\n            console.error(error);\n        }\n    },\n    async closeSay(){\n        logout()\n        enterRoom()\n    },\n    openListen(){\n        var myAuto = document.getElementById('previewVideo');\n        myAuto.play();\n    },\n    closeListen(){\n        var myAuto = document.getElementById('previewVideo');\n        myAuto.pause();\n    },\n}\n\n}\n</script>\n<style lang = \"less\" scoped>\n.el-container{\n    width: 100%;\n    height: 100%;\n    background-color: aqua;\n\n    .el-header{\n        line-height: 60px;\n    }\n\n    .el-main{\n        background-color: aquamarine;\n        overflow: hidden;\n         \n        .bg-f2{\n          background-color: #f8f9fa;\n        }\n        video{\n            width: 320px;\n            height: auto;\n        }\n        .videoRow{\n            margin-top: 30px;\n        }\n        #previewLabel{\n            display: block;\n        }\n            \n        \n    }\n}\n.el-card{\n    width: 100%;\n    height: 100%;\n}\n</style>"]}]}